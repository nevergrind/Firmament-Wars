// all game maps
maps.getMap = function(key) {
	var str = '<div id="worldWater"></div>' +
		this.head +
		this.filters +
		'<g id="landWrap">'+ this[key].land + '</g>' +
		this.mapLayers +
		'<g class="paths">' + this[key].paths + '</g>' +
		'<g id="textWrap">' + this[key].text + '</g>' +
		this.mapTargeting + '</svg>';
	return str;
};
maps.head = '<?xml version="1.1" encoding="UTF-8" standalone="no"><svg id="world">';

maps.filters = '<defs>\
		<marker id="arrowhead"\
			orient="auto"\
			markerWidth="2"\
			markerHeight="4"\
			refX=".1"\
			refY="2">\
		<path id="arrowhead-tip"\
			d="M0,0 V4 L2,2 Z" />\
		  </marker>\
			<marker id="arrowhead-border"\
				orient="auto"\
				markerWidth="2.1"\
				markerHeight="4.2"\
				refX=".25"\
				refY="2.1">\
			<path id="arrowhead-tip-head"\
				d="M0,0 V4.2 L2.1,2.1 Z" />\
		  </marker>\
			<!--<filter id="darken">\
				<feColorMatrix type="matrix"\
				values=".2   0   0   0   0\
						 0  .2   0   0   0\
						 0   0  .2   0   0\
						 0   0   0   1   0 "/>\
			</filter>-->\
			<filter id="emboss" color-interpolation-filters="sRGB">\
				<feGaussianBlur\
					in="SourceAlpha"\
					result="result0"\
					stdDeviation="2"/>\
				<feSpecularLighting\
					in="result0"\
					result="result1"\
					lighting-color="#fff"\
					surfaceScale="5"\
					specularConstant=".3"\
					specularExponent="33">\
					  <feDistantLight azimuth="235" elevation="70"/>\
				 </feSpecularLighting>\
				 <feComposite\
					k2="1"\
					k3="1"\
					in="SourceGraphic"\
					result="result4"\
					operator="arithmetic"/>\
				 <feComposite\
					in2="SourceAlpha"\
					in="result4"\
					result="result2"\
					operator="in"/>\
			</filter>\
			<pattern id="smallGrid" width="22" height="22" patternUnits="userSpaceOnUse">\
				<path d="M 22 0 L 0 0 0 22" fill="none" stroke="rgba(32, 64, 96, 1)"\ stroke-width="2" />\
			</pattern>\
		</defs>\
		<rect id="grid" fill="url(#smallGrid)" width="100%" height="100%" x="-400px" y="-200px"/>';

maps.mapLayers = '\
		<g id="mapFlagWrap" class="no-pointer"></g>\
		<g id="mapBars" class="no-pointer"></g>\
		<g id="mapAnimations" class="no-pointer"></g>';

maps.mapTargeting = '\
		<g id="targetCrosshair">\
		<path stroke="black" stroke-width="8"\
		   d="m 384.645,256 c 0,70.942 -57.702,128.655 -128.655,128.655 -70.942,0 -128.655,-57.712 -128.655,-128.655 0,-70.912 57.723,-128.635 128.655,-128.635 70.963,0 128.655,57.713 128.655,128.635 z M 255.99,98.969 c -86.558,0 -157.02,70.42 -157.02,157.031 0,86.611 70.462,157.041 157.02,157.041 86.579,0 157.061,-70.441 157.061,-157.041 0,-86.61 -70.482,-157.03 -157.061,-157.03 z"></path>\
		<path stroke="black" stroke-width="8"\
		   d="m 270.192,216.75 0,-206.428 -28.395,0 0,206.418 c 4.485,-1.607 9.196,-2.631 14.203,-2.631 5.007,0 9.707,1.024 14.192,2.642 z"></path>\
		<path stroke="black" stroke-width="8"\
		   d="m 241.787,295.26 0,206.418 28.395,0 0,-206.418 c -4.485,1.608 -9.195,2.642 -14.203,2.642 -5.008,0 -9.708,-1.034 -14.192,-2.642 z"></path>\
		<path stroke="black" stroke-width="8"\
		   d="m 216.73,241.808 -212.121,0 0,28.375 212.121,0 c -1.618,-4.454 -2.642,-9.185 -2.642,-14.213 0,-4.976 1.024,-9.718 2.642,-14.162 z"></path>\
		<path stroke="black" stroke-width="8"\
		   d="m 507.392,241.808 -212.142,0 c 1.618,4.444 2.642,9.175 2.642,14.172 0,5.018 -1.024,9.758 -2.642,14.213 l 212.142,0 0,-28.386 z"></path>\
		  </g>\
			<path id="targetLineShadow"\
			   d="M 0,0 Q 0 0 0 0"\
			   class="paths"></path>\
			<path id="targetLineBorder"\
				marker-end="url(#arrowhead-border)"\
			   d="M 0,0 Q 0 0 0 0"\
			   class="paths"></path>\
			<path id="targetLine"\
				marker-mid="url(#mid-marker)"\
				marker-end="url(#arrowhead)"\
			   d="M 0,0 Q 0 0 0 0"\
			   class="paths"></path>\
		  <g>\
			<path id="motionPath"\
			   d="M 0,0 Q 0 0 0 0"\
			   class="paths"></path>\
		  </g>';

maps.Placeholder = {
	land: '',
	paths: '',
	text: '',
};
// muh quotes
var bible = {
	quotes: [
		{
			quote: "And God said, Let there be lights in the firmament of the heaven to divide the day from the night; and let them be for signs, and for seasons, and for days, and years:",
			verse: "Genesis 1:14"
		}, {
			quote: "And God said, Let there be a firmament in the midst of the waters, and let it divide the waters from the waters.",
			verse: "Genesis 1:6"
		}, {
			quote: "And the heaven departed as a scroll when it is rolled together; and every mountain and island were moved out of their places.",
			verse: "Revelation 6:14"
		}, {
			quote: "And all the host of heaven shall be dissolved, and the heavens shall be rolled together as a scroll: and all their host shall fall down, as the leaf falleth off from the vine, and as a falling fig from the fig tree.",
			verse: "Isaiah 34:4"
		}, {
			quote: "In the six hundredth year of Noah's life, in the second month, the seventeenth day of the month, the same day were all the fountains of the great deep broken up, and the windows of heaven were opened.",
			verse: "Genesis 7:11"
		}, {
			quote: "Hast thou with him spread out the sky, which is strong, and as a molten looking glass?",
			verse: "Job 37:18"
		}, {
			quote: "He stretcheth out the north over the empty place, and hangeth the earth upon nothing.",
			verse: "Job 26:7"
		}, {
			quote: "The LORD sitteth upon the flood; yea, the LORD sitteth King for ever.",
			verse: "Psalms 29:10"
		}, {
			quote: "When he prepared the heavens, I was there: when he set a compass upon the face of the depth:",
			verse: "Proverbs 8:27"
		}, {
			quote: "It is he that sitteth upon the circle of the earth, and the inhabitants thereof are as grasshoppers; that stretcheth out the heavens as a curtain, and spreadeth them out as a tent to dwell in:",
			verse: "Isaiah 40:22"
		}, {
			quote: "Thus saith the LORD, The heaven is my throne, and the earth is my footstool: where is the house that ye build unto me? and where is the place of my rest?",
			verse: "Isaiah 66:1"
		}, {
			quote: "He hath compassed the waters with bounds, until the day and night come to an end.",
			verse: "Job 26:10"
		}, {
			quote: "And the sun stood still, and the moon stayed, until the people had avenged themselves upon their enemies. Is not this written in the book of Jasher? So the sun stood still in the midst of heaven, and hasted not to go down about a whole day.",
			verse: "Joshua 10:13"
		}, {
			quote: "The LORD reigneth, he is clothed with majesty; the LORD is clothed with strength, wherewith he hath girded himself: the world also is stablished, that it cannot be moved.",
			verse: "Psalms 93:1"
		}, {
			quote: "And after these things I saw four angels standing on the four corners of the earth, holding the four winds of the earth, that the wind should not blow on the earth, nor on the sea, nor on any tree.",
			verse: "Revelation 7:1"
		}, {
			quote: "The tree grew, and was strong, and the height thereof reached unto heaven, and the sight thereof to the end of all the earth:",
			verse: "Daniel 4:11"
		}, {
			quote: "Again, the devil taketh him up into an exceeding high mountain, and sheweth him all the kingdoms of the world, and the glory of them; And saith unto him, All these things will I give thee, if thou wilt fall down and worship me.",
			verse: "Matthew 4:8-9"
		}, {
			quote: "And he shall send his angels with a great sound of a trumpet, and they shall gather together his elect from the four winds, from one end of heaven to the other.",
			verse: "Matthew 24:31"
		}, {
			quote: "Immediately after the tribulation of those days shall the sun be darkened, and the moon shall not give her light, and the stars shall fall from heaven, and the powers of the heavens shall be shaken:",
			verse: "Matthew 24:29"
		}, {
			quote: "Yea, ye took up the tabernacle of Moloch, and the star of your god Remphan, figures which ye made to worship them: and I will carry you away beyond Babylon.",
			verse: "Acts 7:43"
		}, {
			quote: "Loose the four angels which are bound in the great river Euphrates. And the four angels were loosed, which were prepared for an hour, and a day, and a month, and a year, for to slay the third part of men.",
			verse: "Revelation 9:14-15"
		}, {
			quote: "And the stars of heaven fell unto the earth, even as a fig tree casteth her untimely figs, when she is shaken of a mighty wind.",
			verse: "Revelation 6:13"
		}, {
			quote: "And the third angel sounded, and there fell a great star from heaven, burning as it were a lamp, and it fell upon the third part of the rivers, and upon the fountains of waters;",
			verse: "Revelation 8:10"
		}, {
			quote: "And the fifth angel sounded, and I saw a star fall from heaven unto the earth: and to him was given the key of the bottomless pit.",
			verse: "Revelation 9:1"
		}, {
			quote: "And I will fill his mountains with his slain men: in thy hills, and in thy valleys, and in all thy rivers, shall they fall that are slain with the sword. I will make thee perpetual desolations, and thy cities shall not return: and ye shall know that I am the LORD.",
			verse: "Ezekiel 35:8-9"
		}, {
			quote: "For it is the day of the LORD'S vengeance, and the year of recompences for the controversy of Zion.",
			verse: "Isaiah 34:8"
		}, {
			quote: "Their slain also shall be cast out, and their stink shall come up out of their carcases, and the mountains shall be melted with their blood.",
			verse: "Isaiah 34:3"
		}, {
			quote: "And in those days shall men seek death, and shall not find it; and shall desire to die, and death shall flee from them.",
			verse: "Revelation 9:6"
		}, {
			quote: "Then Jael Heber's wife took a nail of the tent, and took an hammer in her hand, and went softly unto him, and smote the nail into his temples, and fastened it into the ground: for he was fast asleep and weary. So he died.",
			verse: "Judges 4:21"
		}, {
			quote: "And I looked, and behold a pale horse: and his name that sat on him was Death, and Hell followed with him. And power was given unto them over the fourth part of the earth, to kill with sword, and with hunger, and with death, and with the beasts of the earth.",
			verse: "Revelation 6:8"
		}, {
			quote: "For we wrestle not against flesh and blood, but against principalities, against powers, against the rulers of the darkness of this world, against spiritual wickedness in high places.",
			verse: "Ephesians 6:12"
		}, {
			quote: "Think not that I am come to send peace on earth: I came not to send peace, but a sword.",
			verse: "Matthew 10:34"
		}, {
			quote: "A time to love, and a time to hate; a time of war, and a time of peace.",
			verse: "Ecclesiastes 3:8"
		}, {
			quote: "And they of the people and kindreds and tongues and nations shall see their dead bodies three days and an half, and shall not suffer their dead bodies to be put in graves.",
			verse: "Revelation 11:1"
		}, {
			quote: "And the great dragon was cast out, that old serpent, called the Devil, and Satan, which deceiveth the whole world: he was cast out into the earth, and his angels were cast out with him.",
			verse: "Revelation 12:9"
		}, {
			quote: "Here is wisdom. Let him that hath understanding count the number of the beast: for it is the number of a man; and his number is Six hundred threescore and six.",
			verse: "Revelation 13:18"
		}, {
			quote: "And the kings of the earth, who have committed fornication and lived deliciously with her, shall bewail her, and lament for her, when they shall see the smoke of her burning,",
			verse: "Revelation 18:9"
		}, {
			quote: "Ye are of your father the devil, and the lusts of your father ye will do. He was a murderer from the beginning, and abode not in the truth, because there is no truth in him. When he speaketh a lie, he speaketh of his own: for he is a liar, and the father of it.",
			verse: "John 8:44"
		}, {
			quote: "And ye shall know the truth, and the truth shall make you free.",
			verse: "John 8:32"
		}, {
			quote: "Remember Lot's wife.",
			verse: "Luke 17:32"
		}, {
			quote: "But the same day that Lot went out of Sodom it rained fire and brimstone from heaven, and destroyed them all.",
			verse: "Luke 17:29"
		}, {
			quote: "Suppose ye that I am come to give peace on earth? I tell you, Nay; but rather division:",
			verse: "Luke 12:51"
		}, {
			quote: "For nation shall rise against nation, and kingdom against kingdom: and there shall be earthquakes in divers places, and there shall be famines and troubles: these are the beginnings of sorrows.",
			verse: "Mark 13:8"
		}, {
			quote: "But from the beginning of the creation God made them male and female.",
			verse: "Mark 10:6"
		}, {
			quote: "And I gave her space to repent of her fornication; and she repented not. Behold, I will cast her into a bed, and them that commit adultery with her into great tribulation, except they repent of their deeds. And I will kill her children with death;",
			verse: "Revelation 2:21-23"
		}, {
			quote: "Then shall he say also unto them on the left hand, Depart from me, ye cursed, into everlasting fire, prepared for the devil and his angels:",
			verse: "Matthew 25:51"
		}, {
			quote: "For then shall be great tribulation, such as was not since the beginning of the world to this time, no, nor ever shall be.",
			verse: "Matthew 24:21"
		}, {
			quote: "And then shall appear the sign of the Son of man in heaven: and then shall all the tribes of the earth mourn, and they shall see the Son of man coming in the clouds of heaven with power and great glory.",
			verse: "Matthew 24:30"
		}, {
			quote: "How art thou fallen from heaven, O Lucifer, son of the morning! how art thou cut down to the ground, which didst weaken the nations! For thou hast said in thine heart, I will ascend into heaven, I will exalt my throne above the stars of God: I will sit also upon the mount of the congregation, in the sides of the north: I will ascend above the heights of the clouds; I will be like the most High.",
			verse: "Isaiah 14:12-14"
		}, {
			quote: "The heart is deceitful above all things, and desperately wicked: who can know it?",
			verse: "Jeremiah 17:9"
		}, {
			quote: "Therefore deliver up their children to the famine, and pour out their blood by the force of the sword; and let their wives be bereaved of their children, and be widows; and let their men be put to death; let their young men be slain by the sword in battle.",
			verse: "Jeremiah 18:21"
		}, {
			quote: "And I will make void the counsel of Judah and Jerusalem in this place; and I will cause them to fall by the sword before their enemies, and by the hands of them that seek their lives: and their carcases will I give to be meat for the fowls of the heaven, and for the beasts of the earth.",
			verse: "Jeremiah 19:7"
		}, {
			quote: "They shall die of grievous deaths; they shall not be lamented; neither shall they be buried; but they shall be as dung upon the face of the earth: and they shall be consumed by the sword, and by famine; and their carcases shall be meat for the fowls of heaven, and for the beasts of the earth.",
			verse: "Jeremiah 16:4"
		}, {
			quote: "For thus saith the LORD, Enter not into the house of mourning, neither go to lament nor bemoan them: for I have taken away my peace from this people, saith the LORD, even lovingkindness and mercies.",
			verse: "Jeremiah 16:5"
		}, {
			quote: "There is a way which seemeth right unto a man, but the end thereof are the ways of death.",
			verse: "Proverbs 14:12"
		}, {
			quote: "Do not I hate them, O LORD, that hate thee? and am not I grieved with those that rise up against thee? I hate them with perfect hatred: I count them mine enemies.",
			verse: "Psalms 139:21-22"
		}, {
			quote: "And Samson said, With the jawbone of an ass, heaps upon heaps, with the jaw of an ass have I slain a thousand men.",
			verse: "Judges 15:16"
		}, {
			quote: "Understand therefore this day, that the LORD thy God is he which goeth over before thee; as a consuming fire he shall destroy them, and he shall bring them down before thy face: so shalt thou drive them out, and destroy them quickly, as the LORD hath said unto thee.",
			verse: "Deuteronomy 9:3"
		}, {
			quote: "Even as Sodom and Gomorrha, and the cities about them in like manner, giving themselves over to fornication, and going after strange flesh, are set forth for an example, suffering the vengeance of eternal fire.",
			verse: "Jude 1:7"
		}, {
			quote: "And they said, Go to, let us build us a city and a tower, whose top may reach unto heaven; and let us make us a name, lest we be scattered abroad upon the face of the whole earth.",
			verse: "Genesis 11:4"
		}, {
			quote: "Whoso sheddeth man's blood, by man shall his blood be shed: for in the image of God made he man.",
			verse: "Genesis 9:6"
		}, {
			quote: "And GOD saw that the wickedness of man was great in the earth, and that every imagination of the thoughts of his heart was only evil continually.",
			verse: "Genesis 6:5"
		}, {
			quote: "And let them be for lights in the firmament of the heaven to give light upon the earth: and it was so.",
			verse: "Genesis 1:15"
		}, {
			quote: "And God made two great lights; the greater light to rule the day, and the lesser light to rule the night: he made the stars also. And God set them in the firmament of the heaven to give light upon the earth,",
			verse: "Genesis 1:16-17"
		}, {
			quote: "And God said, Let the earth bring forth the living creature after his kind, cattle, and creeping thing, and beast of the earth after his kind: and it was so.",
			verse: "Genesis 1:24"
		}, {
			quote: "And God said, Let the waters under the heaven be gathered together unto one place, and let the dry land appear: and it was so.",
			verse: "Genesis 1:9"
		}, {
			quote: "Be of good courage, and let us play the men for our people, and for the cities of our God: and the LORD do that which seemeth him good.",
			verse: "2 Samuel 10:12"
		}, {
			quote: "Ye adulterers and adulteresses, know ye not that the friendship of the world is enmity with God? whosoever therefore will be a friend of the world is the enemy of God.",
			verse: "James 4:4"
		}, {
			quote: "And God made the firmament, and divided the waters which were under the firmament from the waters which were above the firmament: and it was so.",
			verse: "Genesis 1:7"
		}, {
			quote: ". . . In them hath he set a tabernacle for the sun, Which is as a bridegroom coming out of his chamber, and rejoiceth as a strong man to run a race. His going forth is from the end of the heaven, and his circuit unto the ends of it: and there is nothing hid from the heat thereof.",
			verse: "Psalms 19:4-6"
		}, {
			quote: "The heavens declare the glory of God; and the firmament sheweth his handywork.",
			verse: "Psalms 19:1"
		}, {
			quote: "For the time will come when they will not endure sound doctrine; but after their own lusts shall they heap to themselves teachers, having itching ears; And they shall turn away their ears from the truth, and shall be turned unto fables.",
			verse: "2 Timothy 4:3-4"
		}, {
			quote: "O Timothy, keep that which is committed to thy trust, avoiding profane and vain babblings, and oppositions of science falsely so called: Which some professing have erred concerning the faith. Grace be with thee. Amen.",
			verse: "1 Timothy 6:20-21"
		}, {
			quote: "There is neither Jew nor Greek, there is neither bond nor free, there is neither male nor female: for ye are all one in Christ Jesus.",
			verse: "Galatians 3:28"
		}, {
			quote: "Because that which may be known of God is manifest in them; for God hath shewed it unto them. For the invisible things of him from the creation of the world are clearly seen, being understood by the things that are made, even his eternal power and Godhead; so that they are without excuse:",
			verse: "Romans 1:19-20"
		}, {
			quote: "But ye have borne the tabernacle of your Moloch and Chiun your images, the star of your god, which ye made to yourselves. Therefore will I cause you to go into captivity beyond Damascus, saith the LORD, whose name is The God of hosts.",
			verse: "Amos 5:26-27"
		}, {
			quote: "Be sober, be vigilant; because your adversary the devil, as a roaring lion, walketh about, seeking whom he may devour:",
			verse: "1 Peter 5:8"
		}, {
			quote: "And I saw, and behold a white horse: and he that sat on him had a bow; and a crown was given unto him: and he went forth conquering, and to conquer.",
			verse: "Revelation 6:2"
		}, {
			quote: "And his tail drew the third part of the stars of heaven, and did cast them to the earth: and the dragon stood before the woman which was ready to be delivered, for to devour her child as soon as it was born.",
			verse: "Revelation 12:4"
		}, {
			quote: "And I give unto them eternal life; and they shall never perish, neither shall any man pluck them out of my hand.",
			verse: "John 10:28"
		}, {
			quote: "Wherein was written, It is reported among the heathen, and Gashmu saith it, that thou and the Jews think to rebel: for which cause thou buildest the wall, that thou mayest be their king, according to these words.",
			verse: "Nehemiah 6:6"
		}, {
			quote: "Blessed is the nation whose God is the LORD; and the people whom he hath chosen for his own inheritance.",
			verse: "Psalm 33:12"
		}, {
			quote: "Else if ye do in any wise go back, and cleave unto the remnant of these nations, even these that remain among you, and shall make marriages with them, and go in unto them, and they to you: Know for a certainty that the LORD your God will no more drive out any of these nations from before you; but they shall be snares and traps unto you, and scourges in your sides, and thorns in your eyes, until ye perish from off this good land which the LORD your God hath given you.",
			verse: "Joshua 23:12-13"
		}, {
			quote: "Hast thou perceived the breadth of the earth? declare if thou knowest it all. Where is the way where light dwelleth? and as for darkness, where is the place thereof,",
			verse: "Job 38:18-19"
		}, {
			quote: "Praise him, ye heavens of heavens, and ye waters that be above the heavens.",
			verse: "Psalms 148:4"
		}, {
			quote: "The world cannot hate you; but me it hateth, because I testify of it, that the works thereof are evil.",
			verse: "John 7:7"
		}
	],
	getRandomQuoteAndVerse: function() {
		var index = ~~(Math.random() * this.quotes.length);
		return this.quotes[index];
	}
};
// ui.js

var ui = {
	defenseBonus: [1, 2, 3],
	defenseReductionAmount: [1, 3, 6],
	cannonDamage: function() {
		var cannonBonus = my.government === 'Monarchy' ? 2 : 0;
		return (2 + my.oBonus + cannonBonus) +'-'+ (4 + my.oBonus + cannonBonus) + lang[my.lang].damage;
	},
	cannonTooltip: function() {
		return lang[my.lang].fireCannons + ui.cannonDamage();
	},
	missileDamage: function() {
		return (7 + (my.oBonus * 2)) +'-'+ (12 + (my.oBonus * 2)) + lang[my.lang].damage;
	},
	missileTooltip: function() {
		return lang[my.lang].launchMissile + ui.missileDamage();
	},
	rushTooltip: function(ind) {
		return lang[my.lang].rush + '('+ ui.cultureBonus() +')';
	},
	defenseTooltip: function(ind) {
		return lang[my.lang].boostsTileDefenses + ui.defenseBonus[ind] + lang[my.lang].reducesWeaponsBy + ui.defenseReductionAmount[ind];
	},
	cultureBonus: function() {
		return (2 + ~~(my.cultureBonus / 50));
	},
	getTeamIcon: function(team) {
		return g.teamMode ? '<span class="diploTeam">'+ team +'</span>' : '';
	},
	updateTileInfo: function(tileId) {
		var t = game.tiles[tileId],
			flag = "blank.png",
			name = t.name;

		if (t.player === 0){
			flag = "Barbarian.jpg";
			if (t.units > 0){
				name = lang[my.lang].barbarianTribe;
			}
			else {
				name = lang[my.lang].uninhabited;
				flag = "blank.png";
			}
		}
		else {
			flag = t.flag;
			name = t.name;
			flag = flag.split('.')[0];
			flag = flag + ui.getFlagExt(flag);
		}
		// tileName and bars
		var o = {
			food: 0,
			culture: 0,
			production: 0,
			defense: 0
		};
		if (t.player){
			o.food = ~~(((t.food > 8 ? 8 : t.food) / 8) * 99);
			o.production = ~~(((t.production > 8 ? 8 : t.production) / 8) * 99);
			o.culture = ~~(((t.culture > 8 ? 8 : t.culture) / 8) * 99);
			o.defense = ~~((t.defense / 4) * 99);
		}
		var resources =
			'<span>' + t.food + '<img src="images/icons/food.png" class="fw-icon-sm"></span>'+
			'<span>' + t.production + '<img src="images/icons/production.png" class="fw-icon-sm"></span>'+
			'<span>' + t.culture + '<img src="images/icons/culture.png" class="fw-icon-sm"></span>'+
			'<span>' + t.defense + '<img src="images/icons/tile-defense.png" class="fw-icon-sm"></span>';
		// DOM.targetCapStar.style.display = t.capital ? 'inline' : 'none';
		DOM.targetNameWrap.innerHTML = name;
		DOM.targetResources.innerHTML = resources;
		DOM.targetFlag.src = 'images/flags/' + flag;


		if (t.player === my.player && my.tech.masonry) {
			var ind = t.defense - t.capital;
			if (ind < 3) {
				// fortress present
				// console.info('buildCost ', ind, g.upgradeCost[ind], my.buildCost, g.upgradeCost[ind]);
				DOM.buildWord.textContent = lang[my.lang].defenseLabel[ind];
				DOM.buildCost.textContent = g.upgradeCost[ind];
				var tooltip = ui.defenseTooltip(ind);
				$('#upgradeTileDefense')
					.attr('title', tooltip)
					.tooltip('fixTitle')
					.tooltip('hide')
					.tooltip({
						animation: false,
						placement: 'bottom',
						container: 'body'
					});
			}
			// actions panel
		}
		action.setBuildButton();
		animate.target();
	},
	getDiploRow: function(p) {
		var account = p.cpu ? lang[my.lang].difficulties[p.difficulty] : p.account,
			icon = lobby.governmentIcon(p),
			color = game.player[p.player].playerColor;

		var str =
		'<div id="diplomacyPlayer' + color + '" class="diplomacyPlayers alive pb'+ color +'">'+
			// bg
			'<div class="diplo-pipe pbar'+ color +'"></div>'+
			'<img src="images/flags/'+ p.flagSrc +'" class="diplo-flag no-select">'+
			// row 1
			'<div class="diplo-data-col"' +
				'<div>'+
					'<div class="nowrap">'+ icon + account +'</div>' +
					'<div class="nowrap">'+ ui.getTeamIcon(p.team) + p.nation + '</div>'+
				'</div>'+
				// row 2
			'</div>' +

		'</div>';
		return str;
	},
	getPlayersByTileRank: function() {
		var arr = [0,0,0,0,0,0,0,0,0];
		for (var i=0, len=game.tiles.length; i<len; i++) {
			game.tiles[i].player && arr[game.tiles[i].player]++;
		}
		return arr;
	},
	drawDiplomacyPanel: function() {
		var strArr = [],
			p, i, len,
			rankedPlayers = ui.getPlayersByTileRank();

		ui.currentLoser = 99;
		for (i=1, len=rankedPlayers.length; i<len; i++) {
			if (rankedPlayers[i] && rankedPlayers[i] < ui.currentLoser) {
				ui.currentLoser = rankedPlayers[i];
			}
		}

		for (i=0, len = game.player.length; i<len; i++){
			p = game.player[i];
			if (p.account && rankedPlayers[i]){
				p.flagArr = p.flag.split(".");
				p.flagShort = p.flagArr[0];
				p.flagSrc = p.flag;

				while (strArr[rankedPlayers[i]] !== undefined) {
					rankedPlayers[i]++;
				}
				strArr[rankedPlayers[i]] = ui.getDiploRow(p);
			}
		}
		DOM.diplomacyBody.innerHTML = strArr.reverse().join("");
		// check elimination
		rankedPlayers.forEach(function(v, index) {
			if (game.player[index] !== void 0 &&
				index && game.player[index].alive && !v) {
				console.info("Eliminate this player: ", index);
				game.publishEliminatePlayer(index);
			}
		});
	},
	currentLoser: 0,
	resizeWindow: function() {
		g.view === 'game' && applyBounds();
		g.screen.resizeMap();
	},
	windowDefault: 'window-full-screen',
	initWindow: function() {
		var size = localStorage.getItem('window-size');
		if (size === null) {
			localStorage.setItem('window-size', ui.windowDefault);
			size = ui.windowDefault;
		}
		ui.setWindow(size);
	},
	setWindow: function(size) {
		if (app.isApp) {
			var gui = require('nw.gui'),
				win = gui.Window.get();
			// ??????? reasons
			setTimeout(function() {
				if (size === 'window-full-screen') {
					!win.isFullscreen && win.enterFullscreen();
				}
				else if (size === 'window-1920-1080') {
					win.isFullscreen && win.leaveFullscreen();
					win.resizeTo(1920, 1080);
					win.maximize();
				}
				else if (size === 'window-1600-900') {
					win.isFullscreen && win.leaveFullscreen();
					win.resizeTo(1600, 900);
				}
				else if (size === 'window-1360-768') {
					win.isFullscreen && win.leaveFullscreen();
					win.resizeTo(1360, 768);
				}
				else if (size === 'window-1280-720') {
					win.isFullscreen && win.leaveFullscreen();
					win.resizeTo(1280, 720);
				}
				else {
					// just in case do this
					size = 'window-full-screen';
					!win.isFullscreen && win.enterFullScreen();
				}
				// always do this
				$("#current-window-size").text(lang[my.lang][g.camel(size)]);
				localStorage.setItem('window-size', size);
			}, 100);
		}
	},
	click: 'click',
	showTarget: function(e, hover, skipOldTgtUpdate){
		if (e.id === undefined){
			e.id = 'land0';
		}
		if (typeof e === 'object'){
			var tileId = e.id.slice(4)*1;
			var d = game.tiles[tileId];
			var cacheOldTgt = my.tgt;
			if (!hover){
				if (cacheOldTgt !== tileId){
					my.tgt = tileId;
					animate.selectTile(cacheOldTgt, tileId);
				}
			}
			// animate targetLine on hover
			if (hover && tileId !== my.tgt){
				my.targetLine[4] = DOM['unit' + tileId].getAttribute('x')*1 - 10;
				my.targetLine[5] = DOM['unit' + tileId].getAttribute('y')*1 - 10;
				// draw straight line because it's close?
				var straightLine = "M " + my.targetLine[0] +","+ my.targetLine[1] + " "
								+ my.targetLine[4] +","+ my.targetLine[5],
					totalCoordDiff = 0;
				totalCoordDiff += Math.abs(my.targetLine[0] - my.targetLine[4]);
				totalCoordDiff += Math.abs(my.targetLine[1] - my.targetLine[5]);
				my.targetLine[2] = (my.targetLine[0] + my.targetLine[4]) / 2;
				my.targetLine[3] = ((my.targetLine[1] + my.targetLine[5]) / 2) - 100;
				var arcLine = "M " + my.targetLine[0] +","+ my.targetLine[1] +
							" Q " + my.targetLine[2] +" "+ my.targetLine[3] + " "
							+ my.targetLine[4] +" "+ my.targetLine[5];
				// set path data for shadow
				TweenMax.set(DOM.targetLineShadow, {
					visibility: 'visible',
					attr: {
						d: straightLine
					}
				});
				// set path data for line
				TweenMax.set([DOM.targetLine, DOM.targetLineBorder], {
					visibility: 'visible',
					attr: {
						d: totalCoordDiff > 300 ? arcLine : straightLine
					}
				});
				/*
				TweenMax.to([DOM.targetLine, DOM.targetLineBorder, DOM.targetLineShadow], .5, {
				  	startAt: { drawSVG: '0%' },
				  	drawSVG: '100%'
				});
				 */

				TweenMax.set([DOM.arrowhead, DOM.arrowheadBorder], {
					visibility: 'hidden'
				});
				TweenMax.set(DOM.targetLineBorder, {
					stroke: g.color[game.player[my.player].playerColor]
				});
				TweenMax.to([
					DOM.targetLine,
					DOM.targetLineBorder,
					DOM.targetLineShadow], .2, {
				  	startAt: {
				  		drawSVG: '0%'
					},
				  	drawSVG: '100%',
					onComplete: function() {
						TweenMax.set([DOM.arrowhead, DOM.arrowheadBorder], {
							visibility: 'visible'
						});
						TweenMax.to([DOM.targetLine, DOM.targetLineShadow], .5, {
							startAt: {
								strokeDasharray: '31,1',
								strokeDashoffset: 0,
							},
							strokeDashoffset: -32,
							repeat: -1,
							force3D: true,
							ease: Linear.easeNone
						});
						// fade in the black border
						TweenMax.to(DOM.targetLineBorder, .5, {
							stroke: '#000'
						});
					}
				});
				TweenMax.set(DOM.targetCrosshair, {
					fill: '#00dd00',
					visibility: 'visible',
					x: my.targetLine[4] - 255,
					y: my.targetLine[5] - 257,
					transformOrigin: '50% 50%'
				})
				TweenMax.to(DOM.targetCrosshair, 1, {
					startAt: { scale: .35 },
					force3D: true,
					scale: .175,
					repeat: -1,
					ease: Power4.easeOut
				});
				TweenMax.to(DOM.targetCrosshair, 1, {
					startAt: { opacity: 1 },
					force3D: true,
					opacity: 0,
					repeat: -1,
					ease: Power2.easeIn
				});
			}
			// tile data
			if (!skipOldTgtUpdate){
				my.lastTgt = cacheOldTgt;
			}
			ui.updateTileInfo(tileId);
		} else {
			my.attackOn = false;
			my.attackName = '';
		}
	},
	/*
	targetBars: function(o){
		var spacing = 8;
		var str = 
			'<line class="targetBars targetBarsFood" opacity="'+ (o.food ? 1 : 0) +'" x1="1%" x2="'+ o.food +'%" y1="'+ o.yPos +'" y2="'+ o.yPos +'" />';
			o.yPos += spacing;
			str += '<line class="targetBars targetBarsProduction" opacity="'+ (o.production ? 1 : 0) +'" x1="1%" x2="'+ o.production +'%" y1="'+ o.yPos +'" y2="'+ o.yPos +'" />';
			o.yPos += spacing;
			str += '<line class="targetBars targetBarsCulture" opacity="'+ (o.culture ? 1 : 0) +'"x1="1%" x2="'+ o.culture +'%" y1="'+ o.yPos +'" y2="'+ o.yPos +'" />';
			o.yPos += spacing;
			str += '<line class="targetBars targetBarsDefense" opacity="'+ (o.defense ? 1 : 0) +'"x1="1%" x2="'+ o.defense +'%" y1="'+ o.yPos +'" y2="'+ o.yPos +'" />';
		return str;
	},
	*/
	transformYear: function(tick){
		var foo = tick >= 40 ? ' A.D.' : ' B.C.',
			year = 0;
		if (tick <= 40){
			year = 4000 - (tick * 100);
		} else if (tick <= 60){
			year = 0 + ((tick - 40) * 50);
		} else if (tick <= 80){
			year = 1000 + ((tick - 60) * 25);
		} else if (tick <= 120){
			year = 1500 + ((tick - 80) * 10);
		} else if (tick <= 170){
			year = 1900 + ((tick - 120) * 2);
		} else {
			year = 2000 + ((tick - 170) * 1);
		}
		return year + foo;
	},
	transformEra: function(tick) {

	},
	setCurrentYear: function(tick){
		DOM.currentYear.textContent = ui.transformYear(tick);
	},
	setTileUnits: function(i){
		var unitVal = game.tiles[i].capital ?
			'<tspan class="unit-star">\t&#10028;</tspan>' + ~~game.tiles[i].units :
			~~game.tiles[i].units;
		DOM['unit' + i].innerHTML = game.tiles[i].units === 0
			? "" : unitVal;
		TweenMax.to(DOM['unit' + i], .5, {
			startAt: {
				visibility: 'visible',
			},
			opacity: 1,
			ease: Power4.easeIn
		});
		/*ui.setUnitVisibility(i);
		ui.updateAdjacentTileVisibility(i);*/
	},
	updateAdjacentTileVisibility: function(i) {
		/*game.tiles[i].adj.forEach(function(v) {
			var adjacent = game.isMineOrAdjacent(v);
			TweenMax.to(DOM['unit' + v], .5, {
				startAt: {
					visibility: adjacent ? 'visible' : 'hidden'
				},
				opacity: adjacent ? 1 : 0
			});
			game.tiles[v].units & TweenMax.set(DOM['land' + v], {
				filter: adjacent ? '' : 'url(#darken)'
			});
		});*/
	},
	setUnitVisibility: function(i) {
		// player visibility logic
		TweenMax.set(DOM['unit' + i], {
			startAt: {
				fill: '#ffffff',
				visibility: game.tiles[i].units ? 'visible' : 'hidden'
			},
			opacity: 1
		});
		/*
		game.tiles[i].units & TweenMax.set(DOM['land' + i], {
			filter: adjacent ? '' : 'url(#darken)'
		});*/
	},
	pngFlags: ['Ohio', 'Nepal'],
	isFlagPng: function(flag) {
		return this.pngFlags.indexOf(flag) > -1;
	},
	getFlagExt: function(flag) {
		return this.pngFlags.indexOf(flag) > -1 ? '.png' : '.jpg';
	}
};
/*function checkMobile(){
	var x = false;
	if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent) 
    || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))) x = true;
	return x;
};*/
// browser/environment checks
/*var isXbox = /Xbox/i.test(navigator.userAgent),
    isPlaystation = navigator.userAgent.toLowerCase().indexOf("playstation") >= 0,
    isNintendo = /Nintendo/i.test(navigator.userAgent),
    isOpera = !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0,
    isFirefox = typeof InstallTrigger !== 'undefined',
    isSafari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0,
    isChrome = !!window.chrome && !isOpera,
    isMSIE = /!*@cc_on!@*!/ false,
    isMSIE11 = !!navigator.userAgent.match(/Trident\/7\./);*/
// browser dependent
/*(function(){
	if (isMSIE || isMSIE11){
		//alert("Firmament Wars does not support Internet Explorer. Consider using Chrome or Firefox for an enjoyable experience.");
		//window.stop();
		if (x === null){
			alert("Oh no! It looks like you're using Internet Explorer! Please consider using Chrome or Firefox for a better experience!");
		}
		$("head").append('<style> text { font-family: Verdana; stroke-width: 0; stroke: #000; fill: #fff; } .unit{ font-size: 26px; } </style>');
	} else if (isSafari){
		//alert("Firmament Wars does not support Safari. Consider using Chrome or Firefox for an enjoyable experience.");
		//window.stop();
		if (x === null){
			alert("Oh no! It looks like you're using Safari! Please consider using Chrome or Firefox for a better experience!");
		}
		$("head").append('<style> text { fill: #ffffff; stroke: none; stroke-width: 0px; } </style>');
	}
	setTimeout(function(){
		$("script").remove();
	}, 1000);
	ui.initWindow();
})();*/


function gameDefeat(){
	new Audio('sound/shotgun2.mp3');
	$.ajax({
		type: "GET",
		url: app.url + "php/gameDefeat.php"
	}).done(function(data){
		console.info("DEFEAT: ", data);
		var msg = '';
		if (data.ceaseFire){
			msg = [
				'<p>'+ lang[my.lang].armistice +'</p>',
				'<div>'+ lang[my.lang].gameArmistice +'</div>',
				'<div id="ceaseFire" class="endBtn">',
					'<div class="modalBtnChild">'+ lang[my.lang].ceaseFire +'</div>',
				'</div>',
			].join('');
		}
		else if (data.lose){
			msg =
			'<p>'+ lang[my.lang].defeat +'</p>\
			<div>'+ lang[my.lang].gameDefeat +'</div>';
			if (g.showSpectateButton){
				msg +=
				'<div id="spectate" class="endBtn">\
					<div class="modalBtnChild">'+ lang[my.lang].spectate +'</div>\
				</div>';
			}
			msg += '<div id="endWar" class="endBtn">\
				<div class="modalBtnChild">'+ lang[my.lang].concede +'</div>\
			</div>';
		}
		if (msg){
			triggerEndGame(msg);
		}
	}).fail(function(data){
		console.info("FAIL: ", data);
	});
}


function gameVictory(){
	new Audio('sound/sniper0.mp3');
	(function repeat(){
		$.ajax({
			type: "POST",
			url: app.url + "php/gameVictory.php",
			data: {
				juggernautValid: action.isJuggernautValid(),
				playerCount: action.getPlayerCount()
			}
		}).done(function(data){
			var msg = '';
			console.info('VICTORY: ', data);
			if (data.ceaseFire){
				msg =
				'<p>'+ lang[my.lang].armistice +'</p>\
				<div>'+ lang[my.lang].gameArmistice +'</div>\
				<div id="ceaseFire" class="endBtn">\
					<div class="modalBtnChild">'+ lang[my.lang].ceaseFire +'</div>\
				</div>';
				audio.play('shotgun2');
			}
			else if (data.win){
				msg =
				'<p>'+ lang[my.lang].congratulations +'</p>\
				<div>'+ lang[my.lang].gameVictory +'</div>\
				<div id="endWar" class="endBtn">\
					<div class="modalBtnChild">'+ lang[my.lang].victory +'</div>\
				</div>';
				g.victory = true;
			}
			if (msg){
				triggerEndGame(msg, 1);
			}
		}).fail(function(data){
			console.warn(data.responseText);
		});
	})();
}
function triggerEndGame(msg, victory){
	localStorage.setItem('disconnects', 0);
	g.gameDuration = ~~((Date.now()- ((sessionStorage.getItem('gameDuration') * 1))) / 1000);
	$("#chat-input-open, #chat-input-wrap").remove();
	window.onbeforeunload = null;
	setTimeout(function(){
		// allow for last update to occur for spectators
		g.over = 1;
	}, 1500);
	stats.get();
	new Image('images/FlatWorld90.jpg');
	setTimeout(function(){
		var e = document.getElementById('victoryScreen');
		e.innerHTML = msg;
		e.style.display = 'block';
		if (victory){
			audio.play('sniper0');
		} else {
			audio.play('shotgun2');
		}
		$("#endWar").on(ui.click, function(){
			$("#endWar").off();
			g.view = 'stats';
			TweenMax.to('#gameWrap', .05, {
				alpha: 0,
				onComplete: function(){
					$("#ui2-head, #diplomacy-ui, #chat-input-open, #chat-ui, #chat-input-wrap, #hud, #worldWrap, #victoryScreen").remove();
					stats.show();
				}
			});
		});
		$("#ceaseFire").on(ui.click, function(){
			location.reload();
		});
		$("#spectate").on(ui.click, function(e){
			$("#victoryScreen, #ui2, #resourceBody, #targetWrap").remove();
			document.getElementById('surrender').style.display = "none";
			document.getElementById('exitSpectate').style.display = "inline";
			g.spectateStatus = 1;
		});
		$("#exitSpectate").on(ui.click, function(){
			$(this).off(ui.click);
			stats.get();
			TweenMax.to('#diplomacy-ui', 1, {
				alpha: 0,
				onComplete: function(){
					stats.show();
				}
			});
		});
	}, 2500);
};
function testAdj() {
	game.tiles.forEach(function(v, i) {
		if (!v.adj.length) {
			TweenMax.set(DOM['land' + i], {
				stroke: "#0f0",
				strokeWidth: 3
			});
		}
	});
	setTimeout(function() {
		testAdj();
	}, 3000);
}
function testNames() {
	g.map.tileNames.forEach(function(v, i) {
		console.info(v, i);
		if (v === 'XXXXXXXX') {
			TweenMax.set(DOM['land' + i], {
				stroke: "#0f0",
				strokeWidth: 3
			});
		}
	});
}
// lang.js
var lang = {
	updateIndexHtml: function() {
		// innerHTML elements that need to be populated
		[
			'howToPlay',
			'play-now-btn',
			'create',
			'createTeamBtn',
			'joinPrivateGameBtn',
			'createRankedBtn',
			'joinRankedGame',
			'toggleNation',
			'leaderboardBtn',
			'gameTableName',
			'gameTableMap',
			'gameTableType',
			'friend-status',
			'add-friend',
			'ignore-status',
			'ignore-user',
			'who-account',
			'whisper-account',
			'change-channel',
			'get-help',
			'brokenNet',
			'optionsHeader',
			'musicVolume',
			'soundVolume',
			'bibleMode',
			'windowSize',
			'current-window-size',
			'window-full-screen',
			'window-1920-1080',
			'window-1600-900',
			'window-1360-768',
			'window-1280-720',
			'reset-game',
			'exit-game',
			'versionSpan',
			'leaderboardRankedBtn',
			'leaderboardFfaBtn',
			'leaderboardTeamBtn',
			'setNationName',
			'submitNationName',
			'setNationFlag',
			'lobbyRankedMatch',
			'lobbyGameNameLabel',
			'lobbyGamePasswordLabel',
			'lobbyGameModeLabel',
			'lobbyGameMapLabel',
			'lobbyMaxPlayersLabel',
			'startGame',
			'cancelGame',
			'confirmSurrenderPrompt',
			'canceSurrenderButtonCancel',
			'surrenderButtonConfirm',
			'hotkey-ui',
			'createGame',
			'createGameHead',
			'createRankedGameHead',
			'createGameNameLabel',
			'createGamePasswordLabel',
			'createGameMaxPlayerLabel',
			'createGameMapLabel',
			'privateGameNameLabel',
			'privateGamePasswordLabel',
			'joinPrivateGameBtnConfirm',
			'cancelGame',
			'cancelGame',
			'cancelGame',
			'cancelGame',
			'cancelGame',
			'cancelGame',
			'cancelGame',
			'joinPrivateGameBtn',
			'abAttack',
			'abSplitAttack',
			'abDeploy',
			'abRush',
			'abBuild',
			'abCannons',
			'abMissile',
			'abNuke',
			'abResearch',
			'abMasonry',
			'abConstruction',
			'abEngineering',
			'abGunpowder',
			'abRocketry',
			'abAtomic',
			'abFuture',
			'reserveLabel',
			'troopsLabel',
			'hud',
			'foodMilestoneLabel',
			'scienceMilestoneLabel',
			'cultureMilestoneLabel',
			'updateNationBtn',
		].forEach(function(v) {
			document.getElementById(v).innerHTML = lang[my.lang][_.camelCase(v)];
		});
		// titles/tooltips
		[
			'hide-ui',
			'toggle-flags',
			'hotkeys',
			'gameOptions',
			'surrender',
			'exitSpectate',
			'energy-timer-base',
			'currentYear',
			'energyWrap',
			'foodWrap',
			'scienceWrap',
			'cultureWrap',
			'generalWrap',
			'tacticianWrap',
			'troop-flex',
			'foodBonusTitle',
			'foodMilestoneTitle',
			'scienceBonusTitle',
			'scienceMilestoneTitle',
			'cultureBonusTitle',
			'cultureMilestoneTitle',
			'attack',
			'splitAttack',
			'deploy',
			'rush',
			'upgradeTileDefense',
			'launchNuke',
			'researchMasonry',
			'researchConstruction',
			'researchEngineering',
			'researchGunpowder',
			'researchRocketry',
			'researchAtomicTheory',
			'researchFutureTech',
			'options',
		].forEach(function(v) {
			document.getElementById(v).title = lang[my.lang][_.camelCase(v)];
		})

	},
	english: {
		resetGame: 'Reset Game',
		updateNationBtn: 'Done',
		playerColor: 'Player Color',
		team: 'Team',
		damage: ' damage',
		hudAttack: 'Attack: Select Target',
		hudSplitAttack: 'Split Attack: Select Target',
		hudFireCannons: 'Fire Cannons',
		hudLaunchMissile: 'Launch Missile',
		hudLaunchNuke: 'Launch Nuclear Weapon',
		resourceUiWidth: '22rem',
		selectTarget: 'Select Target',
		reserveLabel: 'Reserve',
		troopsLabel: 'Troops',
		youHaveJoined: 'You have joined the game: ',
		startingGame: "Starting game in ",
		to: 'To ',
		whispers: ' whispers: ',
		joinedChannel: "You have joined channel: ",
		selectTeam: 'Select Team',
		selectPlayerColor: 'Select Player Color',
		difficulties: {
			'Very Easy': 'Very Easy',
			Easy: 'Easy',
			Normal: 'Normal',
			Hard: 'Hard',
			'Very Hard': 'Very Hard',
			Mania: 'Mania',
			Juggernaut: 'Juggernaut'
		},
		governments: {
			Despotism: 'Despotism',
			Monarchy: 'Monarchy',
			Democracy: 'Democracy',
			Fundamentalism: 'Fundamentalism',
			Fascism: 'Fascism',
			Republic: 'Republic',
			Communism: 'Communism',
			Random: 'Random'
		},
		random: 'Random',
		abAttack: "Attack",
		abSplitAttack: "Split Attack",
		abDeploy: "Deploy Troops",
		abRush: "Rush Troops",
		abBuild: "Build",
		abCannons: "Fire Cannons",
		abMissile: "Launch Missile",
		abNuke: "Launch Nuke",
		abResearch: "Research",
		abMasonry: "Masonry",
		abConstruction: "Construction",
		abEngineering: "Engineering",
		abGunpowder: "Gunpowder",
		abRocketry: "Rocketry",
		abAtomic: "Atomic Theory",
		abFuture: "Future Tech",
		hostLeft: "The host has left the lobby.",
		needTwoPlayers: "You need two players to start a game! Wait for players to join or add a computer player to begin.",
		failedToLoad: "Failed to load game data.",
		flagChanged: "Your nation's flag is now: ",
		rankedSearch: "Searching for ranked games...",
		noRankedFound: "No ranked games found!<br>Try creating a ranked game instead.",
		notScience: "Not enough science!",
		needTwoUnits: "You need at least 2 troops to move or attack!",
		maxUnits: "That territory has the maximum number of units!",
		friendlyFire: "Friendly fire! That's your teammate!",
		notEnoughEnergy: 'Not enough energy!',
		notYourTile: 'You do not own that tile.',
		noTroopsAvailable: "No troops available for deployment!",
		badGameName: "Game name must be at least 4-32 characters.",
		notEnoughPlayers: "Game must have 2-8 players.",
		newNationName: "Your new nation name is: ",
		verifyingSteam: "Verifying Steam Credentials...",
		steamNotFound: "Unable to detect Steam. Please launch Steam and try again!",
		logoutSuccess: "Logout successful",
		logoutFailed: "Logout failed",
		ribbonTitle: ['',
			'National Combat Medal',
			'Tactical Nuke Recognition Award',
			'Good Conduct Award',
			"Patriot's Service Ribbon",
			'Civic Service Ribbon',//5
			'Bronze Meritorious Medal',
			'Bronze Service Medal',
			'Bronze Expeditionary Medal',
			'Bronze Cross',
			'Silver Cross',//10
			'Golden Cross',
			'Platinum Cross',
			'Revolutionary Cause Award',
			'Strategic Warfare Award',
			'Combat Service Award', //15
			'Combat Gallantry Award',
			"Stalwart Conqueror's Medal",
			"Dictator's Sword",
			"King's Regalia",
			"Archon's Scales",//20
			'Divine Covenant',
			"Emperor's Fasces",
			"Eagle's Branch",
			"Comrade's Sickle",
			'Golden Expeditionary Medal',//25
			'Golden Meritorious Medal',
			'Golden Service Medal',
			"Champion's Medal",
			"Conqueror's Medal",
			"Commander's Medal",//30
			"Intrepid Heroism Award",
			'Global War Expeditionary Medal',
			'Silver Expeditionary Medal',
			'Silver Meritorious Medal',
			'Silver Service Medal',//35
			"Engineer's Service Ribbon",
		],
		ribbonDescription: ['', // 0
			'Established your nation',
			'Destroyed a fortress with a nuclear weapon',
			'Added two comrades to your friend list',
			'Updated your national flag',
			"Updated your nation's name",//5
			'Won 10 ranked games',
			'Won 10 team games',
			'Won 10 free for all games',
			'Achieved 1800+ rating',
			'Achieved 2100+ rating',//10
			'Achieved 2400+ rating',
			'Achieved 2700+ rating',
			'Great Revolutionary conquered a tile with 100+ units', //13
			'Win a game with a 2-to-1 kill ratio',
			'Won 10 games in a row', // 15
			'Won 25 games in a row',
			'Conquered a tile with a fortress',// 17
			"Won a game under Despotism",
			'Won a game as a Monarchy',
			'Won a game as a Democracy',//20
			'Won a game under Fundamentalism',
			'Won a game under Fascism',
			'Won a game as a Republic',
			'Won a game under Communism',
			'Won 500 free for all games',//25
			'Won 500 ranked games',
			'Won 500 team games',
			"Hit top #10 on the ranked leaderboard",
			"Hit top #100 on the ranked leaderboard",
			"Hit top #1000 on the ranked leaderboard",//30
			"Defeated the Juggernaut",
			'Win an 8-player free for all game',
			'Won 100 free for all games',
			'Won 100 ranked games',
			'Won 100 team games',//35
			'Build a fortress',
		],
		gameNameNotValid: "Game name is not valid!",
		congratulations: "Congratulations!",
		gameVictory: "Your campaign for global domination has succeeded!",
		victory: "Victory",
		armistice: "Armistice!",
		gameArmistice: "The campaign has been suspended!",
		ceaseFire: "Cease Fire",
		defeat: "Defeat!",
		gameDefeat: "Your campaign for world domination has failed!",
		concede: "Concede Defeat",
		spectate: "Spectate",
		defeatIn: "Defeat in ",
		statOverview: "Overview",
		statUnits: "Units",
		statStructures: "Structures",
		statWeapons: "Weapons",
		statResources: "Resources",
		tabUnits: "Units",
		tabStructures: "Structures",
		tabWeapons: "Weapons",
		tabResources: "Resources",
		tabTotalScore: "Total Score",
		tabEarned: "Earned",
		tabDeployed: "Deployed",
		tabKilled: "Killed",
		tabLost: "Lost",
		tabBunkers: "Bunkers",
		tabWalls: "Walls",
		tabFortresses: "Fortresses",
		tabCannons: "Cannons",
		tabMissiles: "Missiles",
		tabNukes: "Nukes",
		tabEnergy: "Energy",
		tabScience: "Science",
		tabFood: "Food",
		tabCulture: "Culture",
		gameDuration: "Game Duration ",
		endGame: "End Game",
		joinPrivateGameBtnConfirm: "Join Game",
		createGameHead: "Free For All Game",
		createRankedGameHead: "Ranked Game",
		createGameNameLabel: "Game Name",
		createGamePasswordLabel: "Password (optional)",
		createGameMaxPlayerLabel: "Maximum Players:",
		createGameMapLabel: "Map",
		createGame: "Create Game",
		createTeamGameHeadLabel: "Team Game",
		noRankedGamesFound: "No ranked games found!<br>Try creating a ranked game instead.",
		privateGameNameLabel: "Game Name",
		privateGamePasswordLabel: "Password",
		confirmSurrenderPrompt: "Surrender? Are You Sure?",
		canceSurrenderButtonCancel: "Cancel",
		surrenderButtonConfirm: "Surrender",
		hotkeyUi: "[V] Toggle the User Interface",
		options: "[ESC] Options",
		researchMasonry: "[Y] Research masonry to unlock bunkers\r\n(20 seconds)",
		researchConstruction: "[O] Research construction to unlock walls\r\n(30 seconds)",
		researchEngineering: "[E] Research engineering to unlock fortresses\r\n(45 seconds)",
		researchGunpowder: "[G] Research gunpowder to unlock cannons\r\n(25 seconds)",
		researchRocketry: "[K] Research rocketry to unlock missiles\r\n(40 seconds)",
		researchAtomicTheory: "[T] Research atomic theory to unlock nuclear weapons\r\n(60 seconds)",
		researchFutureTech: "[F] Research future technology\r\n(90 seconds)",
		attack: "[A] Attack with all troops",
		splitAttack: "[S] Attack with half of your troops",
		deploy: "[D] Deploy reserve troops to a tile",
		rush: "[R] Rush troops from your citizenry. Boosted by culture bonus ",
		defenseLabel: ['Bunker', 'Wall', 'Fortress'],
		boostsTileDefenses: '[B] Boosts tile defenses +',
		reducesWeaponsBy: ' and reduces weapon damage by ',
		fireCannons: '[C] Fire cannons at an adjacent tile. Boosted by Great Generals.\r\n',
		launchMissile: '[M] Launch a missile at any territory. Boosted by Great Generals.\r\n',
		launchNuke: "[N] Launch a nuclear weapon at any territory. Kills 80-99% of troops and destroys all structures.",
		foodBonusTitle: "Food Bonus",
		foodMilestoneTitle: "Food milestones produce reserve troops.",
		scienceBonusTitle: "Science Bonus",
		scienceMilestoneTitle: "Science is used to build structures, fire weapons, and research technology.",
		cultureBonusTitle: "Culture Bonus",
		cultureMilestoneTitle: "Culture milestones produce special rewards.",
		troopFlex: "Deploy troops to conquered territories",
		currentYear: "It's the current year!",
		energyWrap: "Energy is used to attack, move, deploy, and rush troops.",
		foodWrap: "Food milestones produce reserve troops",
		scienceWrap: "Science is used to build structures, weapons, and research technology.",
		cultureWrap: "Culture milestones produce special rewards",
		generalWrap: "Great Generals boost troop attack",
		tacticianWrap: "Great Tacticians boost troop defense",
		energyTimerBase: "Resources update at the end of each turn.",
		hideUi: "[V] Hide User Interface",
		toggleFlags: "Toggle Flags",
		hotkeys: "Hotkeys",
		gameOptions: "[ESC] Options",
		surrender: "Surrender",
		exitSpectate: "Exit Spectate",
		uninhabited: "Uninhabited",
		barbarianTribe: "Barbarian Tribe",
		Despotism: [
			'Free movement through own tiles',
			'Start with gunpowder',
			'Start with a bunker',
			'2x maximum army attack size',
		],
		Monarchy: [
			'+2 defense',
			'+1 culture from 2 food',
			'50% starting culture bonus',
			'+2 cannon damage',
		],
		Democracy: [
			'4x maximum troop deployment',
			'+3 reserve troops when you lose a tile',
			'50% starting science bonus',
			'Reduced culture milestone requirement',
		],
		Fundamentalism: [
			'Overrun: Instant win with 4x advantage',
			'Infiltration: -1 structure defense',
			'Fast growth: Reduced food milestone requirement',
			'+2 troop reward bonus',
		],
		Fascism: [
			'+1 attack',
			'+1 attack from tiles for each defensive structure',
			'+4 attack vs barbarians',
			'Bonus troop with each deployment',
		],
		Republic: [
			'+1 energy',
			'Combat medics heal 50% troops upon victory',
			'Start with masonry',
			'+50% plunder reward bonus from barbarians',
		],
		Communism: [
			'Start with a great person',
			'+1 science from 4 food',
			'Can deploy troops to uninhabited territory',
			'2x discovered reward bonus from barbarians',
		],
		removeCPU: 'Remove CPU',
		addCPU: 'Add CPU',
		lobbyRankedMatch: 'Ranked Match',
		lobbyGameNameLabel: 'Game Name',
		lobbyGamePasswordLabel: 'Password',
		lobbyGameModeLabel: 'Game Mode',
		lobbyGameMapLabel: 'Map',
		lobbyMaxPlayersLabel: 'Max Players',
		startGame: 'Start Game',
		cancelGame: 'Exit',
		setNationName: 'Nation Name',
		submitNationName: 'Update Nation Name',
		setNationFlag: 'National Flag',
		leaderboardRankedBtn: 'Ranked',
		leaderboardFfaBtn: 'Free For All',
		leaderboardTeamBtn: 'Team',
		playNowBtn: 'Play Now',
		create: 'Free For All',
		createTeamBtn: 'Team Game',
		joinPrivateGameBtn: 'Join Private Game',
		createRankedBtn: 'Create Ranked Match',
		joinRankedGame: 'Join Ranked Match',
		toggleNation: 'Configure Nation',
		leaderboardBtn: 'Leaderboard',
		gameTableName: 'Game Name',
		gameTableMap: 'Map',
		gameTableType: 'Type',
		friendStatus: 'Show Friend List',
		addFriend: 'Toggle Friend',
		ignoreStatus: 'Show Ignore List',
		ignoreUser: 'Ignore Account',
		whoAccount: 'Query Account',
		whisperAccount: 'Private Message',
		changeChannel: 'Change Channel',
		getHelp: 'Chat Commands',
		howToPlay: 'How to Play',
		brokenNet: 'Welcome to Broken.net!',
		optionsHeader: 'Options',
		musicVolume: 'Music Volume',
		soundVolume: 'Sound Effect Volume',
		bibleMode: 'Bible Mode',
		windowSize: 'Window Size',
		currentWindowSize: 'Full Screen',
		windowFullScreen: 'Full Screen',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: 'Exit Game',
		versionSpan: 'Version ',
		foodMilestoneLabel: 'Food',
		scienceMilestoneLabel: 'Science',
		cultureMilestoneLabel: 'Culture',
	},
	russian: {
		resetGame: ' ',
		updateNationBtn: '',
		playerColor: ' ',
		team: '',
		damage: '  ',
		hudAttack: ':  ',
		hudSplitAttack: '-:  ',
		hudFireCannons: ' ',
		hudLaunchMissile: ' ',
		hudLaunchNuke: '  ',
		resourceUiWidth: '28rem',
		selectTarget: ' ',
		reserveLabel: '',
		troopsLabel: '',
		youHaveJoined: '   : ',
		startingGame: "   ",
		to: ' ',
		whispers: ' : ',
		joinedChannel: "   : ",
		selectTeam: ' ',
		selectPlayerColor: '  ',
		difficulties: {
			'Very Easy': ' ',
			Easy: '',
			Normal: '',
			Hard: '',
			'Very Hard': ' ',
			Mania: '',
			Juggernaut: ''
		},
		governments: {
			Despotism: '',
			Monarchy: '',
			Democracy: '',
			Fundamentalism: '',
			Fascism: '',
			Republic: '',
			Communism: '',
			Random: ''
		},
		random: '',
		abAttack: "",
		abSplitAttack: "-",
		abDeploy: " ",
		abRush: " ",
		abBuild: "",
		abCannons: " ",
		abMissile: " ",
		abNuke: "  ",
		abResearch: "",
		abMasonry: " ",
		abConstruction: "",
		abEngineering: "",
		abGunpowder: "",
		abRocketry: " ",
		abAtomic: " ",
		abFuture: " ",
		hostLeft: "  .",
		needTwoPlayers: "   ,   ! ,       .",
		failedToLoad: "    .",
		flagChanged: "   : ",
		rankedSearch: "   ...",
		noRankedFound: "  !<br>     .",
		notScience: " !",
		needTwoUnits: "    2 ,    !",
		maxUnits: "     !",
		friendlyFire: " !     !",
		notEnoughEnergy: ' !',
		notYourTile: '    .',
		noTroopsAvailable: "   !",
		badGameName: "      4-32 .",
		notEnoughPlayers: "    2-8 .",
		newNationName: "   : ",
		verifyingSteam: "    ...",
		steamNotFound: "   Steam.  Steam   !",
		logoutSuccess: " ",
		logoutFailed: "   ",
		ribbonTitle: ['',
			'  ',
			'    Nuke',
			'   ',
			"  ",
			'  ',//5
			' ',
			'  ',
			'  ',
			' ',
			' ',//10
			' ',
			' ',
			' ',
			' ',
			'   ', //15
			' ',
			"  ",
			" ",
			" ",
			" ",//20
			' ',
			" ",
			" ",
			" ",
			'  ',//25
			'  ',
			'  ',
			" ",
			" ",
			" ",//30
			"   ",
			'   ',
			'  ',
			' ',
			' ',//35
			"  ",
		],
		ribbonDescription: ['', // 0
			'  ',
			'    ',
			'     ',
			'   ',
			"   ",//5
			' 10  ',
			' 10  ',
			' 10    ',
			' 1800+ ',
			' 2100+ ',//10
			' 2400+ ',
			' 2700+ ',
			'      100 ', //13
			'     2  1',
			' 10  ', // 15
			' 25  ',
			'   ',// 17
			"   ",
			'   ',
			'   ',//20
			'   ',
			'   ',
			'   ',
			'   ',
			' 500    ',//25
			' 500  ',
			' 500  ',
			" top # 10   ",
			" top # 100   ",
			" top # 1000   ",//30
			" ",
			' 8-   ',
			' 100    ',
			' 100  ',
			' 100  ',//35
			' ',
		],
		gameNameNotValid: "  !",
		congratulations: "!",
		gameVictory: "     !",
		victory: "",
		armistice: "  !",
		gameArmistice: " !",
		ceaseFire: " ",
		defeat: "!",
		gameDefeat: "      !",
		concede: " ",
		spectate: " ",
		defeatIn: " ",
		statOverview: "",
		statUnits: "",
		statStructures: "",
		statWeapons: "",
		statResources: "",
		tabUnits: "",
		tabStructures: "",
		tabWeapons: "",
		tabResources: "",
		tabTotalScore: " ",
		tabEarned: "",
		tabDeployed: "",
		tabKilled: "",
		tabLost: "",
		tabBunkers: "",
		tabWalls: "",
		tabFortresses: "",
		tabCannons: "",
		tabMissiles: "",
		tabNukes: " ",
		tabEnergy: "",
		tabScience: "",
		tabFood: "",
		tabCulture: "",
		gameDuration: "  ",
		endGame: " ",
		joinPrivateGameBtnConfirm: "  ",
		createGameHead: "   ",
		createRankedGameHead: " ",
		createGameNameLabel: " ",
		createGamePasswordLabel: " ()",
		createGameMaxPlayerLabel: "  :",
		createGameMapLabel: "",
		createGame: " ",
		createTeamGameHeadLabel: " ",
		noRankedGamesFound: "   !<br>    .",
		privateGameNameLabel: " ",
		privateGamePasswordLabel: "",
		confirmSurrenderPrompt: "?  ?",
		canceSurrenderButtonCancel: "",
		surrenderButtonConfirm: "",
		hotkeyUi: " V,    .",
		options: "[ESC] ",
		researchMasonry: "[Y]     \r\n(20 )",
		researchConstruction: "[O]     \r\n(30 )",
		researchEngineering: "[E]     \r\n(45 )",
		researchGunpowder: "[G]  ,   \r\n(25 )",
		researchRocketry: "[K] -    \r\n(40 )",
		researchAtomicTheory: "[T]       \r\n(60 )",
		researchFutureTech: "[F]   \r\n(90 )",
		attack: "[A]    ",
		splitAttack: "[S]     ",
		deploy: "[D]     ",
		rush: "[R]     .     ",
		defenseLabel: ['', '', ''],
		boostsTileDefenses: '[B]     +',
		reducesWeaponsBy: '      ',
		fireCannons: '[C]     .   .\r\n',
		launchMissile: '[M]     .   .\r\n',
		launchNuke: "[N]      .  80-99%     .",
		foodBonusTitle: " ",
		foodMilestoneTitle: "    .",
		scienceBonusTitle: " ",
		scienceMilestoneTitle: "    ,     .",
		cultureBonusTitle: " ",
		cultureMilestoneTitle: "    .",
		troopFlex: "    ",
		currentYear: "   !",
		energyWrap: " ,  , ,    .",
		foodWrap: "    ",
		scienceWrap: "    ,    .",
		cultureWrap: "    ",
		generalWrap: "    ",
		tacticianWrap: "    ",
		energyTimerBase: "     .",
		hideUi: "[V] Hide User Interface",
		toggleFlags: " ",
		hotkeys: "",
		gameOptions: "[ESC] ",
		surrender: "",
		exitSpectate: "   ",
		uninhabited: "",
		barbarianTribe: " ",
		Despotism: [
			'    ',
			'  ',
			'  ',
			'2x    ',
		],
		Monarchy: [
			'+2 ',
			'+1   2 ',
			'50%   ',
			'+2  ',
		],
		Democracy: [
			'4x   ',
			'+3  ,    ',
			'50%   ',
			'    ',
		],
		Fundamentalism: [
			':    4- ',
			': -1  ',
			' :      ',
			'+2   ',
		],
		Fascism: [
			'+1 ',
			'+1       ',
			'+4   ',
			'    ',
		],
		Republic: [
			'+1 ',
			'   50%   ',
			'  ',
			'+50%    ',
		],
		Communism: [
			'   ',
			'+1   4 ',
			'     ',
			'2x    ',
		],
		removeCPU: ' ',
		addCPU: ' ',
		lobbyRankedMatch: '',
		lobbyGameNameLabel: ' ',
		lobbyGamePasswordLabel: '',
		lobbyGameModeLabel: ' ',
		lobbyGameMapLabel: '',
		lobbyMaxPlayersLabel: ' ',
		startGame: ' ',
		cancelGame: '',
		setNationName: ' ',
		submitNationName: '  ',
		setNationFlag: ' ',
		leaderboardRankedBtn: '',
		leaderboardFfaBtn: '  ',
		leaderboardTeamBtn: '',
		playNowBtn: ' ',
		create: '  ',
		createTeamBtn: ' ',
		joinPrivateGameBtn: '   ',
		createRankedBtn: '  ',
		joinRankedGame: '  ',
		toggleNation: ' ',
		leaderboardBtn: '',
		gameTableName: ' ',
		gameTableMap: '',
		gameTableType: '',
		friendStatus: '  ',
		addFriend: ' ',
		ignoreStatus: '  ',
		ignoreUser: ' ',
		whoAccount: ' ',
		whisperAccount: ' ',
		changeChannel: ' ',
		getHelp: '-',
		howToPlay: ' ',
		brokenNet: '   Broken.net!',
		optionsHeader: '',
		musicVolume: ' ',
		soundVolume: '  ',
		bibleMode: ' ',
		windowSize: ' ',
		currentWindowSize: '',
		windowFullScreen: '',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: '  ',
		versionSpan: ' ',
		foodMilestoneLabel: '',
		scienceMilestoneLabel: '',
		cultureMilestoneLabel: '',
	},
	schinese: {
		resetGame: '',
		updateNationBtn: '',
		playerColor: '',
		team: '',
		damage: ' ',
		hudAttack: ': ',
        hudSplitAttack: ': ',
        hudFireCannons: '',
        hudLaunchMissile: '',
        hudLaunchNuke: '',
		resourceUiWidth: '22rem',
		selectTarget: '',
		reserveLabel: '',
		troopsLabel: '',
		youHaveJoined: ': ',
		startingGame: " ",
		to: ' ',
		whispers: ' : ',
		joinedChannel: ": ",
		selectTeam: '',
		selectPlayerColor: '',
		difficulties: {
			'Very Easy': '',
			Easy: '',
			Normal: 'l',
			Hard: '',
			'Very Hard': '',
			Mania: '',
			Juggernaut: ''
		},
		governments: {
			Despotism: '',
			Monarchy: '',
			Democracy: '',
			Fundamentalism: '',
			Fascism: '',
			Republic: '',
			Communism: '',
			Random: ''
		},
		random: '',
		abAttack: "",
		abSplitAttack: "",
		abDeploy: "",
		abRush: "",
		abBuild: "",
		abCannons: "",
		abMissile: "",
		abNuke: "",
		abResearch: "",
		abMasonry: "",
		abConstruction: "",
		abEngineering: "",
		abGunpowder: "",
		abRocketry: "",
		abAtomic: "",
		abFuture: "",
		hostLeft: "",
		needTwoPlayers: "! .",
		failedToLoad: "",
		flagChanged: ": ",
		rankedSearch: "...",
		noRankedFound: "!<br>",
		notScience: "!",
		needTwoUnits: "!",
		maxUnits: "!",
		friendlyFire: "! !",
		notEnoughEnergy: '!',
		notYourTile: '',
		noTroopsAvailable: "!",
		badGameName: " 4-32 ",
		notEnoughPlayers: " 2-8 ",
		newNationName: " ",
		verifyingSteam: " Steam ...",
		steamNotFound: "STEAMSTEAM!",
		logoutSuccess: "",
		logoutFailed: "",
		ribbonTitle: ['',
			'',
			'',
			'',
			"",
			'',//5
			'',
			'',
			'',
			'',
			'',//10
			'',
			'',
			'',
			'',
			'', //15
			'',
			"",
			"",
			"",
			"",//20
			'',
			"",
			"",
			"",
			'',//25
			'l',
			'',
			"",
			"",
			"",//30
			"",
			'l',
			'',
			'l',
			'',//35
			"",
		],
		ribbonDescription: ['', // 0
			'',
			'',
			'',
			'',
			"",//5
			'10',
			'10',
			'10FFA',
			'1800+ ',
			'2100+ ',//10
			'2400+ ',
			'2700+ ',
			'100+', //13
			' 21',
			'10', // 15
			'25',
			'',// 17
			"",
			'',
			'',//20
			'',
			'',
			'',
			'',
			'500FFA',//25
			'500',
			'500',
			"",
			"",
			"",//30
			"",
			'FFA',
			'100FFA',
			'100',
			'100',//35
			'',
		],
		gameNameNotValid: "!",
		congratulations: "!",
		gameVictory: "!",
		victory: "",
		armistice: "!",
		gameArmistice: "!",
		ceaseFire: "",
		defeat: "!",
		gameDefeat: "!",
		concede: "",
		spectate: "",
		defeatIn: " ",
		statOverview: "",
		statUnits: "",
		statStructures: "",
		statWeapons: "",
		statResources: "",
		tabUnits: "",
		tabStructures: "",
		tabWeapons: "",
		tabResources: "",
		tabTotalScore: "",
		tabEarned: "",
		tabDeployed: "",
		tabKilled: "",
		tabLost: "",
		tabBunkers: "",
		tabWalls: "",
		tabFortresses: "",
		tabCannons: "",
		tabMissiles: "",
		tabNukes: "",
		tabEnergy: "",
		tabScience: "",
		tabFood: "",
		tabCulture: "",
		gameDuration: " ",
		endGame: "",
		joinPrivateGameBtnConfirm: "",
		createGameHead: "",
		createRankedGameHead: "",
		createGameNameLabel: "",
		createGamePasswordLabel: "()",
		createGameMaxPlayerLabel: ":",
		createGameMapLabel: "",
		createGame: "",
		createTeamGameHeadLabel: "",
		noRankedGamesFound: "!<br>T",
		privateGameNameLabel: "",
		privateGamePasswordLabel: "",
		confirmSurrenderPrompt: "? ?",
		canceSurrenderButtonCancel: "",
		surrenderButtonConfirm: "",
		hotkeyUi: "VUI",
		options: "[ESC] ",
		researchMasonry: "[Y] \r\n(20 )",
		researchConstruction: "[O] \r\n(30 )",
		researchEngineering: "[E]\r\n(45 )",
		researchGunpowder: "[G]\r\n(25 )",
		researchRocketry: "[K] \r\n(40 )",
		researchAtomicTheory: "[T] \r\n(60 )",
		researchFutureTech: "[F] \r\n(90 )",
		attack: "[A] ",
		splitAttack: "[S] ",
		deploy: "[D]",
		rush: "[R]  ",
		// upgradeTileDefense: "[B] 1",
		defenseLabel: ['', '', ''],
		boostsTileDefenses: '[B]',
		reducesWeaponsBy: '  ',
		fireCannons: '[C]   \r\n',
		launchMissile: '[M]  \r\n',
		launchNuke: "[N]  80-99%  ",
		foodBonusTitle: "",
		foodMilestoneTitle: ".",
		scienceBonusTitle: "",
		scienceMilestoneTitle: "",
		cultureBonusTitle: "",
		cultureMilestoneTitle: "",
		troopFlex: "",
		currentYear: "!",
		energyWrap: "",
		foodWrap: "",
		scienceWrap: "",
		cultureWrap: "",
		generalWrap: "",
		tacticianWrap: "",
		energyTimerBase: "",
		hideUi: "[V]",
		toggleFlags: "",
		hotkeys: "",
		gameOptions: "[ESC] ",
		surrender: "",
		exitSpectate: "",
		uninhabited: "",
		barbarianTribe: "",
		Despotism: [
			'',
			'',
			'',
			'',
		],
		Monarchy: [
			'+2',
			'2',
			'50% ',
			'+2 ',
		],
		Democracy: [
			'4',
			'',
			'50% ',
			'',
		],
		Fundamentalism: [
			': I 4',
			': -1',
			': ',
			'+2 ',
		],
		Fascism: [
			'+1 ',
			'1',
			'+4',
			'',
		],
		Republic: [
			'+1 ',
			'',
			'',
			'+50%  ',
		],
		Communism: [
			'',
			'41',
			'',
			'2x ',
		],
		removeCPU: ' CPU',
		addCPU: ' CPU',
		lobbyRankedMatch: '',
		lobbyGameNameLabel: '',
		lobbyGamePasswordLabel: '',
		lobbyGameModeLabel: '',
		lobbyGameMapLabel: '',
		lobbyMaxPlayersLabel: '',
		startGame: '',
		cancelGame: '',
		setNationName: '',
		submitNationName: '',
		setNationFlag: '',
		leaderboardRankedBtn: '',
		leaderboardFFABtn: '',
		leaderboardTeamBtn: '',
		playNowBtn: '',
		create: '',
		createTeamBtn: '',
		joinPrivateGameBtn: '',
		createRankedBtn: '',
		joinRankedGame: '',
		toggleNation: '',
		leaderboardBtn: '',
		gameTableName: '',
		gameTableMap: '',
		gameTableType: '',
		friendStatus: '',
		addFriend: '',
		ignoreStatus: '',
		ignoreUser: '',
		whoAccount: '',
		whisperAccount: '',
		changeChannel: '',
		getHelp: '',
		howToPlay: '',
		brokenNet: ' Broken.net!',
		optionsHeader: '',
		musicVolume: '',
		soundVolume: '',
		bibleMode: '',
		windowSize: '',
		currentWindowSize: '',
		windowFullScreen: ' ',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: '',
		versionSpan: ' ',
		foodMilestoneLabel: '',
		scienceMilestoneLabel: '',
		cultureMilestoneLabel: '',
	},
	german: {
		resetGame: 'Spiel Zurcksetzen',
		updateNationBtn: 'Erledigt',
		playerColor: 'Spielerfarbe',
		team: 'Mannschaft',
		damage: ' Beschdigung',
		hudAttack: 'Attacke: Ziel auswhlen',
		hudSplitAttack: 'Split-Angriff: Ziel auswhlen',
		hudFireCannons: 'Feuerkanonen',
		hudLaunchMissile: 'Raketen starten',
		hudLaunchNuke: 'Startet die Atombombe',
		resourceUiWidth: '26rem',
		selectTarget: 'Ziel auswhlen',
		reserveLabel: 'Reservieren',
		troopsLabel: 'Truppen',
		youHaveJoined: 'Du bist dem Spiel beigetreten: ',
		startingGame: "Spielstart in ",
		to: 'Zu ',
		whispers: ' flstert: ',
		joinedChannel: "Du bist dem Kanal beigetreten: ",
		selectTeam: 'Team auswhlen',
		selectPlayerColor: 'Whlen Sie Spielerfarbe',
		difficulties: {
			'Very Easy': 'Sehr leicht',
			Easy: 'Einfach',
			Normal: 'Normal',
			Hard: 'Hart',
			'Very Hard': 'Sehr schwer',
			Mania: 'Manie',
			Juggernaut: 'Juggernaut'
		},
		governments: {
			Despotism: 'Despotismus',
			Monarchy: 'Monarchie',
			Democracy: 'Demokratie',
			Fundamentalism: 'Fundamentalismus',
			Fascism: 'Faschismus',
			Republic: 'Republik',
			Communism: 'Kommunismus',
			Random: 'Zufllig'
		},
		random: 'Zufllig',
		abAttack: "Attacke",
		abSplitAttack: "Split-Angriff",
		abDeploy: "Bereitstellen von Truppen",
		abRush: "Rush-Truppen",
		abBuild: "Bauen",
		abCannons: "Feuerkanonen",
		abMissile: "Raketen starten",
		abNuke: "Startet die Atombombe",
		abResearch: "Forschung",
		abMasonry: "Mauerwerk",
		abConstruction: "Konstruktion",
		abEngineering: "Ingenieurwesen",
		abGunpowder: "Schiepulver",
		abRocketry: "Raketentechnik",
		abAtomic: "Atomtheorie",
		abFuture: "Zukunft Tech",
		hostLeft: "Der Gastgeber hat die Lobby verlassen.",
		needTwoPlayers: "Du brauchst zwei Spieler, um ein Spiel zu beginnen! Warten Sie, bis die Spieler dem Computer beitreten oder einen Computer hinzufgen.",
		failedToLoad: "Laden der Spieldaten fehlgeschlagen.",
		flagChanged: "Die Fahne deiner Nation ist jetzt: ",
		rankedSearch: "Suche nach Ranglisten-Spielen...",
		noRankedFound: "Keine Ranglistenspiele gefunden!<br>Versuchen Sie stattdessen, ein Ranglisten-Spiel zu erstellen.",
		notScience: "Nicht genug Wissenschaft!",
		needTwoUnits: "Du brauchst mindestens 2 Truppen, um dich zu bewegen oder anzugreifen!",
		maxUnits: "Dieses Gebiet hat die maximale Anzahl von Einheiten!",
		friendlyFire: "Teambeschuss! Das ist dein Teamkollege!",
		notEnoughEnergy: 'Nicht genug Energie!',
		notYourTile: 'Du besitzt diese Kachel nicht.',
		noTroopsAvailable: "Keine Truppen fr den Einsatz verfgbar!",
		badGameName: "Der Spielname muss mindestens 4-32 Zeichen lang sein.",
		notEnoughPlayers: "Das Spiel muss 2-8 Spieler haben.",
		newNationName: "Ihr neuer Nationenname ist: ",
		verifyingSteam: "Steam-Anmeldedaten berprfen...",
		steamNotFound: "Steam kann nicht gefunden werden. Bitte starte Steam und versuche es erneut!",
		logoutSuccess: "Abmeldung erfolgreich",
		logoutFailed: "Abmeldung fehlgeschlagen",
		ribbonTitle: ['',
			'Nationale Kampfmedaille',
			'Tactical Nuke Anerkennungspreis',
			'Preis fr gutes Benehmen',
			"Service-Band des Patrioten",
			'Brgerservice-Band',//5
			'Bronze Verdienstmedaille',
			'Bronze-Service-Medaille',
			'Bronze-Expeditionsmedaille',
			'Bronze Kreuz',
			'Silberkreuz',//10
			'Goldenes Kreuz',
			'Platin-Kreuz',
			'Preis fr revolutionre Zwecke',
			'Strategischer Kriegsfhrungspreis',
			'Kampfdienst-Auszeichnung', //15
			'Galanterie Auszeichnung',
			"Gewaltige Eroberer-Medaille",
			"Schwert des Diktators",
			"Knigs Regalia",
			"Archons Skalen",//20
			'Gttlicher Bund',
			"Kaisers Fasces",
			"Adler Zweig",
			"Genosse Sichel",
			'Goldene Expeditionsmedaille',//25
			'Goldene verdienstvolle Medaille',
			'Goldene Service-Medaille',
			"Meistermedaille",
			"Eroberer-Medaille",
			"Kommandeursmedaille",//30
			"Unerschrockener Heldentumspreis",
			'Expeditionsmedaille des Weltkrieges',
			'Silberne Expeditionsmedaille',
			'Silberne verdienstvolle Medaille',
			'Silberne Service-Medaille',//35
			"Techniker-Serviceband",
		],
		ribbonDescription: ['', // 0
			'Begrndete deine Nation',
			'Zerstre eine Festung mit einer Atomwaffe',
			'Habe zwei Kameraden zu deiner Freundesliste hinzugefgt',
			'Ihre Nationalflagge aktualisiert',
			"Aktualisierte den Namen deiner Nation",//5
			'Gewann 10 Ranglistenspiele',
			'Gewann 10 Mannschaftsspiele',
			'Gewann 10 gratis fr alle Spiele',
			'Erreicht 1800+ Bewertung',
			'Erreicht 2100+ Bewertung',//10
			'Erreicht 2400 + Rating',
			'Erreichte 2700+ Bewertung',
			'Groe Revolutionre eroberten eine Kachel mit 100+ Einheiten', //13
			'Gewinne ein Spiel mit einem 2-zu-1-Ttungsverhltnis',
			'Gewann 10 Spiele in Folge', // 15
			'Gewann 25 Spiele in Folge',
			'Eroberte eine Fliese mit einer Festung',// 17
			"Gewann ein Spiel unter Despotismus",
			'Gewann ein Spiel als Monarchie',
			'Gewann ein Spiel als Demokratie',//20
			'Gewann ein Spiel unter Fundamentalismus',
			'Gewann ein Spiel unter Faschismus',
			'Gewann ein Spiel als eine Republik',
			'Gewann ein Spiel unter dem Kommunismus',
			'Gewann 500 gratis fr alle Spiele',//25
			'Gewann 500 Ranglistenspiele',
			'Gewann 500 Mannschaftsspiele',
			"Treffe die Top 10 auf der Rangliste",
			"Treffe die Top 100 auf der Rangliste",
			"Treffe die Top # 1000 auf der Rangliste",//30
			"Besiege den Juggernaut",
			'Gewinne ein 8-Spieler-FFA-Spiel',
			'Gewann 100 gratis fr alle Spiele',
			'Gewann 100 Ranglistenspiele',
			'Gewann 100 Mannschaftsspiele',//35
			'Baue eine Festung',
		],
		gameNameNotValid: "Der Spielername ist nicht gltig!",
		congratulations: "Herzliche Glckwnsche!",
		gameVictory: "Ihre Kampagne fr die globale Vorherrschaft ist gelungen!",
		victory: "Sieg",
		armistice: "Waffenstillstand!",
		gameArmistice: "Die Kampagne wurde ausgesetzt!",
		ceaseFire: "Feuer einstellen",
		defeat: "Niederlage!",
		gameDefeat: "Ihre Kampagne fr die Weltherrschaft ist gescheitert!",
		concede: "Concede Niederlage",
		spectate: "Zuschauen",
		defeatIn: "Niederlage in ",
		statOverview: "berblick",
		statUnits: "Einheiten",
		statStructures: "Strukturen",
		statWeapons: "Waffen",
		statResources: "Ressourcen",
		tabUnits: "Einheiten",
		tabStructures: "Strukturen",
		tabWeapons: "Waffen",
		tabResources: "Ressourcen",
		tabTotalScore: "Gesamtpunktzahl",
		tabEarned: "Verdient",
		tabDeployed: "Bereitgestellt",
		tabKilled: "Gettet",
		tabLost: "Hat verloren",
		tabBunkers: "Bunkers",
		tabWalls: "Wnde",
		tabFortresses: "Festungen",
		tabCannons: "Kanonen",
		tabMissiles: "Raketen",
		tabNukes: "Kernwaffen",
		tabEnergy: "Energie",
		tabScience: "Wissenschaft",
		tabFood: "Essen",
		tabCulture: "Kultur",
		gameDuration: "Spieldauer ",
		endGame: "Spiel beenden",
		joinPrivateGameBtnConfirm: "Spiel beitreten",
		createGameHead: "Kostenlos fr alle Spiele",
		createRankedGameHead: "Ranglistenspiel",
		createGameNameLabel: "Spielname",
		createGamePasswordLabel: "Passwort (optional)",
		createGameMaxPlayerLabel: "Maximale Spielerzahl:",
		createGameMapLabel: "Karte",
		createGame: "Spiel erstellen",
		createTeamGameHeadLabel: "Teamspiel",
		noRankedGamesFound: "Keine Ranglistenspiele gefunden!<br>Versuchen Sie stattdessen, ein Ranglisten-Spiel zu erstellen.",
		privateGameNameLabel: "Spielname",
		privateGamePasswordLabel: "Passwort",
		confirmSurrenderPrompt: "Kapitulation? Bist du sicher?",
		canceSurrenderButtonCancel: "Stornieren",
		surrenderButtonConfirm: "Kapitulation",
		hotkeyUi: "[V] Wechseln Sie die Benutzeroberflche",
		options: "[ESC] Optionen",
		researchMasonry: "[Y] Erforsche Mauerwerk, um Bunker freizuschalten\r\n(20 Sekunden)",
		researchConstruction: "[O] Erforschen Sie die Konstruktion, um Wnde zu ffnen\r\n(30 Sekunden)",
		researchEngineering: "[E] Forschungstechnik zum Freischalten von Festungen\r\n(45 Sekunden)",
		researchGunpowder: "[G] Erforsche Schiepulver, um Kanonen freizuschalten\r\n(25 Sekunden)",
		researchRocketry: "[K] Research Raketentechnik Raketen zu entsperren\r\n(40 Sekunden)",
		researchAtomicTheory: "[T] Forschung Atomtheorie, um Atomwaffen freizuschalten\r\n(60 Sekunden)",
		researchFutureTech: "[F] Forschung Zukunftstechnologie\r\n(90 Sekunden)",
		attack: "[A] Angriff mit allen Truppen",
		splitAttack: "[S] Greife mit der Hlfte deiner Truppen an",
		deploy: "[D] Setze Reservetruppen auf eine Kachel um",
		rush: "[R] Rush Truppen aus Ihrer Brgerschaft. Angetrieben durch Kulturbonus ",
		defenseLabel: ['Bunker', 'Mauer', 'Festung'],
		boostsTileDefenses: '[B] Verstrkt die Verteidigung der Fliese +',
		reducesWeaponsBy: ' und reduziert Waffenschaden um ',
		fireCannons: '[C] Feuerkanonen auf einer angrenzenden Fliese. Von groen Generlen beflgelt.\r\n',
		launchMissile: '[M] Starte eine Rakete auf ein beliebiges Territorium. Von groen Generlen beflgelt.\r\n',
		launchNuke: "[N] Startet eine Atomwaffe in jedem Gebiet. Ttet 80-99% der Truppen und zerstrt alle Strukturen.",
		foodBonusTitle: "Essensbonus",
		foodMilestoneTitle: "Nahrungsmittelmeilensteine produzieren Reservetruppen.",
		scienceBonusTitle: "Wissenschaftsbonus",
		scienceMilestoneTitle: "Wissenschaft wird verwendet, um Strukturen zu bauen, Feuerwaffen und Forschungstechnologie.",
		cultureBonusTitle: "Kulturbonus",
		cultureMilestoneTitle: "Kulturmeilensteine erzeugen besondere Belohnungen.",
		troopFlex: "Setze Truppen in eroberte Gebiete ein",
		currentYear: "Es ist das laufende Jahr!",
		energyWrap: "Energie wird verwendet, um Truppen anzugreifen, zu bewegen, einzusetzen und zu strzen.",
		foodWrap: "Nahrungsmittelmeilensteine produzieren Reservetruppen",
		scienceWrap: "Wissenschaft wird verwendet, um Strukturen, Waffen und Forschungstechnologie zu bauen.",
		cultureWrap: "Kulturmeilensteine erzeugen besondere Belohnungen",
		generalWrap: "Groe Generle verstrken Truppenangriffe",
		tacticianWrap: "Groe Taktiker verstrken die Truppenabwehr",
		energyTimerBase: "Ressourcen werden am Ende jeder Runde aktualisiert.",
		hideUi: "[V] Benutzerschnittstelle ausblenden",
		toggleFlags: "Flaggen umschalten",
		hotkeys: "Hotkeys",
		gameOptions: "[ESC] Optionen",
		surrender: "Kapitulation",
		exitSpectate: "Spectate verlassen",
		uninhabited: "Unbewohnt",
		barbarianTribe: "Barbarischer Stamm",
		Despotism: [
			'Freizgigkeit durch eigene Fliesen',
			'Beginne mit Schiepulver',
			'Fang mit einem Bunker an',
			'2x maximale Angriffsstrke der Armee',
		],
		Monarchy: [
			'+2 Verteidigung',
			'+1 Kultur aus 2 Lebensmitteln',
			'50% Start Kulturbonus',
			'+2 Kanonenschaden',
		],
		Democracy: [
			'4x maximale Truppentrage',
			'+3 Reserviere Truppen, wenn du ein Plttchen verlierst',
			'50% Start Wissenschaft Bonus',
			'Reduzierte Meilensteinanforderung fr die Kultur',
		],
		Fundamentalism: [
			'Overrun: Sofortiger Gewinn mit 4x Vorteil',
			'Infiltration: -1 Strukturverteidigung',
			'Schnelles Wachstum: Reduzierte Essen Meilenstein-Anforderung',
			'+2 Truppenbelohnungsbonus',
		],
		Fascism: [
			'+1 Attacke',
			'+1 Angriff von Kacheln fr jede Verteidigungsstruktur',
			'+4 Angriff gegen Barbaren',
			'Bonustruppe bei jeder Bereitstellung',
		],
		Republic: [
			'+1 Energie',
			'Kampfmediziner heilen 50% der Truppen nach dem Sieg',
			'Beginnen Sie mit Mauerwerk',
			'+50% plndern Belohnungsbonus von Barbaren',
		],
		Communism: [
			'Beginne mit einer groartigen Person',
			'+1 Wissenschaft von 4 Essen',
			'Kann Truppen auf unbewohntes Gebiet bringen',
			'2x entdeckte Belohnungsbonus von Barbaren',
		],
		removeCPU: 'Entfernen Sie den Computer',
		addCPU: 'Computer hinzufgen',
		lobbyRankedMatch: 'Ranglisten-Spiel',
		lobbyGameNameLabel: 'Spielname',
		lobbyGamePasswordLabel: 'Passwort',
		lobbyGameModeLabel: 'Spielmodus',
		lobbyGameMapLabel: 'Karte',
		lobbyMaxPlayersLabel: 'Maximale Spieleranzahl',
		startGame: 'Spiel beginnen',
		cancelGame: 'Ausgang',
		setNationName: 'Nationenname',
		submitNationName: 'Nationenname aktualisieren',
		setNationFlag: 'Nationalflagge',
		leaderboardRankedBtn: 'Rangliste',
		leaderboardFfaBtn: 'Frei fr alle',
		leaderboardTeamBtn: 'Mannschaft',
		playNowBtn: 'Jetzt spielen',
		create: 'Frei fr alle',
		createTeamBtn: 'Teamspiel',
		joinPrivateGameBtn: 'Privates Spiel beitreten',
		createRankedBtn: 'Erstelle Ranglisten-Spiel',
		joinRankedGame: 'Melde dich im Ranglisten-Spiel an',
		toggleNation: 'Konfigurieren Sie Nation',
		leaderboardBtn: 'Bestenliste',
		gameTableName: 'Spielname',
		gameTableMap: 'Karte',
		gameTableType: 'Art',
		friendStatus: 'Freundesliste anzeigen',
		addFriend: 'Toggle Freund',
		ignoreStatus: 'Zeige Ignorierliste',
		ignoreUser: 'Konto ignorieren',
		whoAccount: 'Konto abfragen',
		whisperAccount: 'Private Nachricht',
		changeChannel: 'Kanal wechseln',
		getHelp: 'Chatbefehle',
		howToPlay: 'Spielanleitung',
		brokenNet: 'Willkommen zu Broken.net!',
		optionsHeader: 'Optionen',
		musicVolume: 'Musiklautstrke',
		soundVolume: 'Soundeffekt-Lautstrke',
		bibleMode: 'Bibelmodus',
		windowSize: 'Fenstergre',
		currentWindowSize: 'Vollbild',
		windowFullScreen: 'Vollbild',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: 'Spiel verlassen',
		versionSpan: 'Ausfhrung ',
		foodMilestoneLabel: 'Essen',
		scienceMilestoneLabel: 'Wissenschaft',
		cultureMilestoneLabel: 'Kultur',
	},
	portuguese: {
		resetGame: 'Redefinir Jogo',
		updateNationBtn: 'Feito',
		playerColor: 'Cor do Jogador',
		team: 'Equipe',
		damage: ' danificar',
		hudAttack: 'Ataque: selecione o alvo',
		hudSplitAttack: 'Ataque Dividido: Selecionar Alvo',
		hudFireCannons: 'Canhes de fogo',
		hudLaunchMissile: 'Mssil de lanamento',
		hudLaunchNuke: 'Lanar Bomba Nuclear',
		resourceUiWidth: '24rem',
		selectTarget: 'Selecione o alvo',
		reserveLabel: 'reserva',
		troopsLabel: 'Tropas',
		youHaveJoined: 'Voc entrou no jogo: ',
		startingGame: "Comeando o jogo em ",
		to: 'Para ',
		whispers: ' sussurros: ',
		joinedChannel: "Voc entrou no canal: ",
		selectTeam: 'Selecionar time',
		selectPlayerColor: 'Selecione a cor do player',
		difficulties: {
			'Very Easy': 'Muito fcil',
			Easy: 'Fcil',
			Normal: 'Normal',
			Hard: 'Difcil',
			'Very Hard': 'Muito difcil',
			Mania: 'Mania',
			Juggernaut: 'Juggernaut'
		},
		governments: {
			Despotism: 'Despotismo',
			Monarchy: 'Monarquia',
			Democracy: 'Democracia',
			Fundamentalism: 'Fundamentalismo',
			Fascism: 'Fascismo',
			Republic: 'Repblica',
			Communism: 'O comunismo',
			Random: 'Aleatria'
		},
		random: 'Aleatria',
		abAttack: "Ataque",
		abSplitAttack: "Ataque Dividido",
		abDeploy: "Implantar tropas",
		abRush: "Tropas de pressa",
		abBuild: "Construir",
		abCannons: "Canhes de fogo",
		abMissile: "Mssil de lanamento",
		abNuke: "Lanar Bomba Nuclear",
		abResearch: "Pesquisa",
		abMasonry: "Alvenaria",
		abConstruction: "Construo",
		abEngineering: "Engenharia",
		abGunpowder: "Plvora",
		abRocketry: "Foguetes",
		abAtomic: "Teoria atmica",
		abFuture: "Tech futuro",
		hostLeft: "O anfitrio deixou o saguo.",
		needTwoPlayers: "Voc precisa de dois jogadores para comear um jogo! Aguarde que os jogadores participem ou adicionem um player de computador para comear.",
		failedToLoad: "Falha ao carregar dados do jogo.",
		flagChanged: "A bandeira do seu pas  agora: ",
		rankedSearch: "Procurando por jogos classificados...",
		noRankedFound: "Nenhum jogo classificado encontrado!<br>Tente criar um jogo classificado.",
		notScience: "Cincia insuficiente!",
		needTwoUnits: "Voc precisa de pelo menos 2 tropas para se mover ou atacar!",
		maxUnits: "Esse territrio tem o nmero mximo de unidades!",
		friendlyFire: "Fogo amigo! Esse  seu companheiro de equipe!",
		notEnoughEnergy: 'Energia no suficiente!',
		notYourTile: 'Voc no possui esse bloco.',
		noTroopsAvailable: "Nenhuma tropa disponvel para implantao!",
		badGameName: "O nome do jogo deve ter pelo menos 4 a 32 caracteres.",
		notEnoughPlayers: "O jogo deve ter 2-8 jogadores.",
		newNationName: "Seu novo nome da nao : ",
		verifyingSteam: "Verificando as credenciais do Steam...",
		steamNotFound: "No  possvel detectar o Steam. Por favor, inicie o Steam e tente novamente!",
		logoutSuccess: "Logout com sucesso",
		logoutFailed: "Logout falhou",
		ribbonTitle: ['',
			'Medalha Nacional de Combate',
			'Prmio de Reconhecimento Nuke Ttico',
			'Prmio de boa conduta',
			"Faixa de servio do patriota",
			'Faixa de servio cvico',//5
			'Medalha Meritria de Bronze',
			'Medalha de Servio Bronze',
			'Medalha Expedicionria de Bronze',
			'Cruz de bronze',
			'Cruz de prata',//10
			'Cruz dourada',
			'Cruz de Platina',
			'Prmio de Causa Revolucionria',
			'Prmio de Guerra Estratgica',
			'Prmio de servio de combate', //15
			'Prmio Galanteador de Combate',
			"Medalha do Conquistador Stalwart",
			"Espada do Ditador",
			"Regalia do rei",
			"Escalas de Arconte",//20
			'Convnio Divino',
			"Fasces do Imperador",
			"Filial da guia",
			"Foice de Camarada",
			'Medalha Expedicionria Dourada',//25
			'Medalha Meritria Dourada',
			'Medalha de Servio de Ouro',
			"Medalha do Campeo",
			"Medalha do Conquistador",
			"Medalha do Comandante",//30
			"Prmio de herosmo intrpido",
			'Medalha Expedicionria Global de Guerra ',
			'Medalha Expedicionria de Prata',
			'Medalha Meritria de Prata',
			'Medalha de Servio de Prata',//35
			"Faixa de servio do engenheiro",
		],
		ribbonDescription: ['', // 0
			'Estabeleceu sua nao',
			'Destruiu uma fortaleza com uma arma nuclear',
			'Adicionado dois camaradas  sua lista de amigos',
			'Atualizou sua bandeira nacional',
			"Atualizou o nome da sua nao",//5
			'Ganhou 10 jogos classificados',
			'Ganhou 10 jogos de equipe',
			'Ganhou 10 grtis para todos os jogos',
			'Alcanou a classificao de 1800+',
			'Alcanou 2100+ classificao',//10
			'Achieved 2400+ rating',
			'Achieved 2700+ rating',
			'Grande Revolucionrio conquistou uma telha com mais de 100 unidades', //13
			'Ganhe um jogo com uma razo de 2 para 1 de mortes',
			'Ganhou 10 jogos seguidos', // 15
			'Ganhou 25 jogos seguidos',
			'Conquistou uma telha com uma fortaleza',// 17
			"Ganhou um jogo sob Despotismo",
			'Ganhou um jogo como Monarquia',
			'Ganhou um jogo como uma democracia',//20
			'Ganhou um jogo sob o fundamentalismo',
			'Ganhou um jogo sob o fascismo',
			'Ganhou um jogo como uma repblica',
			'Ganhou um jogo sob o comunismo',
			'Ganhou 500 grtis para todos os jogos',//25
			'Ganhou 500 jogos classificados',
			'Ganhou 500 jogos de equipe',
			"Atingir o top 10 na classificao geral",
			"Atingir o top # 100 na classificao geral",
			"Atingiu o topo # 1000 no ranking de classificao",//30
			"Derrotou o Juggernaut",
			'Ganhe um 8 jogadores grtis para todos os jogos',
			'Ganhou 100 livres para todos os jogos',
			'Ganhou 100 jogos classificados',
			'Ganhou 100 jogos de equipe',//35
			'Construa uma fortaleza',
		],
		gameNameNotValid: "O nome do jogo no  vlido!",
		congratulations: "Parabns!",
		gameVictory: "Sua campanha pela dominao global foi bem sucedida!",
		victory: "Vitria",
		armistice: "Armistcio!",
		gameArmistice: "A campanha foi suspensa!",
		ceaseFire: "Cessar fogo",
		defeat: "Derrota!",
		gameDefeat: "Sua campanha pela dominao do mundo falhou!",
		concede: "Reconhecer a derrota",
		spectate: "Olhar",
		defeatIn: "Derrota em ",
		statOverview: "Viso geral",
		statUnits: "Unidades",
		statStructures: "Estruturas",
		statWeapons: "Armas",
		statResources: "Recursos",
		tabUnits: "Unidades",
		tabStructures: "Estruturas",
		tabWeapons: "Armas",
		tabResources: "Recursos",
		tabTotalScore: "Pontuao total",
		tabEarned: "Ganhou",
		tabDeployed: "Implantado",
		tabKilled: "Morto",
		tabLost: "Perdido",
		tabBunkers: "Bunkers",
		tabWalls: "Paredes",
		tabFortresses: "Fortalezas",
		tabCannons: "Canhes",
		tabMissiles: "Msseis",
		tabNukes: "Armas nucleares",
		tabEnergy: "Energia",
		tabScience: "Cincia",
		tabFood: "Comida",
		tabCulture: "Cultura",
		gameDuration: "Durao do Jogo ",
		endGame: "Jogo final",
		joinPrivateGameBtnConfirm: "Entrar no jogo",
		createGameHead: "Grtis para todos os jogos",
		createRankedGameHead: "Jogo classificado",
		createGameNameLabel: "Nome do jogo",
		createGamePasswordLabel: "Senha (opcional)",
		createGameMaxPlayerLabel: "Mximo de Jogadores:",
		createGameMapLabel: "Mapa",
		createGame: "Criar jogo",
		createTeamGameHeadLabel: "Jogo de equipe",
		noRankedGamesFound: "Nenhum jogo classificado encontrado!<br>Tente criar um jogo classificado.",
		privateGameNameLabel: "Nome do jogo",
		privateGamePasswordLabel: "Senha",
		confirmSurrenderPrompt: "Entrega?",
		canceSurrenderButtonCancel: "Cancelar",
		surrenderButtonConfirm: "Entrega",
		hotkeyUi: "[V] Alternar a interface do usurio",
		options: "[ESC] Opes",
		researchMasonry: "[Y] Pesquisa de alvenaria para destravar bunkers\r\n(20 segundos)",
		researchConstruction: "[O] Construo de pesquisa para desbloquear paredes\r\n(30 segundos)",
		researchEngineering: "[E] Engenharia de pesquisa para desbloquear fortalezas\r\n(45 segundos)",
		researchGunpowder: "[G] Pesquisa de plvora para desbloquear canhes\r\n(25 segundos)",
		researchRocketry: "[K] Pesquisa de foguetes para desbloquear msseis\r\n(40 segundos)",
		researchAtomicTheory: "[T] Pesquise teoria atmica para desbloquear armas nucleares\r\n(60 segundos)",
		researchFutureTech: "[F] Tecnologia de pesquisa futura\r\n(90 segundos)",
		attack: "[A] Ataque com todas as tropas",
		splitAttack: "[S] Ataque com metade de suas tropas",
		deploy: "[D] Implantar tropas de reserva em um ladrilho",
		rush: "[R] Apresse as tropas de seus cidados. Impulsionado pelo bnus cultural ",
		defenseLabel: ['Bunker', 'parede', 'Fortaleza'],
		boostsTileDefenses: '[B] Aumenta as defesas do azulejo +',
		reducesWeaponsBy: ' e reduz dano de arma por ',
		fireCannons: '[C] Canhes de fogo em uma telha adjacente. Impulsionado por grandes generais.\r\n',
		launchMissile: '[M] Lanar um mssil em qualquer territrio. Impulsionado por grandes generais.\r\n',
		launchNuke: "[N] Lance uma arma nuclear em qualquer territrio. Mata 80-99% das tropas e destri todas as estruturas.",
		foodBonusTitle: "Bnus Alimentar",
		foodMilestoneTitle: "Marcos milirios de alimentos produzem tropas de reserva.",
		scienceBonusTitle: "Bnus da Cincia",
		scienceMilestoneTitle: "A cincia  usada para construir estruturas, armas de fogo e tecnologia de pesquisa.",
		cultureBonusTitle: "Bnus de Cultura",
		cultureMilestoneTitle: "Marcos de cultura produzem recompensas especiais.",
		troopFlex: "Implantar tropas em territrios conquistados",
		currentYear: " o ano corrente!",
		energyWrap: "A energia  usada para atacar, mover, implantar e apressar as tropas.",
		foodWrap: "Marcos milirios de alimentos produzem tropas de reserva",
		scienceWrap: "A cincia  usada para construir estruturas, armas e tecnologia de pesquisa.",
		cultureWrap: "Marcos de cultura produzem recompensas especiais",
		generalWrap: "Grandes generais aumentam ataque de tropas",
		tacticianWrap: "Grandes tticos reforam defesa de tropas",
		energyTimerBase: "Atualizao de recursos no final de cada turno.",
		hideUi: "[V] Ocultar interface do usurio",
		toggleFlags: "Alternar sinalizadores",
		hotkeys: "Teclas de atalho",
		gameOptions: "[ESC] Opes",
		surrender: "Entrega",
		exitSpectate: "Sair de Espectador",
		uninhabited: "Desabitada",
		barbarianTribe: "Tribo Brbara",
		Despotism: [
			'Livre circulao atravs de telhas prprias',
			'Comece com a plvora',
			'Comece com um bunker',
			'2x tamanho mximo de ataque do exrcito',
		],
		Monarchy: [
			'+2 defesa',
			'+1 cultura de 2 alimentos',
			'50% comeando bnus cultural',
			'+2 dano de canho',
		],
		Democracy: [
			'4x implantao mxima de tropas',
			'+3 tropas de reserva quando voc perde um azulejo',
			'50% comeando bnus de cincia',
			'Requisito de marco de cultura reduzido',
		],
		Fundamentalism: [
			'Superao: vitria instantnea com vantagem de 4x',
			'Infiltrao: -1 estrutura de defesa',
			'Crescimento rpido: exigncia de marcos alimentares reduzidos',
			'+2 bnus de recompensa de tropas',
		],
		Fascism: [
			'+1 ataque',
			'+1 ataque de telhas para cada estrutura defensiva',
			'+4 ataque vs brbaros',
			'Tropa de bnus com cada implantao',
		],
		Republic: [
			'+1 energia',
			'Mdicos de combate curam 50% das tropas aps a vitria',
			'Comece com alvenaria',
			'+50% saqueie bnus de recompensa dos brbaros',
		],
		Communism: [
			'Comece com uma tima pessoa',
			'+1 cincia de 4 alimentos',
			'Pode implantar tropas em territrio desabitado',
			'2x bnus de recompensa descoberto de brbaros',
		],
		removeCPU: 'Remover computador',
		addCPU: 'Adicionar computador',
		lobbyRankedMatch: 'Partida ranqueada',
		lobbyGameNameLabel: 'Nome do jogo',
		lobbyGamePasswordLabel: 'Senha',
		lobbyGameModeLabel: 'Modo de jogo',
		lobbyGameMapLabel: 'Mapa',
		lobbyMaxPlayersLabel: 'Mximo de jogadores',
		startGame: 'Comear o jogo',
		cancelGame: 'Sada',
		setNationName: 'Nome da nao',
		submitNationName: 'Atualizar nome da nao',
		setNationFlag: 'Bandeira nacional',
		leaderboardRankedBtn: 'Classificados',
		leaderboardFfaBtn: 'Grtis para todos',
		leaderboardTeamBtn: 'Equipe',
		playNowBtn: 'Jogue agora',
		create: 'Grtis para todos',
		createTeamBtn: 'Jogo de equipe',
		joinPrivateGameBtn: 'Participe do Jogo Privado',
		createRankedBtn: 'Criar um jogo classificado',
		joinRankedGame: 'Junte-se ao jogo classificado',
		toggleNation: 'Configurar nao',
		leaderboardBtn: 'Entre os melhores',
		gameTableName: 'Nome do jogo',
		gameTableMap: 'Mapa',
		gameTableType: 'Tipo',
		friendStatus: 'Mostrar lista de amigos',
		addFriend: 'Alternar Amigo',
		ignoreStatus: 'Mostrar lista de ignorados',
		ignoreUser: 'Ignorar conta',
		whoAccount: 'Conta de Consulta',
		whisperAccount: 'Mensagem privada',
		changeChannel: 'Mude o canal',
		getHelp: 'Comandos de Chat',
		howToPlay: 'Como jogar',
		brokenNet: 'Bem-vindo ao Broken.net!',
		optionsHeader: 'Opes',
		musicVolume: 'Volume da msica',
		soundVolume: 'Volume do efeito sonoro',
		bibleMode: 'Modo Bblico',
		windowSize: 'Tamanho da janela',
		currentWindowSize: 'Tela cheia',
		windowFullScreen: 'Tela cheia',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: 'Sair do jogo',
		versionSpan: 'Verso ',
		foodMilestoneLabel: 'Comida',
		scienceMilestoneLabel: 'Cincia',
		cultureMilestoneLabel: 'Cultura',
	},
	spanish: {
		resetGame: 'Reiniciar el Juego',
		updateNationBtn: 'Hecho',
		playerColor: 'Color del jugador',
		team: 'Equipo',
		damage: ' daar',
		hudAttack: 'Ataque: Seleccionar objetivo',
		hudSplitAttack: 'Ataque dividido: Seleccione un objetivo',
		hudFireCannons: 'Caones de fuego',
		hudLaunchMissile: 'Lanzar misiles',
		hudLaunchNuke: 'Lanzar arma nuclear',
		resourceUiWidth: '24rem',
		selectTarget: 'Seleccione un objetivo',
		reserveLabel: 'Reserva',
		troopsLabel: 'Tropas',
		youHaveJoined: 'Te has unido al juego: ',
		startingGame: "Comenzando el juego en ",
		to: 'A ',
		whispers: ' susurros: ',
		joinedChannel: "Te has unido al canal: ",
		selectTeam: 'Selecciona un equipo',
		selectPlayerColor: 'Seleccionar color del jugador',
		difficulties: {
			'Very Easy': 'Muy fcil',
			Easy: 'Fcil',
			Normal: 'Normal',
			Hard: 'Difcil',
			'Very Hard': 'Muy duro',
			Mania: 'Mana',
			Juggernaut: 'Juggernaut'
		},
		governments: {
			Despotism: 'Despotismo',
			Monarchy: 'Monarqua',
			Democracy: 'Democracia',
			Fundamentalism: 'Fundamentalismo',
			Fascism: 'Fascismo',
			Republic: 'Repblica',
			Communism: 'Comunismo',
			Random: 'Aleatorio'
		},
		random: 'Aleatorio',
		abAttack: "Ataque",
		abSplitAttack: "Ataque dividido",
		abDeploy: "Implementar Tropas",
		abRush: "Tropas Apresuradas",
		abBuild: "Construir",
		abCannons: "Caones de fuego",
		abMissile: "Lanzar misiles",
		abNuke: "Lanzar Nuke",
		abResearch: "Investigacin",
		abMasonry: "Albailera",
		abConstruction: "Construccin",
		abEngineering: "Ingenieria",
		abGunpowder: "Plvora",
		abRocketry: "Cohetera",
		abAtomic: "Teora atmica",
		abFuture: "Tecnologa futura",
		hostLeft: "El anfitrin ha dejado el lobby.",
		needTwoPlayers: "Necesitas dos jugadores para comenzar un juego! Espere a que los jugadores se unan o agreguen un reproductor de computadora para comenzar.",
		failedToLoad: "Error al cargar los datos del juego.",
		flagChanged: "La bandera de tu nacin est ahora: ",
		rankedSearch: "Buscando juegos clasificados...",
		noRankedFound: "No se encontraron juegos clasificados!<br>Intenta crear un juego clasificado en lugar.",
		notScience: "No hay suficiente ciencia!",
		needTwoUnits: "Necesitas al menos 2 tropas para mover o atacar!",
		maxUnits: "Necesitas al menos 2 tropas para mover o atacar!",
		friendlyFire: "Fuego amigo! Ese es tu compaero de equipo",
		notEnoughEnergy: 'No suficiente energa!',
		notYourTile: 'Usted no es dueo de ese azulejo.',
		noTroopsAvailable: "No hay tropas disponibles para el despliegue!",
		badGameName: "El nombre del juego debe tener al menos 4-32 caracteres.",
		notEnoughPlayers: "El juego debe tener 2-8 jugadores.",
		newNationName: "El nombre de su nueva nacin es: ",
		verifyingSteam: "Verificacin de credenciales de Steam...",
		steamNotFound: "Incapaz de detectar Steam. Ejecute Steam y vuelva a intentarlo!",
		logoutSuccess: "Salir exitoso",
		logoutFailed: "Desconexin",
		ribbonTitle: ['',
			'Medalla Nacional de Combate',
			'Premio Tactical Nuke Recognition',
			'Premio de Buena Conducta',
			"Cinta de servicio del patriota",
			'Cinta del servicio cvico',//5
			'Medalla de bronce meritoria',
			'Medalla de Bronce Service',
			'Medalla Expedicionaria de Bronce',
			'Cruz de bronce',
			'Cruz de plata',//10
			'Cruz dorada',
			'Cruz de platino',
			'Premio Causa Revolucionaria',
			'Premio Estratgico de Guerra',
			'Premio del servicio de combate', //15
			'Premio Combat Gallantry',
			"Medalla de Conquistador Stalwart",
			"Espada del dictador",
			"Regala del Rey",
			"Escalas de Archon",//20
			'Pacto Divino',
			"Fastos del emperador",
			"Rama del guila",
			"Hoz de camarada",
			'Medalla expedicionaria de oro',//25
			'Medalla de oro meritoria',
			'Medalla de servicio de oro',
			"Medalla del campen",
			"Medalla de conquistador",
			"Medalla del Comandante",//30
			"Premio Intrepid Heroism",
			'Medalla Expedicionaria de la Guerra Global',
			'Medalla Expedicionaria de Plata',
			'Medalla de plata meritoria',
			'Medalla de plata del servicio',//35
			"Cinta de servicio del ingeniero",
		],
		ribbonDescription: ['', // 0
			'Estableci su nacin',
			'Destruy una fortaleza con un arma nuclear',
			'Agreg dos camaradas a su lista de amigos',
			'Actualizado su bandera nacional',
			"Actualiz el nombre de su nacin",//5
			'Gan 10 juegos clasificados',
			'Gan 10 juegos de equipo',
			'Gan 10 gratis para todos los juegos',
			'Alcanz una calificacin de 1800+',
			'Alcanz la calificacin de 2100+',//10
			'Alcanz la calificacin de 2400+',
			'Se alcanz una calificacin de 2700+',
			'Gran Revolucionario conquist un azulejo con ms de 100 unidades', //13
			'Gana un juego con una relacin de muerte de 2 a 1',
			'Gan 10 juegos seguidos', // 15
			'Gan 25 juegos seguidos',
			'Conquist un azulejo con una fortaleza',// 17
			"Gan un juego bajo el despotismo",
			'Gan un juego como monarqua',
			'Gan un juego como una democracia',//20
			'Gan un juego en Fundamentalismo',
			'Gan un juego bajo el fascismo',
			'Gan un juego como Repblica',
			'Gan un juego bajo el comunismo',
			'Gan 500 gratis para todos los juegos',//25
			'Gan 500 juegos clasificados',
			'Gan 500 juegos de equipo',
			"Llegar a la cima # 10 en la clasificacin clasificada",
			"Llegue a la cima # 100 en la clasificacin clasificada",
			"Toca la parte superior # 1000 en la clasificacin clasificada",//30
			"Derrotado el Juggernaut",
			'Gana un juego gratis para 8 jugadores para todos',
			'Gan 100 gratis para todos los juegos',
			'Gan 100 juegos clasificados',
			'Gan 100 juegos de equipo',//35
			'Construye una fortaleza',
		],
		gameNameNotValid: "El nombre del juego no es vlido!",
		congratulations: "Felicitaciones!",
		gameVictory: "Su campaa para la dominacin global ha tenido xito!",
		victory: "Victoria",
		armistice: "Armisticio!",
		gameArmistice: "La campaa ha sido suspendida!",
		ceaseFire: "Cese el fuego",
		defeat: "Derrota!",
		gameDefeat: "Su campaa para dominar el mundo ha fallado!",
		concede: "Conceder la derrota",
		spectate: "Spectate",
		defeatIn: "Derrota en ",
		statOverview: "Visin de conjunto",
		statUnits: "Unidades",
		statStructures: "Estructuras",
		statWeapons: "Armas",
		statResources: "Recursos",
		tabUnits: "Unidades",
		tabStructures: "Estructuras",
		tabWeapons: "Armas",
		tabResources: "Recursos",
		tabTotalScore: "Puntaje total",
		tabEarned: "Ganado",
		tabDeployed: "Desplegada",
		tabKilled: "Delicado",
		tabLost: "Perdido",
		tabBunkers: "Bunkers",
		tabWalls: "Paredes",
		tabFortresses: "Fortalezas",
		tabCannons: "Caones",
		tabMissiles: "Misiles",
		tabNukes: "Bombas nucleares",
		tabEnergy: "Energa",
		tabScience: "Ciencia",
		tabFood: "Comida",
		tabCulture: "Cultura",
		gameDuration: "Duracin del juego ",
		endGame: "Fin del juego",
		joinPrivateGameBtnConfirm: "Unete al juego",
		createGameHead: "Gratis para todos los juegos",
		createRankedGameHead: "Juego clasificado",
		createGameNameLabel: "Nombre del juego",
		createGamePasswordLabel: "Contrasea (opcional)",
		createGameMaxPlayerLabel: "Jugadores mximos:",
		createGameMapLabel: "Mapa",
		createGame: "Crear juego",
		createTeamGameHeadLabel: "Juego de equipo",
		noRankedGamesFound: "No se encontraron juegos clasificados!<br>Intenta crear un juego clasificado en lugar.",
		privateGameNameLabel: "Nombre del juego",
		privateGamePasswordLabel: "Contrasea",
		confirmSurrenderPrompt: "Rendicin? Ests seguro?",
		canceSurrenderButtonCancel: "Cancelar",
		surrenderButtonConfirm: "Rendicin",
		hotkeyUi: "[V] Alternar la interfaz de usuario",
		options: "[ESC] Opciones",
		researchMasonry: "[Y] Investigacin de albailera para desbloquear bnkers\r\n(20 segundos)",
		researchConstruction: "[O] Investigacin de construccin para desbloquear muros\r\n(30 segundos)",
		researchEngineering: "[E] Ingeniera de investigacin para desbloquear fortalezas\r\n(45 segundos)",
		researchGunpowder: "[G] Investiga plvora para desbloquear caones\r\n(25 segundos)",
		researchRocketry: "[K] Rocketry de investigacin para desbloquear misiles\r\n(40 segundos)",
		researchAtomicTheory: "[T] Investigue la teora atmica para desbloquear armas nucleares\r\n(60 segundos)",
		researchFutureTech: "[F] Investigue la tecnologa futura\r\n(90 segundos)",
		attack: "[A] Ataque con todas las tropas",
		splitAttack: "[S] Ataca con la mitad de tus tropas",
		deploy: "[D] Despliega tropas de reserva a un azulejo",
		rush: "[R] Apresrate a las tropas de tu ciudadana. Impulsado por la bonificacin cultural ",
		defenseLabel: ['Bnker', 'Pared', 'Fortaleza'],
		boostsTileDefenses: '[B] Aumenta las defensas de los azulejos +',
		reducesWeaponsBy: ' y reduce el dao de arma por ',
		fireCannons: '[C] Caones de fuego en un azulejo adyacente. Impulsado por grandes generales.\r\n',
		launchMissile: '[M] Lanza un misil en cualquier territorio. Impulsado por grandes generales.\r\n',
		launchNuke: "[N] Lanza un arma nuclear en cualquier territorio. Mata al 80-99% de las tropas y destruye todas las estructuras.",
		foodBonusTitle: "Bonificacin de alimentos",
		foodMilestoneTitle: "Hitos de alimentos producen tropas de reserva.",
		scienceBonusTitle: "Bonificacin de ciencia",
		scienceMilestoneTitle: "La ciencia se usa para construir estructuras, armas de fuego y tecnologa de investigacin.",
		cultureBonusTitle: "Bonificacin cultural",
		cultureMilestoneTitle: "Los hitos de la cultura producen recompensas especiales.",
		troopFlex: "Implementar tropas en territorios conquistados",
		currentYear: "Es el ao actual!",
		energyWrap: "La energa se usa para atacar, mover, desplegar y atacar a las tropas.",
		foodWrap: "Hitos de alimentos producen tropas de reserva",
		scienceWrap: "La ciencia se usa para construir estructuras, armas y tecnologa de investigacin.",
		cultureWrap: "Los hitos de la cultura producen recompensas especiales",
		generalWrap: "Grandes generales impulsan el ataque de las tropas",
		tacticianWrap: "Los grandes tcticos impulsan la defensa de las tropas",
		energyTimerBase: "Actualizacin de recursos al final de cada turno.",
		hideUi: "[V] Ocultar interfaz de usuario",
		toggleFlags: "Alternar banderas",
		hotkeys: "Teclas de acceso rpido",
		gameOptions: "[ESC] Opciones",
		surrender: "Rendicin",
		exitSpectate: "Salir de Spectate",
		uninhabited: "Deshabitado",
		barbarianTribe: "Tribu brbara",
		Despotism: [
			'Movimiento libre a travs de fichas propias',
			'Comience con plvora',
			'Comience con un bnker',
			'2x tamao mximo de ataque del ejrcito',
		],
		Monarchy: [
			'+2 defensa',
			'+1 cultura de 2 alimentos',
			'50% comenzando la bonificacin cultural',
			'+2 dao de can',
		],
		Democracy: [
			'4x Despliegue mximo de tropas',
			'+3 tropas de reserva cuando pierdes un azulejo',
			'50% comenzando la bonificacin cientfica',
			'Requisito de hito cultural reducido',
		],
		Fundamentalism: [
			'Desbordamiento: ganancia instantnea con 4x de ventaja',
			'Infiltracin: -1 estructura de defensa',
			'Crecimiento rpido: requisito de hito de alimentacin reducido',
			'+2 bonificacin de recompensa de tropa',
		],
		Fascism: [
			'+1 ataque',
			'+1 ataque de fichas para cada estructura defensiva',
			'+4 ataque contra brbaros',
			'Tropa de bonificacin con cada despliegue',
		],
		Republic: [
			'+1 energa',
			'Los mdicos de combate curan al 50% de las tropas tras la victoria',
			'Comience con mampostera',
			'+50% botn recompensa extra de los brbaros',
		],
		Communism: [
			'Comience con una gran persona',
			'+1 ciencia de 4 alimentos',
			'Puede desplegar tropas en territorio deshabitado',
			'2x bonificacin de recompensa descubierta de los brbaros',
		],
		removeCPU: 'Eliminar la computadora',
		addCPU: 'Agregar computadora',
		lobbyRankedMatch: 'Partida igualada',
		lobbyGameNameLabel: 'Nombre del juego',
		lobbyGamePasswordLabel: 'Contrasea',
		lobbyGameModeLabel: 'Modo de juego',
		lobbyGameMapLabel: 'Mapa',
		lobbyMaxPlayersLabel: 'Jugadores mximos',
		startGame: 'Empezar juego',
		cancelGame: 'Salida',
		setNationName: 'Nombre de la nacin',
		submitNationName: 'Actualizar el nombre de la nacin',
		setNationFlag: 'Bandera nacional',
		leaderboardRankedBtn: 'Clasificado',
		leaderboardFfaBtn: 'Gratuita para todos',
		leaderboardTeamBtn: 'Equipo',
		playNowBtn: 'Reproducir ahora',
		create: 'Gratuita para todos',
		createTeamBtn: 'Juego de equipo',
		joinPrivateGameBtn: 'Unirse al juego privado',
		createRankedBtn: 'Crear partida igualada',
		joinRankedGame: 'Unirse al partido clasificado',
		toggleNation: 'Configurar Nacin',
		leaderboardBtn: 'Tabla de clasificacin',
		gameTableName: 'Nombre del juego',
		gameTableMap: 'Mapa',
		gameTableType: 'Tipo',
		friendStatus: 'Mostrar lista de amigos',
		addFriend: 'Alternar amigo',
		ignoreStatus: 'Mostrar Ignorar Lista',
		ignoreUser: 'Ignorar cuenta',
		whoAccount: 'Cuenta de consulta',
		whisperAccount: 'Mensaje privado',
		changeChannel: 'Cambia el canal',
		getHelp: 'Comandos de chat',
		howToPlay: 'Cmo jugar',
		brokenNet: 'Bienvenido a Broken.net!',
		optionsHeader: 'Opciones',
		musicVolume: 'Volumen de la msica',
		soundVolume: 'Volumen del efecto de sonido',
		bibleMode: 'Modo Biblia',
		windowSize: 'Tamao de ventana',
		currentWindowSize: 'Pantalla completa',
		windowFullScreen: 'Pantalla completa',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: 'Salir del juego',
		versionSpan: 'Versin ',
		foodMilestoneLabel: 'Comida',
		scienceMilestoneLabel: 'Ciencia',
		cultureMilestoneLabel: 'Cultura',
	},
	french: {
		resetGame: 'Rinitialiser le Jeu',
		updateNationBtn: 'Termin',
		playerColor: 'Couleur du joueur',
		team: 'quipe',
		damage: ' dommage',
		hudAttack: 'Attaque: Slectionner la cible',
		hudSplitAttack: 'Attaque de Split: Slectionner la cible',
		hudFireCannons: 'Canons de feu',
		hudLaunchMissile: 'Lancer un missile',
		hudLaunchNuke: 'Lancer une bombe nuclaire',
		resourceUiWidth: '28rem',
		selectTarget: 'Slectionner la cible',
		reserveLabel: 'rserve',
		troopsLabel: 'Troupes',
		youHaveJoined: 'Vous avez rejoint le jeu: ',
		startingGame: "Jeu de dpart en ",
		to: ' ',
		whispers: ' murmure: ',
		joinedChannel: "Vous avez rejoint la chane: ",
		selectTeam: 'Choisis une quipe',
		selectPlayerColor: 'Slectionnez la couleur du lecteur',
		difficulties: {
			'Very Easy': 'Trs facile',
			Easy: 'Facile',
			Normal: 'Ordinaire',
			Hard: 'Difficile',
			'Very Hard': 'Trs dur',
			Mania: 'La manie',
			Juggernaut: 'Juggernaut'
		},
		governments: {
			Despotism: 'Despotisme',
			Monarchy: 'Monarchie',
			Democracy: 'Dmocratie',
			Fundamentalism: 'Fondamentalisme',
			Fascism: 'Fascisme',
			Republic: 'Rpublique',
			Communism: 'Communisme',
			Random: 'Au hasard'
		},
		random: 'au hasard',
		abAttack: "Attaque",
		abSplitAttack: "Attaque de Split",
		abDeploy: "Dployer des troupes",
		abRush: "Ruer Troupes",
		abBuild: "Construire",
		abCannons: "Canons de feu",
		abMissile: "Lancer un missile",
		abNuke: "Lancer une bombe nuclaire",
		abResearch: "Recherche",
		abMasonry: "Maonnerie",
		abConstruction: "Construction",
		abEngineering: "Ingnierie",
		abGunpowder: "Poudre  canon",
		abRocketry: "Science de fuse",
		abAtomic: "Thorie atomique",
		abFuture: "Technologie future",
		hostLeft: "L'hte a quitt le hall.",
		needTwoPlayers: "Vous avez besoin de deux joueurs pour commencer une partie! Attendez que les joueurs rejoignent ou ajoutent un lecteur d'ordinateur pour commencer.",
		failedToLoad: "chec du chargement des donnes de jeu.",
		flagChanged: "Le drapeau de votre nation est maintenant: ",
		rankedSearch: "Recherche de jeux classs...",
		noRankedFound: "Aucun jeu class n'a t trouv!<br>Essayez plutt de crer un jeu class.",
		notScience: "Pas assez de science!",
		needTwoUnits: "Vous avez besoin d'au moins 2 troupes pour se dplacer ou attaquer!",
		maxUnits: "Ce territoire a le nombre maximum d'units!",
		friendlyFire: "Tir ami! C'est ton coquipier!",
		notEnoughEnergy: "Pas assez d'nergie!",
		notYourTile: 'Vous ne possdez pas cette tuile.',
		noTroopsAvailable: "Pas de troupes disponibles pour le dploiement!",
		badGameName: "Le nom du jeu doit comporter au moins 4  32 caractres.",
		notEnoughPlayers: "Le jeu doit avoir 2  8 joueurs.",
		newNationName: "Votre nouveau nom de nation est: ",
		verifyingSteam: "Vrification des informations d'identification Steam...",
		steamNotFound: "Impossible de dtecter Steam. Veuillez lancer Steam et ressayer!",
		logoutSuccess: "Dconnexion russie",
		logoutFailed: "La dconnexion a chou",
		ribbonTitle: ['',
			'Mdaille nationale de combat',
			'Prix de reconnaissance tactique Nuke',
			'Prix de bonne conduite',
			"Ruban de service Patriot",
			'Ruban de service civique',//5
			'Mdaille mritoire en bronze',
			'Mdaille du service de bronze',
			'Mdaille expditionnaire de bronze',
			'Croix de bronze',
			"Croix d'Argent",//10
			"Croix d'Or",
			'Croix Platine',
			'Prix de la cause rvolutionnaire',
			'Prix de guerre stratgique',
			'Prix du service de combat', //15
			'Prix de la galanterie de combat',
			"Mdaille du vainqueur",
			"pe du dictateur",
			"Insignes royaux",
			"Les cailles d'Archon",//20
			'Divin engagement',
			"Fasces de l'empereur",
			"La branche de l'aigle",
			"La faucille du camarade",
			"Mdaille expditionnaire d'or",//25
			'Mdaille mritoire dore',
			"Mdaille d'or du service",
			"Mdaille du champion",
			"Mdaille du conqurant",
			"Mdaille du commandant",//30
			"Prix de l'hrosme intrpide",
			'Mdaille expditionnaire mondiale de guerre',
			"Mdaille expditionnaire d'argent",
			'Mdaille mritoire en argent',
			"Mdaille du service d'argent",//35
			"Ruban de service de l'ingnieur",
		],
		ribbonDescription: ['', // 0
			'tabli votre nation',
			'Dtruit une forteresse avec une arme nuclaire',
			"Ajout deux camarades  votre liste d'amis",
			'Mise  jour de votre drapeau national',
			"Mise  jour du nom de votre nation",//5
			'A remport 10 matchs classs',
			"A remport 10 matchs d'quipe",
			'Won 10 gratuit pour tous les jeux',
			'Atteint 1800+ valuation',
			'Atteint 2100+ valuation',//10
			'Atteint 2400+ valuation',
			'Atteint 2700+ valuation',
			'Grand Rvolutionnaire a conquis une tuile avec plus de 100 units', //13
			'Gagnez un jeu avec un ratio de destruction de 2  1',
			"A remport 10 matchs d'affile", // 15
			"A remport 25 matchs d'affile",
			'Conquis une tuile avec une forteresse',// 17
			"A gagn un jeu sous le despotisme",
			'A remport un jeu en tant que monarchie',
			'A gagn un jeu en tant que dmocratie',//20
			'A gagn un jeu sous le fondamentalisme',
			'A remport un match sous le fascisme',
			'A remport un match en tant que Rpublique',
			'A gagn un jeu sous le communisme',
			'Won 500 gratuit pour tous les jeux',//25
			'A remport 500 matchs classs',
			"A gagn 500 jeux d'quipe",
			"Hit top # 10 sur le classement par classement",
			"Hit top # 100 sur le classement par classement",
			"Hit top # 1000 sur le classement par classement",//30
			"Vaincu le Juggernaut",
			'Gagnez un 8 joueurs gratuit pour tous les jeux',
			'Gagn 100 gratuit pour tous les jeux',
			'A remport 100 matchs classs',
			'A remport 100 matchs par quipe',//35
			'Construire une forteresse',
		],
		gameNameNotValid: "Le nom du jeu n'est pas valide!",
		congratulations: "Toutes nos flicitations!",
		gameVictory: "Votre campagne pour la domination mondiale a russi!",
		victory: "La victoire",
		armistice: "Armistice!",
		gameArmistice: "La campagne a t suspendue!",
		ceaseFire: "Cessez le feu",
		defeat: "Dfaite!",
		gameDefeat: "Votre campagne pour la domination du monde a chou!",
		concede: "Concder la dfaite",
		spectate: "Spectate",
		defeatIn: "Dfaite dans ",
		statOverview: "Aperu",
		statUnits: "Units",
		statStructures: "Structures",
		statWeapons: "Armes",
		statResources: "Ressources",
		tabUnits: "Units",
		tabStructures: "Structures",
		tabWeapons: "Armes",
		tabResources: "Ressources",
		tabTotalScore: "Score total",
		tabEarned: "Gagn",
		tabDeployed: "Dploy",
		tabKilled: "Tu",
		tabLost: "Perdu",
		tabBunkers: "Bunkers",
		tabWalls: "Des murs",
		tabFortresses: "Forteresses",
		tabCannons: "Canons",
		tabMissiles: "Missiles",
		tabNukes: "Armes nuclaires",
		tabEnergy: "nergie",
		tabScience: "Science",
		tabFood: "Aliments",
		tabCulture: "Culture",
		gameDuration: "Dure du jeu ",
		endGame: "Fin du jeu",
		joinPrivateGameBtnConfirm: "Rejoins une partie",
		createGameHead: "Gratuit pour tous les jeux",
		createRankedGameHead: "Jeu class",
		createGameNameLabel: "Nom du jeu",
		createGamePasswordLabel: "Mot de passe (facultatif)",
		createGameMaxPlayerLabel: "Maximum de joueurs:",
		createGameMapLabel: "Carte",
		createGame: "Crer un jeu",
		createTeamGameHeadLabel: "Jeu d'quipe",
		noRankedGamesFound: "Aucun jeu class n'a t trouv!<br>Essayez plutt de crer un jeu class.",
		privateGameNameLabel: "Nom du jeu",
		privateGamePasswordLabel: "Mot de passe",
		confirmSurrenderPrompt: "Abandon? tes-vous sr?",
		canceSurrenderButtonCancel: "Annuler",
		surrenderButtonConfirm: "Abandon",
		hotkeyUi: "[V] Basculer l'interface utilisateur",
		options: "[ESC] Options",
		researchMasonry: "[Y] Recherche maonnerie pour dbloquer des bunkers\r\n(20 secondes)",
		researchConstruction: "[O] Construction de recherche pour dverrouiller les murs\r\n(30 secondes)",
		researchEngineering: "[E] Ingnierie de recherche pour dbloquer des forteresses\r\n(45 secondes)",
		researchGunpowder: "[G] Recherche de poudre  canon pour dbloquer des canons\r\n(25 secondes)",
		researchRocketry: "[K] Recherche de fuses pour dbloquer des missiles\r\n(40 secondes)",
		researchAtomicTheory: "[T] La recherche sur la thorie atomique pour dbloquer des armes nuclaires\r\n(60 secondes)",
		researchFutureTech: "[F] Recherche future technologie\r\n(90 secondes)",
		attack: "[A] Attaque avec toutes les troupes",
		splitAttack: "[S] Attaque avec la moiti de vos troupes",
		deploy: "[D] Dployer des troupes de rserve sur une case",
		rush: "[R] Dplacez les troupes de vos citoyens. Boost par le bonus de culture ",
		defenseLabel: ['Bunker', 'Mur', 'Forteresse'],
		boostsTileDefenses: '[B] Augmente les dfenses des carreaux +',
		reducesWeaponsBy: ' et rduit les dgts de l\'arme en ',
		fireCannons: '[C] Canons de feu sur une tuile adjacente. Boost par les grands gnraux.\r\n',
		launchMissile: '[M] Lancez un missile sur n\'importe quel territoire. Boost par les grands gnraux.\r\n',
		launchNuke: "[N] Lancer une arme nuclaire sur n'importe quel territoire. Tue 80  99% des troupes et dtruit toutes les structures.",
		foodBonusTitle: "Bonus alimentaire",
		foodMilestoneTitle: "Les jalons alimentaires produisent des troupes de rserve.",
		scienceBonusTitle: "Bonus scientifique",
		scienceMilestoneTitle: "La science est utilise pour construire des structures, des armes  feu et des technologies de recherche.",
		cultureBonusTitle: "Bonus de culture",
		cultureMilestoneTitle: "Les jalons de la culture produisent des rcompenses spciales.",
		troopFlex: "Dployer des troupes dans des territoires conquis",
		currentYear: "C'est l'anne en cours!",
		energyWrap: "L'nergie est utilise pour attaquer, dplacer, dployer et envoyer des troupes.",
		foodWrap: "Les jalons alimentaires produisent des troupes de rserve",
		scienceWrap: "La science est utilise pour construire des structures, des armes et des technologies de recherche.",
		cultureWrap: "Les jalons de la culture produisent des rcompenses spciales",
		generalWrap: "Les grands gnraux renforcent l'attaque des troupes",
		tacticianWrap: "Les grands tactiques renforcent la dfense des troupes",
		energyTimerBase: "Mise  jour des ressources  la fin de chaque tour.",
		hideUi: "[V] Masquer l'interface utilisateur",
		toggleFlags: "Basculer les drapeaux",
		hotkeys: "Hotkeys",
		gameOptions: "[ESC] Options",
		surrender: "Abandon",
		exitSpectate: "Exit Spectate",
		uninhabited: "Inhabit",
		barbarianTribe: "Tribu barbare",
		Despotism: [
			'Libre circulation  travers ses propres carreaux',
			'Commencez avec de la poudre  canon',
			'Commencez avec un bunker',
			"2x taille d'attaque maximale de l'arme",
		],
		Monarchy: [
			'+2 dfense',
			'+1 culture de 2 aliments',
			'50% dpart de la culture bonus',
			'+2 dgts de cannon',
		],
		Democracy: [
			'4x dploiement maximal des troupes',
			'+3 rserver des troupes lorsque vous perdez une tuile',
			'50% prime de dpart en science',
			"Rduction de l'exigence de jalons de culture",
		],
		Fundamentalism: [
			'Envahi: Gagnez instantanment avec 4x avantage',
			'Infiltration: -1 dfense de structure',
			'Croissance rapide: Rduction des besoins en produits alimentaires',
			'+2 prime de rcompense de troupe',
		],
		Fascism: [
			'+1 attaque',
			'+1 attaque des tuiles pour chaque structure dfensive',
			'+4 attaque contre les barbares',
			'Troupe Bonus  chaque dploiement',
		],
		Republic: [
			'+1 nergie',
			'Les infirmiers de combat soignent 50% des troupes aprs la victoire',
			'Commencez avec la maonnerie',
			'+50% piller le bonus de rcompense des barbares',
		],
		Communism: [
			'Commence avec une bonne personne',
			'+1 la science de 4 aliments',
			'Peut dployer des troupes en territoire inhabit',
			'2x dcouvert le bonus de rcompense des barbares',
		],
		removeCPU: "Supprimer l'ordinateur",
		addCPU: 'Ajouter un ordinateur',
		lobbyRankedMatch: 'Match class',
		lobbyGameNameLabel: 'Nom du jeu',
		lobbyGamePasswordLabel: 'Mot de passe',
		lobbyGameModeLabel: 'Mode de jeu',
		lobbyGameMapLabel: 'Carte',
		lobbyMaxPlayersLabel: 'Le maximum de joueurs',
		startGame: 'Dmarrer jeu',
		cancelGame: 'Sortie',
		setNationName: 'Nom de la nation',
		submitNationName: 'Mettre  jour le nom',
		setNationFlag: 'Drapeau national',
		leaderboardRankedBtn: 'Class',
		leaderboardFfaBtn: 'Gratuit pour tous',
		leaderboardTeamBtn: 'quipe',
		playNowBtn: 'Joue maintenant',
		create: 'Gratuit pour tous',
		createTeamBtn: "Jeu d'quipe",
		joinPrivateGameBtn: 'Rejoindre un jeu priv',
		createRankedBtn: 'Crer un match class',
		joinRankedGame: 'Rejoindre un match class',
		toggleNation: 'Configurer Nation',
		leaderboardBtn: 'Classement',
		gameTableName: 'Nom du jeu',
		gameTableMap: 'Carte',
		gameTableType: 'Type',
		friendStatus: "Afficher la liste d'amis",
		addFriend: 'Bascule ami',
		ignoreStatus: 'Afficher la liste des ignors',
		ignoreUser: 'Ignorer le compte',
		whoAccount: 'Compte de requte',
		whisperAccount: 'Message priv',
		changeChannel: 'Changer de chane',
		getHelp: 'Commandes de chat',
		howToPlay: 'Comment jouer',
		brokenNet: 'Bienvenue  Broken.net!',
		optionsHeader: 'Options',
		musicVolume: 'Volume de la musique',
		soundVolume: 'Volume sonore',
		bibleMode: 'Mode Bible',
		windowSize: 'La taille de la fentre',
		currentWindowSize: 'Plein cran',
		windowFullScreen: 'Full Screen',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: 'Quitter le jeu',
		versionSpan: 'Version ',
		foodMilestoneLabel: 'Aliments',
		scienceMilestoneLabel: 'Science',
		cultureMilestoneLabel: 'Culture',
	},
	koreana: {
		resetGame: '  ',
		updateNationBtn: '',
		playerColor: ' ',
		team: '',
		damage: ' ',
		hudAttack: ':  ',
		hudSplitAttack: ' :  ',
		hudFireCannons: ' ',
		hudLaunchMissile: ' ',
		hudLaunchNuke: ' ',
		resourceUiWidth: '22rem',
		selectTarget: ' ',
		reserveLabel: '',
		troopsLabel: '',
		youHaveJoined: '  .: ',
		startingGame: "   ",
		to: ' ',
		whispers: ' : ',
		joinedChannel: " .: ",
		selectTeam: ' ',
		selectPlayerColor: '  ',
		difficulties: {
			'Very Easy': ' ',
			Easy: '',
			Normal: '',
			Hard: '',
			'Very Hard': '',
			Mania: '',
			Juggernaut: ' '
		},
		governments: {
			Despotism: '',
			Monarchy: '',
			Democracy: '',
			Fundamentalism: '',
			Fascism: '',
			Republic: '',
			Communism: '',
			Random: ''
		},
		random: '',
		abAttack: "",
		abSplitAttack: " ",
		abDeploy: " ",
		abRush: " ",
		abBuild: "",
		abCannons: " ",
		abMissile: " ",
		abNuke: " ",
		abResearch: "",
		abMasonry: " ",
		abConstruction: "",
		abEngineering: "",
		abGunpowder: "",
		abRocketry: " ",
		abAtomic: "",
		abFuture: " ",
		hostLeft: "  ..",
		needTwoPlayers: "    !          .",
		failedToLoad: "  .",
		flagChanged: "   : ",
		rankedSearch: "   ...",
		noRankedFound: "  !<br>   .",
		notScience: "  .!",
		needTwoUnits: "   2   .!",
		maxUnits: "     .!",
		friendlyFire: " !   !",
		notEnoughEnergy: '  !',
		notYourTile: '     .',
		noTroopsAvailable: "    !",
		badGameName: "  4 ~ 32  .",
		notEnoughPlayers: " 2-8  .",
		newNationName: "    : ",
		verifyingSteam: "   ...",
		steamNotFound: "    . Steam   !",
		logoutSuccess: "  ",
		logoutFailed: "  .",
		ribbonTitle: ['',
			'  ',
			'   ',
			'  ',
			"  ",
			'  ',//5
			'  ',
			'  ',
			'  ',
			' ',
			' ',//10
			' ',
			' ',
			'  ',
			'  ',
			'  ', //15
			' ',
			"   ",
			" ",
			" ",
			"  ",//20
			' ',
			" ",
			" ",
			" ",
			'  ',//25
			'  ',
			'  ',
			" ",
			" ",
			" ",//30
			" ",
			'   ',
			'  ',
			'  ',
			'  ',//35
			"  ",
		],
		ribbonDescription: ['', // 0
			'  ',
			'  .',
			'  2   .',
			' ',
			"  ",//5
			'10   ',
			'10   ',
			'   10  ',
			'  1800+ ',
			'  2100+ ',//10
			'  2400+ ',
			'  2700+ ',
			'Great Revolutionary 100     .', //13
			'2 : 1   ',
			'10 ', // 15
			'25 ',
			'  .',// 17
			"   .",
			'  .',
			'  .',//20
			'  ',
			'   ',
			'  ',
			'   ',
			'  500  ',//25
			'500   .',
			'500   ',
			"  10  .",
			"  100  .",
			"  1000  ",//30
			"  .",
			'  8   ',
			'   100  ',
			'100   ',
			'100   ',//35
			' ',
		],
		gameNameNotValid: "   !",
		congratulations: "!",
		gameVictory: "    !",
		victory: "",
		armistice: "!",
		gameArmistice: "  .",
		ceaseFire: " ",
		defeat: "!",
		gameDefeat: "   !",
		concede: " ",
		spectate: "",
		defeatIn: "  ",
		statOverview: "",
		statUnits: "",
		statStructures: "",
		statWeapons: "",
		statResources: "",
		tabUnits: "",
		tabStructures: "",
		tabWeapons: "",
		tabResources: "",
		tabTotalScore: " ",
		tabEarned: "",
		tabDeployed: " ",
		tabKilled: " ",
		tabLost: "",
		tabBunkers: "",
		tabWalls: "",
		tabFortresses: "",
		tabCannons: "",
		tabMissiles: "",
		tabNukes: "",
		tabEnergy: "",
		tabScience: "",
		tabFood: "",
		tabCulture: "",
		gameDuration: "  ",
		endGame: " ",
		joinPrivateGameBtnConfirm: " ",
		createGameHead: "  ",
		createRankedGameHead: " ",
		createGameNameLabel: " ",
		createGamePasswordLabel: " ( )",
		createGameMaxPlayerLabel: "   :",
		createGameMapLabel: "",
		createGame: " ",
		createTeamGameHeadLabel: " ",
		noRankedGamesFound: "   !<br>   .",
		privateGameNameLabel: " ",
		privateGamePasswordLabel: "",
		confirmSurrenderPrompt: "?",
		canceSurrenderButtonCancel: "",
		surrenderButtonConfirm: "",
		hotkeyUi: "[V]   ",
		options: "[ESC] ",
		researchMasonry: "[Y]    \r\n(20 )",
		researchConstruction: "[O]    \r\n(30 )",
		researchEngineering: "[E]    \r\n(45 )",
		researchGunpowder: "[G]    \r\n(25 )",
		researchRocketry: "[K]    \r\n(40 )",
		researchAtomicTheory: "[T]     \r\n(60 )",
		researchFutureTech: "[F]   \r\n(90 )",
		attack: "[A]   ",
		splitAttack: "[S]   ",
		deploy: "[D]    ",
		rush: "[R]     .    ",
		defenseLabel: ['', '', ''],
		boostsTileDefenses: '[B]    +',
		reducesWeaponsBy: '    ',
		fireCannons: '[C]    .     \r\n',
		launchMissile: '[M]    .     \r\n',
		launchNuke: "[N]    .  80 ~ 99 %    ",
		foodBonusTitle: " ",
		foodMilestoneTitle: "   ",
		scienceBonusTitle: " ",
		scienceMilestoneTitle: " ,        ",
		cultureBonusTitle: " ",
		cultureMilestoneTitle: "    ",
		troopFlex: "    ",
		currentYear: " !",
		energyWrap: "  , ,     ",
		foodWrap: "   ",
		scienceWrap: " ,       ",
		cultureWrap: "    ",
		generalWrap: "    ",
		tacticianWrap: "     ",
		energyTimerBase: "    .",
		hideUi: "[V]   ",
		toggleFlags: " ",
		hotkeys: "",
		gameOptions: "[ESC] ",
		surrender: "",
		exitSpectate: "  ",
		uninhabited: "",
		barbarianTribe: " ",
		Despotism: [
			'    ',
			' .',
			' .',
			'2x    ',
		],
		Monarchy: [
			'+2 ',
			'+1 2   ',
			'50%   ',
			'+2  ',
		],
		Democracy: [
			'4x   ',
			'+3     .',
			'50%   ',
			'    ',
		],
		Fundamentalism: [
			' : 4    ',
			' : -1  ',
			'  :     ',
			'+2   ',
		],
		Fascism: [
			'+1 ',
			'+1      ',
			'+4   ',
			'    ',
		],
		Republic: [
			'+1 ',
			'   50 %  .',
			' .',
			'+50%    ',
		],
		Communism: [
			'  .',
			'+1  4 ',
			'    ',
			'2x    ',
		],
		removeCPU: ' ',
		addCPU: ' ',
		lobbyRankedMatch: ' ',
		lobbyGameNameLabel: ' ',
		lobbyGamePasswordLabel: '',
		lobbyGameModeLabel: ' ',
		lobbyGameMapLabel: '',
		lobbyMaxPlayersLabel: ' ',
		startGame: ' ',
		cancelGame: '',
		setNationName: ' ',
		submitNationName: '  ',
		setNationFlag: '',
		leaderboardRankedBtn: '',
		leaderboardFfaBtn: ' ',
		leaderboardTeamBtn: '',
		playNowBtn: ' ',
		create: ' ',
		createTeamBtn: ' ',
		joinPrivateGameBtn: '  ',
		createRankedBtn: '  ',
		joinRankedGame: '  ',
		toggleNation: ' ',
		leaderboardBtn: ' ',
		gameTableName: ' ',
		gameTableMap: '',
		gameTableType: '',
		friendStatus: '  ',
		addFriend: ' ',
		ignoreStatus: '  ',
		ignoreUser: ' ',
		whoAccount: ' ',
		whisperAccount: '',
		changeChannel: ' ',
		getHelp: ' ',
		howToPlay: ' ',
		brokenNet: '    Broken.net!',
		optionsHeader: '',
		musicVolume: ' ',
		soundVolume: ' ',
		bibleMode: ' ',
		windowSize: ' ',
		currentWindowSize: ' ',
		windowFullScreen: ' ',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: ' ',
		versionSpan: ' ',
		foodMilestoneLabel: '',
		scienceMilestoneLabel: '',
		cultureMilestoneLabel: '',
	},
	japanese: {
		resetGame: '',
		updateNationBtn: '',
		playerColor: '',
		team: '',
		damage: ' ',
		hudAttack: ': ',
		hudSplitAttack: ': ',
		hudFireCannons: '',
		hudLaunchMissile: '',
		hudLaunchNuke: '',
		resourceUiWidth: '27rem',
		selectTarget: '',
		reserveLabel: '',
		troopsLabel: '',
		youHaveJoined: ' ',
		startingGame: " ",
		to: ' ',
		whispers: ' : ',
		joinedChannel: " ",
		selectTeam: '',
		selectPlayerColor: '',
		difficulties: {
			'Very Easy': '',
			Easy: '',
			Normal: '',
			Hard: '',
			'Very Hard': '',
			Mania: '',
			Juggernaut: ''
		},
		governments: {
			Despotism: '',
			Monarchy: '',
			Democracy: '',
			Fundamentalism: '',
			Fascism: '',
			Republic: '',
			Communism: '',
			Random: ''
		},
		random: '',
		abAttack: "",
		abSplitAttack: "",
		abDeploy: "",
		abRush: "",
		abBuild: "",
		abCannons: "",
		abMissile: "",
		abNuke: "",
		abResearch: "",
		abMasonry: "",
		abConstruction: "",
		abEngineering: "",
		abGunpowder: "",
		abRocketry: "",
		abAtomic: "",
		abFuture: "",
		hostLeft: "",
		needTwoPlayers: "2 ",
		failedToLoad: "",
		flagChanged: " ",
		rankedSearch: "...",
		noRankedFound: "<br>",
		notScience: "",
		needTwoUnits: "2",
		maxUnits: "",
		friendlyFire: " ",
		notEnoughEnergy: '',
		notYourTile: '',
		noTroopsAvailable: "",
		badGameName: "432",
		notEnoughPlayers: "2-8",
		newNationName: " ",
		verifyingSteam: "...",
		steamNotFound: " Steam",
		logoutSuccess: "",
		logoutFailed: "",
		ribbonTitle: ['',
			'',
			'',
			'',
			"",
			'',//5
			'',
			'',
			'',
			'',
			'',//10
			'',
			'',
			'',
			'',
			'', //15
			'',
			"",
			"",
			"",
			"",//20
			'',
			"",
			"",
			"",
			'',//25
			'',
			'',
			"",
			"",
			"",//30
			"",
			'',
			'',
			'',
			'',//35
			"",
		],
		ribbonDescription: ['', // 0
			'',
			'',
			'2',
			'',
			"",//5
			'10',
			'10',
			'10',
			'1800+',
			'2100+',//10
			'2400+',
			'2700+',
			'100', //13
			'21',
			'10', // 15
			'25',
			'',// 17
			"",
			'',
			'',//20
			'',
			'',
			'',
			'',
			'500',//25
			'500',
			'500',
			"10",
			"100",
			"1000",//30
			"",
			'8',
			'100',
			'100',
			'100',//35
			'',
		],
		gameNameNotValid: "",
		congratulations: "",
		gameVictory: "",
		victory: "",
		armistice: "",
		gameArmistice: "",
		ceaseFire: "",
		defeat: "",
		gameDefeat: "",
		concede: "",
		spectate: "",
		defeatIn: " ",
		statOverview: "",
		statUnits: "",
		statStructures: "",
		statWeapons: "",
		statResources: "",
		tabUnits: "",
		tabStructures: "",
		tabWeapons: "",
		tabResources: "",
		tabTotalScore: "",
		tabEarned: "",
		tabDeployed: "",
		tabKilled: "",
		tabLost: "",
		tabBunkers: "",
		tabWalls: "",
		tabFortresses: "",
		tabCannons: "",
		tabMissiles: "",
		tabNukes: "",
		tabEnergy: "",
		tabScience: "",
		tabFood: "",
		tabCulture: "",
		gameDuration: " ",
		endGame: "",
		joinPrivateGameBtnConfirm: "",
		createGameHead: "",
		createRankedGameHead: "",
		createGameNameLabel: "",
		createGamePasswordLabel: "",
		createGameMaxPlayerLabel: "",
		createGameMapLabel: "",
		createGame: "",
		createTeamGameHeadLabel: "",
		noRankedGamesFound: "<br>",
		privateGameNameLabel: "",
		privateGamePasswordLabel: "",
		confirmSurrenderPrompt: " ",
		canceSurrenderButtonCancel: "",
		surrenderButtonConfirm: "",
		hotkeyUi: "[V] ",
		options: "[ESC] ",
		researchMasonry: "[Y] \r\n(20 )",
		researchConstruction: "[O] \r\n(30 )",
		researchEngineering: "[E] \r\n(45 )",
		researchGunpowder: "[G] \r\n(25 )",
		researchRocketry: "[K] \r\n(40 )",
		researchAtomicTheory: "[T] \r\n(60 )",
		researchFutureTech: "[F] \r\n(90 )",
		attack: "[A] ",
		splitAttack: "[S] ",
		deploy: "[D] ",
		rush: "[R]   ",
		defenseLabel: ['', '', ''],
		boostsTileDefenses: '[B]  +',
		reducesWeaponsBy: '  ',
		fireCannons: '[C]  \r\n',
		launchMissile: '[M]  \r\n',
		launchNuke: "[N]  8099",
		foodBonusTitle: "",
		foodMilestoneTitle: "",
		scienceBonusTitle: "",
		scienceMilestoneTitle: "",
		cultureBonusTitle: "",
		cultureMilestoneTitle: "",
		troopFlex: "",
		currentYear: "",
		energyWrap: "",
		foodWrap: "",
		scienceWrap: "",
		cultureWrap: "",
		generalWrap: "",
		tacticianWrap: "",
		energyTimerBase: "",
		hideUi: "[V] ",
		toggleFlags: "",
		hotkeys: "",
		gameOptions: "[ESC] ",
		surrender: "",
		exitSpectate: "",
		uninhabited: "",
		barbarianTribe: "",
		Despotism: [
			'',
			'',
			'',
			'2',
		],
		Monarchy: [
			'+2',
			'2+1',
			'50',
			'+2',
		],
		Democracy: [
			'4',
			'3',
			'50',
			'',
		],
		Fundamentalism: [
			'4',
			'-1',
			'',
			'+2',
		],
		Fascism: [
			'+1',
			'+1',
			'+4',
			'',
		],
		Republic: [
			'+1',
			'50',
			'',
			'50',
		],
		Communism: [
			'',
			'4+1',
			'',
			'2',
		],
		removeCPU: '',
		addCPU: '',
		lobbyRankedMatch: '',
		lobbyGameNameLabel: '',
		lobbyGamePasswordLabel: '',
		lobbyGameModeLabel: '',
		lobbyGameMapLabel: '',
		lobbyMaxPlayersLabel: '',
		startGame: '',
		cancelGame: '',
		setNationName: '',
		submitNationName: '',
		setNationFlag: '',
		leaderboardRankedBtn: '',
		leaderboardFfaBtn: '',
		leaderboardTeamBtn: '',
		playNowBtn: '',
		create: '',
		createTeamBtn: '',
		joinPrivateGameBtn: '',
		createRankedBtn: '',
		joinRankedGame: '',
		toggleNation: '',
		leaderboardBtn: '',
		gameTableName: '',
		gameTableMap: '',
		gameTableType: '',
		friendStatus: '',
		addFriend: '',
		ignoreStatus: '',
		ignoreUser: '',
		whoAccount: '',
		whisperAccount: '',
		changeChannel: '',
		getHelp: '',
		howToPlay: '',
		brokenNet: ' Broken.net!',
		optionsHeader: '',
		musicVolume: '',
		soundVolume: '',
		bibleMode: '',
		windowSize: '',
		currentWindowSize: '',
		windowFullScreen: '',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: '',
		versionSpan: ' ',
		foodMilestoneLabel: '',
		scienceMilestoneLabel: '',
		cultureMilestoneLabel: '',
	},
	turkish: {
		resetGame: 'Oyunu Sfrla',
		updateNationBtn: 'Tamam',
		playerColor: 'Oyuncu Rengi',
		team: 'Takm',
		damage: ' hasar',
		hudAttack: 'saldr: Hedef se',
		hudSplitAttack: 'Blnm Saldr: Hedef se',
		hudFireCannons: 'Ate toplar',
		hudLaunchMissile: 'Fze Balat',
		hudLaunchNuke: 'Nkleer Bomba Balat',
		resourceUiWidth: '28rem',
		selectTarget: 'Hedef se',
		reserveLabel: 'Rezerv',
		troopsLabel: 'Asker',
		youHaveJoined: 'Oyuna katldnz: ',
		startingGame: "Oyun balatlyor ",
		to: 'iin ',
		whispers: ' fsldyor ',
		joinedChannel: "Kanala katldk: ",
		selectTeam: 'Takm Se',
		selectPlayerColor: 'Oyuncu Rengi Se',
		difficulties: {
			'Very Easy': 'ok kolay',
			Easy: 'Kolay',
			Normal: 'Normal',
			Hard: 'Zor',
			'Very Hard': 'ok zor',
			Mania: 'Cinnet',
			Juggernaut: 'nne gelen her eyi ykan g'
		},
		governments: {
			Despotism: 'Despotluk',
			Monarchy: 'Monari',
			Democracy: 'Demokrasi',
			Fundamentalism: 'Ar tutuculuk',
			Fascism: 'Faizm',
			Republic: 'Cumhuriyet',
			Communism: 'Komnizm',
			Random: 'Rasgele'
		},
		random: 'Random',
		abAttack: "Saldr",
		abSplitAttack: "Blnm Saldr",
		abDeploy: "Askerleri dat",
		abRush: "Acele asker",
		abBuild: "na etmek",
		abCannons: "Ate toplar",
		abMissile: "Fze Balat",
		abNuke: "Nkleer Bomba Balat",
		abResearch: "Aratrma",
		abMasonry: "Duvarclk",
		abConstruction: "naat",
		abEngineering: "Mhendislik",
		abGunpowder: "Barut",
		abRocketry: "Fze bilimi",
		abAtomic: "Atomik teori",
		abFuture: "Gelecek Teknoloji",
		hostLeft: "Ev sahibi lobiden ayrld.",
		needTwoPlayers: "Oyuna balamak iin iki oyuncuya ihtiyacn var! Oyuna balamak iin oyuncularn katlmasn veya bir bilgisayar oyuncusu eklemesini bekleyin.",
		failedToLoad: "Oyun verileri yklenemedi.",
		flagChanged: "lkenizin bayra imdi: ",
		rankedSearch: "Sral oyunlar aranyor ...",
		noRankedFound: "Sral oyun bulunamad!<br>Bunun yerine sral bir oyun oluturmay deneyin.",
		notScience: "Yeterli bilim yok!",
		needTwoUnits: "Hareket etmek veya saldrmak iin en az 2 askere ihtiyacnz var!",
		maxUnits: "Bu blgede maksimum sayda birim var!",
		friendlyFire: "Dost atei! Bu senin takm arkadan!",
		notEnoughEnergy: 'Yeterli enerji yok!',
		notYourTile: 'Bu karoya sahip deilsin.',
		noTroopsAvailable: "Datm iin asker yok!",
		badGameName: "Oyun ad en az 4-32 karakter olmaldr.",
		notEnoughPlayers: "Oyunun 2-8 oyuncu olmas gerekir.",
		newNationName: "Yeni ulusun ad: ",
		verifyingSteam: "Steam Kimlik Bilgilerini Dorulama ...",
		steamNotFound: "Steam alglanamyor. Ltfen Steam'i balatn ve tekrar deneyin!",
		logoutSuccess: "k baarl",
		logoutFailed: "k baarsz",
		ribbonTitle: ['',
			'Ulusal Sava Madalyas',
			'Taktik Nuke Tanma dl',
			'yi Davran dl',
			"Vatansever Hizmet eridi",
			'Sivil Hizmet eridi',//5
			'Bronz Meritorious Madalyas',
			'Bronz Hizmet Madalyas',
			'Bronz Seferi Madalyas',
			'Bronz apraz',
			'Gm ha',//10
			'Altn ha',
			'Platin apraz',
			'Devrimci Sebep dl',
			'Stratejik Sava dl',
			'Sava Hizmet dl', //15
			'Sava Gallantry dl',
			"Stalwart Conqueror'n Madalyas",
			"Diktatrn Klc",
			"Kral Regalia",
			"Archon'un lekleri",//20
			'lahi Antlama',
			"mparator'un Fascesine",
			"Kartal ubesi",
			"Yoldan Orak",
			'Altn Sefer Madalyas',//25
			'Altn Meritorious Madalyas',
			'Altn Servis Madalyas',
			"ampiyon Madalyas",
			"Fatih'in Madalyas",
			"Komutann Madalyas",//30
			"Cesur Kahramanlk dl",
			'Kresel Sava Seferi Madalyas',
			'Gm Sefer Madalyas',
			'Gm Meritorious Madalyas',
			'Gm Servis Madalyas',//35
			"Mhendisin Servis eridi",
		],
		ribbonDescription: ['', // 0
			'Ulusunu kurdu',
			'Nkleer silahl bir kaleyi yok etti',
			'Arkada listene iki yolda ekle',
			'Ulusal bayran gncelledi',
			"lkenizin adn gncellendi",//5
			'10 sral oyunlar kazanld',
			'10 takm oyununu kazandm',
			'Tm oyunlar iin 10 bedava kazanld',
			'Elde edilen 1800+ deerlendirme',
			'Elde edilen 2100+ deerlendirme',//10
			'Elde edilen 2400+ deerlendirme',
			'Elde edilen 2700+ deerlendirme',
			'Byk Devrimci, 100+ birimle bir ini fethetti', //13
			'2 ile 1 arasnda ldrme oranyla oyun kazann',
			'st ste 10 oyun kazanld', // 15
			'st ste 25 oyun kazanld',
			'Bir kale ile bir kiremit fethetti',// 17
			"Despotizm altnda bir oyun kazand",
			'Monari olarak bir oyun kazand',
			'Demokrasi olarak bir oyun kazand',//20
			'Temelcilik altnda bir oyun kazand',
			'Faizmin altnda bir oyun kazand',
			'Cumhuriyet olarak oyun kazanld',
			'Komnizm altnda bir oyun kazand',
			'Tm oyunlar iin bedava 500 kazanld',//25
			'500 sral oyunlar kazanld',
			'500 takm oyunu kazand',
			"Sral skor tablosunda en st srada # 10",
			"Sral skor tablosunda en stte 100 numara",
			"Sral skor tablosunda en st # 1000",//30
			"Juggernaut'u yendi",
			'Tm oyun iin 8 oyuncu cretsiz kazann',
			'Tm oyunlar iin 100 bedava kazanld',
			'100 sral oyunlar kazanld',
			'100 takm oyunu kazand',//35
			'Bir kale ina et',
		],
		gameNameNotValid: "Oyun ismi geerli deil!",
		congratulations: "Tebrik ederiz!",
		gameVictory: "Kresel tahakkm kampanyanz baarl oldu!",
		victory: "Zafer",
		armistice: "Mtareke!",
		gameArmistice: "Kampanya askya alnd!",
		ceaseFire: "Ate etmeyin",
		defeat: "Yenilgi!",
		gameDefeat: "Dnya hakimiyeti iin kampanyanz baarsz oldu!",
		concede: "Yenilgiyi kabul et",
		spectate: "Spectate",
		defeatIn: "Yenilgi ",
		statOverview: "Genel bak",
		statUnits: "Birimler",
		statStructures: "Yaplar",
		statWeapons: "Silahlar",
		statResources: "Kaynaklar",
		tabUnits: "Birimler",
		tabStructures: "Yaplar",
		tabWeapons: "Silahlar",
		tabResources: "Kaynaklar",
		tabTotalScore: "Toplam puan",
		tabEarned: "Kazanlan",
		tabDeployed: "Datlan",
		tabKilled: "ldrlen",
		tabLost: "Kayp",
		tabBunkers: "Bunker'lar",
		tabWalls: "Duvarlar",
		tabFortresses: "Kale",
		tabCannons: "Toplar",
		tabMissiles: "Fzeler",
		tabNukes: "Nkleer bombalar",
		tabEnergy: "Enerji",
		tabScience: "Bilim",
		tabFood: "Gda",
		tabCulture: "Kltr",
		gameDuration: "Oyun Sresi ",
		endGame: "Son Oyun",
		joinPrivateGameBtnConfirm: "Oyuna katlmak",
		createGameHead: "Tm Oyun in cretsiz",
		createRankedGameHead: "Sralama Oyunu",
		createGameNameLabel: "Oyun Ad",
		createGamePasswordLabel: "ifre (istee bal)",
		createGameMaxPlayerLabel: "Maksimum Oyuncular:",
		createGameMapLabel: "Harita",
		createGame: "Oyun olutur",
		createTeamGameHeadLabel: "Takm oyunu",
		noRankedGamesFound: "Sral oyun bulunamad!<br>Bunun yerine sral bir oyun oluturmay deneyin.",
		privateGameNameLabel: "Oyun Ad",
		privateGamePasswordLabel: "Parola",
		confirmSurrenderPrompt: "Teslim? Emin misiniz?\n",
		canceSurrenderButtonCancel: "ptal etmek",
		surrenderButtonConfirm: "Teslim",
		hotkeyUi: "[V] Kullanc Arayzn Deitir",
		options: "[ESC] Seenekler",
		researchMasonry: "[Y] Bunker kilidini amak iin aratrma masonluu\r\n(20 saniye)",
		researchConstruction: "[O] Duvarlarn kilidini amak iin aratrma inaat\r\n(30 saniye)",
		researchEngineering: "[E] Kalenin kilidini amak iin aratrma mhendislii\r\n(45 saniye)",
		researchGunpowder: "[G] Silah kilidini amak iin aratrma barutu\r\n(25 saniye)",
		researchRocketry: "[K] Fzeleri amak iin aratrma roketry\r\n(40 saniye)",
		researchAtomicTheory: "[T] Nkleer silahlarn kilidini amak iin atomik teori aratrma\r\n(60 saniye)",
		researchFutureTech: "[F] Gelecekteki teknolojiyi aratrn\r\n(90 saniye)",
		attack: "[A] Tm birliklere saldr",
		splitAttack: "[S] Askerlerinizin yarsna saldr",
		deploy: "[D] Yedek birlikleri bir demeye dat",
		rush: "[R] Askerlerinizden acele et. Kltr bonusu ile artrld ",
		defenseLabel: ['Snak', 'Duvar', 'Kale'],
		boostsTileDefenses: '[B] Fayans savunmasn glendirir +',
		reducesWeaponsBy: ' ve silah hasarn azaltr ',
		fireCannons: '[C] Bitiik bir kiremitte ate toplar. Byk generaller tarafndan desteklendi.\r\n',
		launchMissile: '[M] Herhangi bir blgede bir fze frlatn. Byk generaller tarafndan desteklendi.\r\n',
		launchNuke: "[N] Herhangi bir blgede nkleer silah frlatn. Askerlerin% 80-99'unu ldrr ve tm yaplar yok eder.",
		foodBonusTitle: "Yemek Bonusu",
		foodMilestoneTitle: "Gda kilometre talar yedek birlikler retir.",
		scienceBonusTitle: "Bilim Bonusu",
		scienceMilestoneTitle: "Bilim yaplar, yangn silahlarn ve aratrma teknolojisini ina etmek iin kullanlr.",
		cultureBonusTitle: "Kltr Bonusu",
		cultureMilestoneTitle: "Kltr kilometre talar zel dller retir.",
		troopFlex: "Askerleri fethedilen blgelere datmak",
		currentYear: "Bu yl geerli!",
		energyWrap: "Enerji, birliklere saldrmak, tamak, konulandrmak ve acele etmek iin kullanlr.",
		foodWrap: "Gda kilometre talar yedek birlikler retir",
		scienceWrap: "Bilim yaplar, silahlar ve aratrma teknolojisini ina etmek iin kullanlr.",
		cultureWrap: "Kltr kilometre talar zel dller retir",
		generalWrap: "Byk generaller asker saldrsn hzlandrd",
		tacticianWrap: "Byk taktikiler asker savunma savunmak",
		energyTimerBase: "Kaynaklar her dnn sonunda gncellenir.",
		hideUi: "[V] Kullanc Arayzn Gizle",
		toggleFlags: "Bayraklar Deitir",
		hotkeys: "Ksayol tular",
		gameOptions: "[ESC] Seenekler",
		surrender: "Teslim",
		exitSpectate: "k Spectate",
		uninhabited: "Issz",
		barbarianTribe: "Barbar kabilesi",
		Despotism: [
			'Kendi inileri ile serbest hareket',
			'Barut ile bala',
			'Bir snakla bala',
			'2x maksimum ordu saldr boyutu',
		],
		Monarchy: [
			'+2 savunma',
			'2 yemek +1 kltr',
			'% 50 balang kltr bonusu',
			'+2 top hasar',
		],
		Democracy: [
			'4x maksimum asker datm',
			'Bir demeyi kaybettiinde +3 yedek birlii',
			'% 50 balayan bilim bonusu',
			'Azaltlm kltr kilometre ta gereklilii',
		],
		Fundamentalism: [
			'Tama: 4x avantaj ile annda kazan',
			'Szma: -1 yap savunmas',
			'Hzl byme: Azaltlm gda kilometre ta gereklilii',
			'+2 asker dl bonusu',
		],
		Fascism: [
			'+1 saldr',
			'Her savunma yaps iin fayanstan +1 saldr',
			'Barbarlar vs + 4 saldr',
			'Her datmda bonus birlii',
		],
		Republic: [
			'+1 enerji',
			'Sava salk grevlileri zafere kar% 50 asker toplar',
			'Duvardan bala',
			'Barbarlardan +% 50 yama dl bonusu',
		],
		Communism: [
			'Harika biriyle bala',
			'4 gdadan +1 bilim',
			'Askerleri ssz blgelere databilir',
			'Barbarlardan 2x keif dl bonusu',
		],
		removeCPU: 'Bilgisayar Kaldr',
		addCPU: 'Bilgisayar ekle',
		lobbyRankedMatch: 'Dereceli ma',
		lobbyGameNameLabel: 'Oyun Ad',
		lobbyGamePasswordLabel: 'Parola',
		lobbyGameModeLabel: 'Oyun modu',
		lobbyGameMapLabel: 'Harita',
		lobbyMaxPlayersLabel: 'Maksimum oyuncu',
		startGame: 'Oyunu balatmak',
		cancelGame: 'k',
		setNationName: 'Ulus ad',
		submitNationName: 'Nation Adn Gncelle',
		setNationFlag: 'Ulusal Bayrak',
		leaderboardRankedBtn: 'srada',
		leaderboardFfaBtn: 'Herkes tek',
		leaderboardTeamBtn: 'Takm',
		playNowBtn: 'imdi oyna',
		create: 'Herkes tek',
		createTeamBtn: 'Takm oyunu',
		joinPrivateGameBtn: 'zel Oyuna Katl',
		createRankedBtn: 'Benzer Elemeyi Oluturun',
		joinRankedGame: 'Benzer Elemeye Katl',
		toggleNation: 'Ulus yaplandr',
		leaderboardBtn: 'Liderler Sralamas',
		gameTableName: 'Oyun Ad',
		gameTableMap: 'Harita',
		gameTableType: 'tip',
		friendStatus: 'Arkada Listesini Gster',
		addFriend: 'Arkadan Deitir',
		ignoreStatus: 'Yoksaylanlar Gster',
		ignoreUser: 'Hesab Yoksay',
		whoAccount: 'Sorgu Hesab',
		whisperAccount: 'zel mesaj',
		changeChannel: 'Kanal deitir',
		getHelp: 'Sohbet Komutlar',
		howToPlay: 'Nasl oynanr',
		brokenNet: 'Hogeldiniz Broken.net!',
		optionsHeader: 'Seenekler',
		musicVolume: 'Mzik sesi',
		soundVolume: 'Ses efekti ses',
		bibleMode: 'ncil modu',
		windowSize: 'Pencere boyutu',
		currentWindowSize: 'Tam ekran',
		windowFullScreen: 'Tam ekran',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: 'Oyundan k',
		versionSpan: 'Versiyon ',
		foodMilestoneLabel: 'Gda',
		scienceMilestoneLabel: 'Bilim',
		cultureMilestoneLabel: 'Kltr',
	},
	polish: {
		resetGame: 'Zresetuj Gr',
		updateNationBtn: 'Gotowe',
		playerColor: 'Kolor gracza',
		team: 'Zesp',
		damage: ' uszkodzi',
		hudAttack: 'Atak: Wybierz cel',
		hudSplitAttack: 'Rozdziela Atak: Wybierz cel',
		hudFireCannons: 'Ogniowe dziaa',
		hudLaunchMissile: 'Uruchom pocisk',
		hudLaunchNuke: 'Uruchom bomb jdrow',
		resourceUiWidth: '28rem',
		selectTarget: 'Wybierz cel',
		reserveLabel: 'Rezerwowa',
		troopsLabel: 'Wojsko',
		youHaveJoined: 'Wstpie do gry: ',
		startingGame: "Rozpoczcie gry w ",
		to: 'Do ',
		whispers: ' szepty: ',
		joinedChannel: "Doczye kana: ",
		selectTeam: 'Wybierz druyn',
		selectPlayerColor: 'Wybierz Kolor odtwarzacza',
		difficulties: {
			'Very Easy': 'Bardzo atwe',
			Easy: 'atwo',
			Normal: 'Normalna',
			Hard: 'Ciko',
			'Very Hard': 'Bardzo trudny',
			Mania: 'Mania',
			Juggernaut: 'Juggernaut'
		},
		governments: {
			Despotism: 'Despotyzm',
			Monarchy: 'Monarchia',
			Democracy: 'Demokracja',
			Fundamentalism: 'Fundamentalizm',
			Fascism: 'Faszyzm',
			Republic: 'Republika',
			Communism: 'Komunizm',
			Random: 'Losowy'
		},
		random: 'Losowy',
		abAttack: "Atak",
		abSplitAttack: "Rozdziela Atak",
		abDeploy: "Rozmie oddziay",
		abRush: "Popiech Wojsko",
		abBuild: "Budowa",
		abCannons: "Ogniowe dziaa",
		abMissile: "Uruchom pocisk",
		abNuke: "Uruchom bomb jdrow",
		abResearch: "Badania",
		abMasonry: "Kamieniarstwo",
		abConstruction: "Budowa",
		abEngineering: "Inynieria",
		abGunpowder: "Proch strzelniczy",
		abRocketry: "Technika rakietowa",
		abAtomic: "Teoria atomowa",
		abFuture: "Przyszo Technologia",
		hostLeft: "Gospodarz opuci hol.",
		needTwoPlayers: "Aby rozpocz gr, potrzebujesz dwch graczy! Zaczekaj, a gracze docz lub dodaj odtwarzacz komputerowy, aby rozpocz.",
		failedToLoad: "Nie udao si wczyta danych gry.",
		flagChanged: "Flaga twojego narodu jest teraz: ",
		rankedSearch: "Wyszukiwanie gier rankingowych ...",
		noRankedFound: "Nie znaleziono gier rankingowych!<br>Sprbuj zamiast tego utworzy gr rankingow.",
		notScience: "Za mao nauki!",
		needTwoUnits: "Do przeniesienia lub ataku potrzeba co najmniej 2 onierzy!",
		maxUnits: "To terytorium ma maksymaln liczb jednostek!",
		friendlyFire: "Przyjazny ogie! To twj kolega z druyny!",
		notEnoughEnergy: 'Niewystarczajco energii!',
		notYourTile: 'Nie jeste wacicielem tego kafelka.',
		noTroopsAvailable: "Brak oddziaw do rozmieszczenia!",
		badGameName: "Nazwa gry musi skada si z co najmniej 4-32 znakw.",
		notEnoughPlayers: "Gra musi mie 2-8 graczy.",
		newNationName: "Twoja nowa nazwa to: ",
		verifyingSteam: "Weryfikuj powiadczenia Steam ...",
		steamNotFound: "Nie mona wykry Steam. Uruchom Steam i sprbuj ponownie!",
		logoutSuccess: "Wylogowanie zakoczone powodzeniem",
		logoutFailed: "Logout nie powid si",
		ribbonTitle: ['',
			'Krajowy Medal walki',
			'Nagroda Tactical Nuke Uznanie',
			'Nagroda za dobr kondycj',
			"Wstka subowa Patriota",
			'Wstka usugi obywatelskiej',//5
			'Brzowy Medal Zasuony',
			'Brzowy Medal za usug',
			'Brzowy Medal Ekspedycyjny',
			'Brzowy krzy',
			'Srebrny Krzy',//10
			'Zoty Krzy',
			'Krzy platynowy',
			'Rewolucyjna nagroda za przyczyn',
			'Nagroda Strategic Dziaania wojenne',
			'Nagroda za Walka Usuga', //15
			'Walka Galanteria Nagroda',
			"Medal Koronnego Zwycizcy",
			"Miecz dyktatora",
			"Regalia krla",
			"uski Archonta",//20
			'Boskie Przymierze',
			"Fasci Cesarza",
			"Oddzia Orze",
			"Sierp Towarzysza",
			'Zoty Medal Ekspedycyjny',//25
			'Zoty Zasuony Medal',
			'Zoty Medal za usug',
			"Medal Czempiona",
			"Medal Zdobywcy",
			"Medal dowdcy",//30
			"Nagroda Nieustraszonego Bohatera",
			'wiatowy Wojna Medal ekspedycyjny',
			'Srebro Medal ekspedycyjny',
			'Srebrny Medal Zasuony',
			'Srebrny Medal za usug',//35
			"Wstka serwisowa inyniera",
		],
		ribbonDescription: ['', // 0
			'Ustanowie swj nard',
			'Zniszcz fortec z broni nuklearn',
			'Dodano dwch towarzyszy do twojej listy znajomych',
			'Zaktualizowae swoj flag narodow',
			"Zaktualizowaem nazw twojego kraju",//5
			'Wygra 10 gier rankingowych',
			'Wygra 10 gier zespoowych',
			'Wygraem 10 za darmo dla wszystkich gier',
			'Uzyskano ocen 1800+',
			'Uzyskano ocen 2100+',//10
			'Uzyskano ocen 2400+',
			'Uzyskano ocen 2700+',
			'Great Revolutionary zdobyli dachwk z ponad 100 jednostkami', //13
			'Wygraj gr ze wspczynnikiem zabicia 2 do 1',
			'Wygra 10 gier z rzdu', // 15
			'Wygra 25 gier z rzdu',
			'Podbi dachwk z fortec',// 17
			"Wygra gr pod despotyzmem",
			'Wygra gr jako Monarchia',
			'Wygra gr jako Demokracja',//20
			'Wygra gr w ramach Fundamentalizmu',
			'Wygra gr pod faszyzmem',
			'Wygra gr jako Republika',
			'Wygra gr w komunizmie',
			'Wygra 500 za darmo dla wszystkich gier',//25
			'Wygra 500 gier rankingowych',
			'Wygra 500 gier zespoowych',
			"Uderz w gr # 10 na tablicy wynikw rankingu",
			"Uderz w gr # 100 na tablicy wynikw rankingu",
			"Uderzaj w gr # 1000 na tablicy wynikw rankingu",//30
			"Pokonaj Juggernaut",
			'Wygraj 8 graczy za darmo dla wszystkich gier',
			'Wygraem 100 za darmo we wszystkich grach',
			'Wygra 100 gier rankingowych',
			'Wygra 100 gier zespoowych',//35
			'Zbuduj fortec',
		],
		gameNameNotValid: "Nazwa gry jest nieprawidowa!",
		congratulations: "Gratulacje!",
		gameVictory: "Twoja kampania na globaln dominacj si udao!",
		victory: "Zwycistwo",
		armistice: "Zawieszenie broni!",
		gameArmistice: "Kampania zostaa zawieszona!",
		ceaseFire: "Zaprzesta ognia",
		defeat: "Pokona!",
		gameDefeat: "Twoja kampania na rzecz dominacji nad wiatem si nie udaa!",
		concede: "Przyzna Pokona",
		spectate: "spostrzega kadego",
		defeatIn: "Pokonaj w ",
		statOverview: "Przegld",
		statUnits: "Jednostki",
		statStructures: "Struktury",
		statWeapons: "Bronie",
		statResources: "Zasoby",
		tabUnits: "Jednostki",
		tabStructures: "Struktury",
		tabWeapons: "Bronie",
		tabResources: "Zasoby",
		tabTotalScore: "Cakowity wynik",
		tabEarned: "Zdobyte",
		tabDeployed: "Wdroone",
		tabKilled: "Zabity",
		tabLost: "Stracony",
		tabBunkers: "Bunkry",
		tabWalls: "ciany",
		tabFortresses: "Fortece",
		tabCannons: "Armaty",
		tabMissiles: "Pociski",
		tabNukes: "Bomby atomowe",
		tabEnergy: "Energia",
		tabScience: "Nauka",
		tabFood: "jedzenie",
		tabCulture: "Kultura",
		gameDuration: "Czas trwania gry ",
		endGame: "Koniec gry",
		joinPrivateGameBtnConfirm: "Docz do gry",
		createGameHead: "Darmowe gry dla wszystkich",
		createRankedGameHead: "Gra rankingowa",
		createGameNameLabel: "Nazwa gry",
		createGamePasswordLabel: "Haso (opcjonalnie)",
		createGameMaxPlayerLabel: "Maksymalna liczba graczy:",
		createGameMapLabel: "Mapa",
		createGame: "Tworzy gr",
		createTeamGameHeadLabel: "Gra zespoowa",
		noRankedGamesFound: "Nie znaleziono gier rankingowych!<br>Sprbuj zamiast tego utworzy gr rankingow.",
		privateGameNameLabel: "Nazwa gry",
		privateGamePasswordLabel: "Haso",
		confirmSurrenderPrompt: "Poddanie si? Jeste pewny?\n",
		canceSurrenderButtonCancel: "Anuluj",
		surrenderButtonConfirm: "Poddanie si",
		hotkeyUi: "[V] Przecz interfejs uytkownika",
		options: "[ESC] Opcje",
		researchMasonry: "[Y] Badaj mury, aby odblokowa bunkry\r\n(20 sekundy)",
		researchConstruction: "[O] Zbadaj konstrukcj, aby odblokowa ciany\r\n(30 sekundy)",
		researchEngineering: "[E] Inynieria badawcza, by odblokowa fortece\r\n(45 sekundy)",
		researchGunpowder: "[G] Zbadaj proch, by odblokowa dziaa\r\n(25 sekundy)",
		researchRocketry: "[K] Badaj rakiet, aby odblokowa pociski\r\n(40 sekundy)",
		researchAtomicTheory: "[T] Zbadaj teori atomow, aby odblokowa bro nuklearn\r\n(60 sekundy)",
		researchFutureTech: "[F] Badaj przysz technologi\r\n(90 sekundy)",
		attack: "[A] Atakuj ze wszystkimi onierzami",
		splitAttack: "[S] Atakuj z poow swoich onierzy",
		deploy: "[D] Rozmie oddziay rezerwowe na kafelek",
		rush: "[R] Popiekaj onierzy ze swoich obywateli. Zwikszona dziki premii kultury ",
		defenseLabel: ['Bunkier', 'ciana', 'Twierdza'],
		boostsTileDefenses: '[B] Zwiksza obron pytek +',
		reducesWeaponsBy: ' i zmniejsza obraenia broni o ',
		fireCannons: '[C] Dziaa ogniowe na ssiedniej pytce. Wzmocniony przez wielkich generaw.\r\n',
		launchMissile: '[M] Uruchom rakiet na dowolnym terytorium. Wzmocniony przez wielkich generaw.\r\n',
		launchNuke: "[N] Uruchom bro jdrow na dowolnym terytorium. Zabija 80-99% onierzy i niszczy wszystkie struktury.",
		foodBonusTitle: "Bonus ywnociowy",
		foodMilestoneTitle: "Kamienie milowe ywnoci wytwarzaj oddziay rezerwowe.",
		scienceBonusTitle: "Bonus naukowy",
		scienceMilestoneTitle: "Nauka suy budowaniu struktur, broni palnej i technologii badawczej.",
		cultureBonusTitle: "Bonus kulturowy",
		cultureMilestoneTitle: "Kamienie milowe kultury daj specjalne nagrody.",
		troopFlex: "Rozmie oddziay na podbite terytoria",
		currentYear: "To jest biecy rok!",
		energyWrap: "Energia suy do atakowania, przemieszczania, rozmieszczania i spieszenia onierzy.",
		foodWrap: "Kamienie milowe ywnoci wytwarzaj oddziay rezerwowe",
		scienceWrap: "Nauka suy budowaniu struktur, broni i technologii badawczej.",
		cultureWrap: "Kamienie milowe kultury daj specjalne nagrody",
		generalWrap: "Wielcy generaowie zwikszaj natarcie wojsk",
		tacticianWrap: "Wielcy Taktycy zwikszaj obron wojsk",
		energyTimerBase: "Aktualizacja zasobw pod koniec kadej tury.",
		hideUi: "[V] Ukryj interfejs uytkownika",
		toggleFlags: "Przecz flagi",
		hotkeys: "Skrty klawiszowe",
		gameOptions: "[ESC] Opcje",
		surrender: "Poddanie si",
		exitSpectate: "Wyjd z Spectate",
		uninhabited: "Bezludny",
		barbarianTribe: "Barbarzyskie plemi",
		Despotism: [
			'Swobodny przepyw przez wasne pytki',
			'Zacznij od prochu strzelniczego',
			'Zacznij od bunkra',
			'2x maksymalny rozmiar ataku armii',
		],
		Monarchy: [
			'+2 obrona',
			'+1 kultura z 2 pokarmw',
			'50% premii za kultur pocztkow',
			'+2 obraenia od armat',
		],
		Democracy: [
			'4x maksymalne rozmieszczenie wojsk',
			'+3 rezerwowe wojska, gdy stracisz dachwk',
			'50% pocztkowej premii naukowej',
			'Zredukowane wymagania dotyczce kamienia milowego',
		],
		Fundamentalism: [
			'Najecha: Natychmiastowa wygrana z przewag 4x',
			'Infiltracja: -1 obrona konstrukcji',
			'Szybki wzrost: Zredukowane zapotrzebowanie na kamie milowy',
			'+2 bonus od nagrody wojskowej',
		],
		Fascism: [
			'+1 atak',
			'+1 atak z kafli dla kadej struktury obronnej',
			'+4 atak kontra barbarzycy',
			'Oddzia bonusowy przy kadym wdroeniu',
		],
		Republic: [
			'+1 energia',
			'Bojowi medalici lecz 50% onierzy po zwycistwie',
			'Zacznij od muru',
			'+ 50% rabunku premii od barbarzycw',
		],
		Communism: [
			'Zacznij od wietnej osoby',
			'+1 nauka z 4 pokarmw',
			'Moe rozmieci oddziay na niezamieszkane terytorium',
			'2x odkry premi od barbarzycw',
		],
		removeCPU: 'Usu komputer',
		addCPU: 'Dodaj komputer',
		lobbyRankedMatch: 'Mecz rankingowy',
		lobbyGameNameLabel: 'Nazwa gry',
		lobbyGamePasswordLabel: 'Haso',
		lobbyGameModeLabel: 'Tryb gry',
		lobbyGameMapLabel: 'Mapa',
		lobbyMaxPlayersLabel: 'Maksimum graczy',
		startGame: 'Rozpocz gr',
		cancelGame: 'Wyjcie',
		setNationName: 'Nazwa narodu',
		submitNationName: 'Zaktualizuj nazw narodu',
		setNationFlag: 'Flaga narodowa',
		leaderboardRankedBtn: 'Miejsce',
		leaderboardFfaBtn: 'Darmowy dla wszystkich',
		leaderboardTeamBtn: 'Zesp',
		playNowBtn: 'Zagraj teraz',
		create: 'Darmowy dla wszystkich',
		createTeamBtn: 'Gra zespoowa',
		joinPrivateGameBtn: 'Docz do prywatnej gry',
		createRankedBtn: 'Utwrz dopasowanie rankingowe',
		joinRankedGame: 'Docz do meczu rankingowego',
		toggleNation: 'Skonfiguruj nard',
		leaderboardBtn: 'Tablica rekordw',
		gameTableName: 'Nazwa gry',
		gameTableMap: 'Mapa',
		gameTableType: 'Rodzaj',
		friendStatus: 'Poka list znajomych',
		addFriend: 'Przecz znajomego',
		ignoreStatus: 'Poka list ignorowanych',
		ignoreUser: 'Zignoruj konto',
		whoAccount: 'Konto zapytania',
		whisperAccount: 'Prywatna wiadomo',
		changeChannel: 'Zmie kana',
		getHelp: 'Polecenia czatu',
		howToPlay: 'Jak gra',
		brokenNet: 'Witamy w Broken.net!',
		optionsHeader: 'Opcje',
		musicVolume: 'Gono muzyki',
		soundVolume: 'Gono efektu dwikowego',
		bibleMode: 'Tryb biblijny',
		windowSize: 'Rozmiar okna',
		currentWindowSize: 'Peny ekran',
		windowFullScreen: 'Peny ekran',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: 'Wyjd z gry',
		versionSpan: 'Wersja ',
		foodMilestoneLabel: 'Jedzenie',
		scienceMilestoneLabel: 'Nauka',
		cultureMilestoneLabel: 'Kultura',
	},
	italian: {
		resetGame: 'Reimposta il Gioco',
		updateNationBtn: 'Fatto',
		playerColor: 'Colore del giocatore',
		team: 'Squadra',
		damage: ' danno',
		hudAttack: 'Attacco: Seleziona Target',
		hudSplitAttack: 'Attacco Diviso: Seleziona Target',
		hudFireCannons: 'Cannoni antincendio',
		hudLaunchMissile: 'Lancio del missile',
		hudLaunchNuke: 'Lancio della bomba nucleare',
		resourceUiWidth: '28rem',
		selectTarget: 'Seleziona Target',
		reserveLabel: 'Riserva',
		troopsLabel: 'Truppe',
		youHaveJoined: 'Ti sei iscritto al gioco: ',
		startingGame: "Iniziare il gioco in ",
		to: 'A ',
		whispers: ' sussurra ',
		joinedChannel: "Hai aderito al canale: ",
		selectTeam: 'Selezionare squadra',
		selectPlayerColor: 'Seleziona Colore giocatore',
		difficulties: {
			'Very Easy': 'Molto facile',
			Easy: 'Facile',
			Normal: 'Normale',
			Hard: 'Difficile',
			'Very Hard': 'Molto difficile',
			Mania: 'Mania',
			Juggernaut: 'Juggernaut'
		},
		governments: {
			Despotism: 'Dispotismo',
			Monarchy: 'Monarchia',
			Democracy: 'Democrazia',
			Fundamentalism: 'Fondamentalismo',
			Fascism: 'Fascismo',
			Republic: 'Repubblica',
			Communism: 'Comunismo',
			Random: 'Casuale'
		},
		random: 'Casuale',
		abAttack: "Attacco",
		abSplitAttack: "Attacco Diviso",
		abDeploy: "Distribuisci le truppe",
		abRush: "Corsa le truppe",
		abBuild: "Costruire",
		abCannons: "Cannoni antincendio",
		abMissile: "Lancio del missile",
		abNuke: "Lancio della bomba nucleare",
		abResearch: "Ricerca",
		abMasonry: "Opere murarie",
		abConstruction: "Costruzione",
		abEngineering: "Ingegneria",
		abGunpowder: "Polvere da sparo",
		abRocketry: "Missilistica",
		abAtomic: "Teoria atomica",
		abFuture: "Tecnologia del futuro",
		hostLeft: "L'host ha lasciato la lobby.",
		needTwoPlayers: "Hai bisogno di due giocatori per iniziare una partita! Attendi che i giocatori si uniscano o aggiungano un giocatore di computer per iniziare.",
		failedToLoad: "Impossibile caricare i dati di gioco.",
		flagChanged: "La bandiera della tua nazione  ora: ",
		rankedSearch: "Ricerca di giochi classificati ...",
		noRankedFound: "Nessun gioco classificato!<br>Prova invece a creare un gioco classificato.",
		notScience: "Non abbastanza scienza!",
		needTwoUnits: "Hai bisogno di almeno 2 truppe per muoverti o attaccare!",
		maxUnits: "Quel territorio ha il numero massimo di unit!",
		friendlyFire: "Fuoco amico! Questo  il tuo compagno di squadra!",
		notEnoughEnergy: 'Non abbastanza energia!',
		notYourTile: 'Non possiedi quella tessera.',
		noTroopsAvailable: "Nessuna truppa disponibile per la distribuzione!",
		badGameName: "Il nome del gioco deve essere di almeno 4-32 caratteri.",
		notEnoughPlayers: "Il gioco deve avere 2-8 giocatori.",
		newNationName: "Il tuo nuovo nome di nazione : ",
		verifyingSteam: "Verifica delle credenziali di Steam ...",
		steamNotFound: "Impossibile rilevare Steam. Si prega di avviare Steam e riprovare!",
		logoutSuccess: "Logout riuscito",
		logoutFailed: "Logout fallito",
		ribbonTitle: ['',
			'Medaglia nazionale di combattimento',
			'Tactical Recke Award',
			'Premio di buona condotta',
			"Nastro di servizio del patriota",
			'Nastro di servizio civile',//5
			'Medaglia meritoria in bronzo',
			'Medaglia di bronzo',
			'Medaglia di spedizione in bronzo',
			'Croce di bronzo',
			"Croce d'argento",//10
			"Croce d'oro",
			'Croce di platino',
			'Premio causa rivoluzionaria',
			'Premio strategico di guerra',
			'Premio per il servizio di combattimento', //15
			'Premio per la lotta alla galanteria',
			"La potente medaglia conquistatrice",
			"Spada del dittatore",
			"Re's Regalia",
			"Scale di Archon",//20
			'Patto Divino',
			"Figli dell'Imperatore",
			"Ramo dell'aquila",
			"Falce del compagno",
			"Medaglia d'oro per spedizione",//25
			"Medaglia d'oro meritoria",
			"Medaglia d'oro del servizio",
			"La medaglia del campione",
			"Medaglia del conquistatore",
			"Medaglia del comandante",//30
			"Premio di eroismo intrepido",
			'Medaglia di spedizione della guerra globale',
			"Medaglia di spedizione d'argento",
			"Medaglia d'argento meritoria",
			"Medaglia d'argento al servizio",//35
			"Nastro di servizio tecnico",
		],
		ribbonDescription: ['', // 0
			'Stabilito la tua nazione',
			"Distrutto una fortezza con un'arma nucleare",
			'Aggiunti due compagni alla tua lista amici',
			'Aggiornata la tua bandiera nazionale',
			"Aggiornato il nome della tua nazione",//5
			'Ha vinto 10 giochi classificati',
			'Ha vinto 10 giochi di squadra',
			'Ha vinto 10 gratis per tutti i giochi',
			'Ottenuto una valutazione di 1800+',
			'Raggiunto il punteggio di 2100+',//10
			'Raggiunto il punteggio di 2400+',
			'Ottenuto una valutazione di 2700+',
			'Great Revolutionary ha conquistato una tessera con oltre 100 unit', //13
			'Vinci una partita con un rapporto di uccisione 2-a-1',
			'Ha vinto 10 partite di fila', // 15
			'Ha vinto 25 partite di fila',
			'Conquistato una tessera con una fortezza',// 17
			"Ha vinto un gioco sotto il dispotismo",
			'Ha vinto un gioco come una monarchia',
			'Ha vinto un gioco come una democrazia',//20
			'Ha vinto una partita sotto il fondamentalismo',
			'Ha vinto una partita sotto il fascismo',
			'Ha vinto un gioco come Repubblica',
			'Ha vinto una partita sotto il comunismo',
			'Hai vinto 500 gratis per tutti i giochi',//25
			'Hai vinto 500 partite classificate',
			'Ha vinto 500 giochi di squadra',
			"Hit top 10 nella classifica classificata",
			"Hit top 100 nella classifica classificata",
			"Hit top # 1000 nella classifica classificata",//30
			"Sconfitto il Juggernaut",
			'Vinci un 8 giocatori gratis per tutti i giochi',
			'Ha vinto 100 gratis per tutti i giochi',
			'Ha vinto 100 giochi classificati',
			'Won 100 team gamesHa vinto 100 giochi di squadra',//35
			'Costruisci una fortezza',
		],
		gameNameNotValid: "Il nome del gioco non  valido!",
		congratulations: "Complimenti!",
		gameVictory: "La tua campagna per il dominio globale  riuscita!",
		victory: "Vittoria",
		armistice: "Armistizio!",
		gameArmistice: "La campagna  stata sospesa!",
		ceaseFire: "Cessate il fuoco",
		defeat: "La sconfitta!",
		gameDefeat: "La tua campagna per il dominio del mondo ha fallito!",
		concede: "Concedere la sconfitta",
		spectate: "Spettare",
		defeatIn: "Sconfiggi dentro ",
		statOverview: "Panoramica",
		statUnits: "Unit",
		statStructures: "Strutture",
		statWeapons: "Armi",
		statResources: "Risorse",
		tabUnits: "Unit",
		tabStructures: "Strutture",
		tabWeapons: "Armi",
		tabResources: "Risorse",
		tabTotalScore: "Punteggio totale",
		tabEarned: "Guadagnato",
		tabDeployed: "Schierato",
		tabKilled: "Ucciso",
		tabLost: "Perduto",
		tabBunkers: "Bunkers",
		tabWalls: "Muri",
		tabFortresses: "Fortezze",
		tabCannons: "Cannoni",
		tabMissiles: "Missili",
		tabNukes: "Bombe nucleari",
		tabEnergy: "Energia",
		tabScience: "Scienza",
		tabFood: "Cibo",
		tabCulture: "Cultura",
		gameDuration: "Durata del gioco ",
		endGame: "Fine del gioco",
		joinPrivateGameBtnConfirm: "Unisciti al gioco",
		createGameHead: "Unisciti al gioco",
		createRankedGameHead: "Gioco classificato",
		createGameNameLabel: "Nome del gioco",
		createGamePasswordLabel: "Password (opzionale)",
		createGameMaxPlayerLabel: "Giocatori massimi:",
		createGameMapLabel: "Carta geografica",
		createGame: "Crea gioco",
		createTeamGameHeadLabel: "Gioco di squadra",
		noRankedGamesFound: "Nessun gioco classificato!<br>Prova invece a creare un gioco classificato.",
		privateGameNameLabel: "Nome del gioco",
		privateGamePasswordLabel: "Parola d'ordine",
		confirmSurrenderPrompt: "Resa? Sei sicuro?",
		canceSurrenderButtonCancel: "Annulla",
		surrenderButtonConfirm: "Resa",
		hotkeyUi: "[V] Attiva l'interfaccia utente",
		options: "[ESC] Opzioni",
		researchMasonry: "[Y] Ricerca in muratura per sbloccare bunker\r\n(20 secondi)",
		researchConstruction: "[O] Ricerca costruzione per sbloccare i muri\r\n(30 secondi)",
		researchEngineering: "[E] Ingegneria della ricerca per sbloccare le fortezze\r\n(45 secondi)",
		researchGunpowder: "[G] Cerca la polvere da sparo per sbloccare i cannoni\r\n(25 secondi)",
		researchRocketry: "[K] Ricerca missilistica per sbloccare i missili\r\n(40 secondi)",
		researchAtomicTheory: "[T] Ricerca teoria atomica per sbloccare armi nucleari\r\n(60 secondi)",
		researchFutureTech: "[F] Ricerca tecnologia futura\r\n(90 secondi)",
		attack: "[A] Attacca con tutte le truppe",
		splitAttack: "[S] Attacca con met delle tue truppe",
		deploy: "[D] Distribuisci truppe di riserva su una tessera",
		rush: "[R] Prendi le truppe dalla tua cittadinanza. Promosso dal bonus culturale ",
		defenseLabel: ['Bunker', 'Parete', 'Fortezza'],
		boostsTileDefenses: '[B] Aumenta le difese delle tessere +',
		reducesWeaponsBy: " e riduce i danni dell'arma di ",
		fireCannons: '[C] Cannoni da fuoco in una tessera adiacente. Spinta dai grandi generali.\r\n',
		launchMissile: '[M] Lancio di un missile su qualsiasi territorio. Spinta dai grandi generali.\r\n',
		launchNuke: "[N] Lanciare un'arma nucleare su qualsiasi territorio. Uccide l'80-99% delle truppe e distrugge tutte le strutture.",
		foodBonusTitle: "Bonus alimentare",
		foodMilestoneTitle: "Le pietre miliari del cibo producono truppe di riserva.",
		scienceBonusTitle: "Bonus scientifico",
		scienceMilestoneTitle: "La scienza viene utilizzata per costruire strutture, armi da fuoco e tecnologia di ricerca.",
		cultureBonusTitle: "Bonus culturale",
		cultureMilestoneTitle: "Le tappe della cultura producono premi speciali.",
		troopFlex: "Dispiega le truppe nei territori conquistati",
		currentYear: " l'anno in corso!",
		energyWrap: "L'energia  usata per attaccare, spostare, schierare e precipitare le truppe.",
		foodWrap: "Le pietre miliari del cibo producono truppe di riserva",
		scienceWrap: "La scienza viene utilizzata per costruire strutture, armi e tecnologia di ricerca.",
		cultureWrap: "Le tappe della cultura producono premi speciali",
		generalWrap: "I grandi generali potenziano l'attacco delle truppe",
		tacticianWrap: "I grandi tattici potenziano la difesa delle truppe",
		energyTimerBase: "Aggiornamento delle risorse alla fine di ogni turno.",
		hideUi: "[V] Nascondi interfaccia utente",
		toggleFlags: "Attiva / disattiva le bandiere",
		hotkeys: "Tasti di scelta rapida",
		gameOptions: "[ESC] Opzioni",
		surrender: "Resa",
		exitSpectate: "Esci Spectate",
		uninhabited: "Disabitato",
		barbarianTribe: "Trib dei barbari",
		Despotism: [
			'Libert di movimento attraverso le proprie tessere',
			'Inizia con polvere da sparo',
			'Inizia con un bunker',
			'2x dimensioni massime di attacco dell\'esercito',
		],
		Monarchy: [
			'+2 difesa',
			'+1 cultura da 2 cibo',
			'50% di bonus alla cultura iniziale',
			'+2 danni al cannone',
		],
		Democracy: [
			'4x massima dispiegamento di truppe',
			'+3 riserva le truppe quando perdi una tessera',
			'50% di bonus scientifici iniziali',
			'Requisito pietra miliare cultura ridotta',
		],
		Fundamentalism: [
			'Invadere: Vittoria istantanea con 4x vantaggio',
			'Infiltrazione: -1 difesa della struttura',
			'Crescita rapida: Requisito pietra miliare di cibo ridotto',
			'+2 bonus ricompensa truppa',
		],
		Fascism: [
			'+1 attacco',
			'+1 attacco da tessere per ogni struttura difensiva',
			'+4 attacco vs barbari',
			'Truppa bonus con ogni schieramento',
		],
		Republic: [
			'+1 energia',
			'I medici combattenti curano il 50% delle truppe alla vittoria',
			'Inizia con la muratura',
			'+ 50% di bonus per i saccheggi da parte dei barbari',
		],
		Communism: [
			'Inizia con una grande persona',
			'+1 scienza da 4 cibo',
			'Pu schierare truppe in territori disabitati',
			'2x bonus premio scoperto dai barbari',
		],
		removeCPU: 'Rimuovi computer',
		addCPU: 'Aggiungi computer',
		lobbyRankedMatch: 'Partita classificata',
		lobbyGameNameLabel: 'Nome del gioco',
		lobbyGamePasswordLabel: "Parola d'ordine",
		lobbyGameModeLabel: 'Modalit di gioco',
		lobbyGameMapLabel: 'Carta geografica',
		lobbyMaxPlayersLabel: 'Giocatori massimi',
		startGame: 'Inizia il gioco',
		cancelGame: 'Uscita',
		setNationName: 'Nome Nazione',
		submitNationName: 'Aggiorna nome nazione',
		setNationFlag: 'Bandiera nazionale',
		leaderboardRankedBtn: 'Classifica',
		leaderboardFfaBtn: 'Gratuito per tutti',
		leaderboardTeamBtn: 'Squadra',
		playNowBtn: 'Riproduci ora',
		create: 'Gratuito per tutti',
		createTeamBtn: 'Gioco di squadra',
		joinPrivateGameBtn: 'Partecipa al gioco privato',
		createRankedBtn: 'Crea una partita classificata',
		joinRankedGame: 'Partecipa alla partita classificata',
		toggleNation: 'Configura nazione',
		leaderboardBtn: 'Classifica',
		gameTableName: 'Nome del gioco',
		gameTableMap: 'Carta geografica',
		gameTableType: 'Genere',
		friendStatus: 'Mostra elenco amici',
		addFriend: 'Attiva amico',
		ignoreStatus: 'Mostra elenco ignora',
		ignoreUser: 'Ignora account',
		whoAccount: 'Account di query',
		whisperAccount: 'Messaggio privato',
		changeChannel: 'Cambia canale',
		getHelp: 'Comandi di chat',
		howToPlay: 'Come giocare',
		brokenNet: 'Benvenuto a Broken.net!',
		optionsHeader: 'Opzioni',
		musicVolume: 'Volume della musica',
		soundVolume: "Volume dell'effetto sonoro",
		bibleMode: 'Modalit Bibbia',
		windowSize: 'Dimensione della finestra',
		currentWindowSize: 'A schermo intero',
		windowFullScreen: 'A schermo intero',
		window19201080: '1920 x 1080',
		window1600900: '1600 x 900',
		window1360768: '1360 x 768',
		window1280720: '1280 x 720',
		exitGame: 'Esci dal gioco',
		versionSpan: 'Versione ',
		foodMilestoneLabel: 'Cibo',
		scienceMilestoneLabel: 'Scienza',
		cultureMilestoneLabel: 'Cultura',
	},
	alternateSupportedLanguages: [
		'russian', //1
		'schinese',
		'german',
		'portuguese',
		'brazilian',
		'spanish',
		'french',
		'koreana',
		'japanese',
		'turkish',
		'polish',
		'italian',
	],
	apiLanguageCode: [
		'arabic',
		'bulgarian',
		'schinese', //5
		'tchinese',
		'czech',
		'danish',
		'dutch',
		'finnish', //13
		'french', //4
		'german', //2
		'greek', //14
		'hungarian',
		'italian', //7
		'japanese', //12
		'koreana', //11
		'norwegian',
		'polish', //9
		'portuguese', //3
		'brazilian',
		'romanian',
		'russian', //1
		'spanish', //6
		'swedish',
		'thai',
		'turkish', //10
		'ukrainian', //8
	]
};
lang['brazilian'] = lang.portuguese;
// stats.js 
// scoreboard data values

(function(){
	// attempt auto login
	var isLoggedIn = $("#titleMenu").length;
	if (!isLoggedIn){
		var email = localStorage.getItem('email');
		var token = localStorage.getItem('token');
		if (email){
			// attempt persistent login
			if (token){
				$.ajax({
					type: 'POST',
					url: app.url + '/php/master1.php',
					data: {
						run: "authenticate",
						email: email,
						token: token
					}
				}).done(function(data){
					if (data === "Login successful!"){
						$.ajax({
							type: 'POST',
							url: app.url + '/php/master1.php',
							data: {
								run: "getToken",
								email: email
							}
						}).done(function(data){
							token = data;
							$.ajax({
								type: 'POST',
								url: app.url + '/php/master1.php',
								data: {
									run: "authenticate",
									email: email,
									token: token
								}
							}).done(function(data){
								console.info(data);
								localStorage.setItem('token', token);
								location.reload();
							}).fail(function(data){
								console.warn(data);
							});
						});
					} else {
						console.warn("Persistent login failed! ", data);
					}
				});
			} else {
				$.ajax({
					type: 'POST',
					url: app.url + '/php/master1.php',
					data: {
						run: "getToken",
						email: email
					}
				}).done(function(data){
					token = data;
				});
			}
		}
	}
})();

var stats = {
	init: function(data){
		var flag = my.flag,
			str = '<img id="statWorld" src="images/FlatWorld90.jpg">',
			kjv = bible.getRandomQuoteAndVerse();

		str +=
		'<div id="statResult" class="no-select">\
			<img class="statResultFlag" src="images/flags/'+ flag +'">\
			<span id="statGameResult">'+ lang[my.lang].defeatIn + ui.transformYear(g.resourceTick) +'</span>\
			<img class="statResultFlag" src="images/flags/'+ flag +'">\
		</div>\
		<div id="statTabWrap" class="no-select shadow4">\
			<div id="statOverview" class="statTabs active">\
				'+ lang[my.lang].statOverview +'\
			</div><div id="statUnits" class="statTabs">\
				'+ lang[my.lang].statUnits +'\
			</div><div id="statStructures" class="statTabs">\
				'+ lang[my.lang].statStructures +'\
			</div><div id="statWeapons" class="statTabs">\
				'+ lang[my.lang].statWeapons +'\
			</div><div id="statResources" class="statTabs">\
				'+ lang[my.lang].statResources +'\
			</div>\
		</div>\
		<table id="gameStatsTable" class="table"></table>\
		<div id="statFooter" class="container-fluid">\
			<div class="row">\
				<div id="statQuote" class="col-xs-7 shadow4 stagBlue">\
					<div id="muh-bible">'+ kjv.quote +'</div>\
					<div id="statVerse" class="text-right">'+ kjv.verse +'</div>\
				</div>\
				<div id="statDuration" class="col-xs-4 stagBlue text-center">\
					<div id="gameDuration">'+ lang[my.lang].gameDuration + stats.gameDuration(g.gameDuration) +'</div>\
					<button id="statsEndGame" class="btn btn-md btn-block btn-responsive shadow4 lobbyButtons">'+ lang[my.lang].endGame +'</button>\
				</div>\
			</div>\
		</div>\
		<div id="ribbonBackdrop"></div>\
		<div id="ribbonReward" class="fw-primary title-modals">\
			<div class="header text-center">\
				<h2 class="header">Achievement Unlocked!</h2>\
			</div>\
			<hr class="fancyhr">\
			<div id="ribbonBody"></div>\
		</div>';
		document.getElementById('statWrap').innerHTML = str;
		stats.events();
		animate.muhBible();
		TweenMax.to("#statWorld", 300, {
			startAt: {
				xPercent: -50,
				yPercent: -50,
				rotation: -360
			},
			rotation: 0,
			repeat: -1,
			ease: Linear.easeNone
		});
		stats.setLeaderValues();
	},
	setBibleMode: function(state) {
		var e = document.createElement('style');
		e.id = 'bible-state';
		e.type = 'text/css';
		e.innerHTML = '#statQuote { visibility: visible!important }';

		if (!state) {
			e.innerHTML = '#statQuote { visibility: hidden }';
		}
		$("#bible-state").remove();
		document.head.appendChild(e);
		localStorage.setItem('bible', state ? 1 : 0);
	},
	show: function(){
		DOM.bgmusic.loop = true;
		stats.setView('statOverview');
		if (g.victory){
			audio.play('bell-8');
			audio.play('TheAssault', 1);
			document.getElementById('statGameResult').textContent =
				"Victory in "+ ui.transformYear(g.resourceTick);
		}
		else {
			audio.play('defeat');
			audio.play("JourneyOfForgottenSoldiers", 1);
		}
		document.getElementById('statWrap').style.visibility = 'visible';
		TweenMax.to('#gameWrap', .5, {
			startAt: {
				alpha: 0
			},
			alpha: 1
		});
		if (stats.achievements.length){
			audio.play('ding3');
			TweenMax.to('#ribbonBackdrop', .5, {
				startAt: {
					visibility: 'visible',
					alpha: 0
				},
				alpha: 1
			});
			TweenMax.to('#ribbonReward', 1, {
				startAt: {
					visibility: 'visible',
					alpha: 0,
					top: 0,
					y: 0
				},
				alpha: 1,
				y: 30
			});
		}
		$("#worldWrap, #targetWrap, #ui2, #resources-ui, #diplomacy-ui, #chat-ui, #chat-input-open, #chat-input-wrap, #surrenderScreen").remove();
	},
	events: function(){
		$("#statWrap").on(ui.click, '.statTabs', function(){
			$(".statTabs").removeClass('active');
			$(this).addClass('active');
			audio.play('switch13');
			// load data
			var id = $(this).attr('id');
			stats.setView(id);
		}).on(ui.click, '#statsEndGame', function(){
			location.reload();
		}).on(ui.click, '#ribbonBackdrop', function(){
			TweenMax.to('#ribbonBackdrop, #ribbonReward', .25, {
				alpha: 0,
				onComplete: function(){
					TweenMax.set('#ribbonBackdrop, #ribbonReward', {
						visibility: 'hidden'
					});
				}
			});
		});
		
	},
	maxValue: {
		unitsTotal: 0,
		structuresTotal: 0,
		weaponsTotal: 0,
		resourcesTotal: 0,
		overviewTotal: 0
	},
	setLeaderValues: function(){
		for (var i=1; i<=8; i++){
			var d = stats.data[i];
			if (typeof d !== 'undefined' && d.account){
				for (var key in d){
					if (i === 1){
						stats.maxValue[key] = d[key];
					} else {
						if (d[key] > stats.maxValue[key]){
							stats.maxValue[key] = d[key];
						}
					}
				}
				var units = stats.unitsTotal(i),
					structures = stats.structuresTotal(i),
					weapons = stats.weaponsTotal(i),
					resources = stats.resourcesTotal(i),
					overview = stats.overviewTotal(i);
				
				if (units > stats.maxValue.unitsTotal){
					stats.maxValue.unitsTotal = stats.unitsTotal(i);
				}
				if (structures > stats.maxValue.structuresTotal){
					stats.maxValue.structuresTotal = structures;
				}
				if (weapons > stats.maxValue.weaponsTotal){
					stats.maxValue.weaponsTotal = weapons;
				}
				if (resources > stats.maxValue.resourcesTotal){
					stats.maxValue.resourcesTotal = resources;
				}
				if (overview > stats.maxValue.overviewTotal){
					stats.maxValue.overviewTotal = overview;
				}
			}
		}
	},
	currentTabId: '',
	setView: function(id){
		if (id !== stats.currentTabId){
			stats.currentTabId = id;
			var str = stats[id]();
			document.getElementById('gameStatsTable').innerHTML = str;
		}
	},
	barAnimate: new TweenMax.delayedCall(0, ''),
	animate: function(a, delay){
		setTimeout(function(){
			var x = {
				max: 100,
				lastVal: 0
			};
			stats.barAnimate.kill();
			stats.barAnimate = TweenMax.to(x, delay, {
				startAt: {
					max: 0
				},
				max: 100,
				onUpdate: function(){
					if (~~x.lastVal !== ~~x.max){
						x.lastVal = x.max;
						audio.play('rollover5');
					}
				},
				onComplete: function(){
					audio.play('switch11');
				},
				ease: Sine.easeOut
			});
			for (var i=1, len=a.length; i<len; i++){
				var d = a[i];
				(function(d, e, bar, Sine){
					TweenMax.to(d, delay, {
						startAt: {
							max: 0
						},
						max: d.max,
						onUpdate: function(){
							e.textContent = ~~d.max;
						},
						ease: Sine.easeOut
					});
					TweenMax.to(bar, delay, {
						startAt: {
							width: 0
						},
						width : ((d.max / stats.maxValue[d.key]) * 100) + '%',
						ease: Sine.easeOut
					});
				})(d, document.getElementById(d.id), document.getElementById(d.id + '-bar'), Sine);
			}
		});
	},
	statOverview: function(){
		// head
		var str = stats.playerHead([
			lang[my.lang].tabUnits,
			lang[my.lang].tabStructures,
			lang[my.lang].tabWeapons,
			lang[my.lang].tabResources,
			lang[my.lang].tabTotalScore
		]);
		// player rows
		var animate = [];
		for (var i=1; i<=8; i++){
			var d = stats.data[i];
			if (typeof stats.data[i] !== 'undefined' && stats.data[i].account){
				// player data exists
				var a = [{}, {
						id: 'p'+ i +'-units',
						max: stats.unitsTotal(i),
						key: 'unitsTotal'
					}, {
						id: 'p'+ i +'-structures',
						max: stats.structuresTotal(i),
						key: 'structuresTotal'
					}, {
						id: 'p'+ i +'-weapons',
						max: stats.weaponsTotal(i),
						key: 'weaponsTotal'
					}, {
						id: 'p'+ i +'-resources',
						max: stats.resourcesTotal(i),
						key: 'resourcesTotal'
					}, {
						id: 'p'+ i +'-total',
						max: stats.overviewTotal(i),
						key: 'overviewTotal'
					},
				]
				stats.animate(a, 1.5);
				str += '<tr class="statRow no-pointer">' +
					stats.playerCell(d, i);
					var color = game.player[i].playerColor,
						a = ['units', 'structures', 'weapons', 'resources', 'total'],
						len = a.length;
					for (var j=0; j<len; j++){
						var sumRow = (j+1 === len) ? ' statSum' : '';
						str += 
						'<td class="stagBlue statTD">\
							<div class="statBar pb'+ color +'">\
								<div id="p'+ i +'-'+ a[j] +'-bar" class="statBarBg pbar'+ color +'">&nbsp</div>\
								<div id="p'+ i +'-'+ a[j] +'" class="statVal'+ sumRow +'">0</div>\
							</div>\
						</td>';
					}
				str += '</tr>';
			}
		}
		return str;
	},
	statUnits: function(){
		// head
		var str = stats.playerHead([
			lang[my.lang].tabEarned,
			lang[my.lang].tabDeployed,
			lang[my.lang].tabKilled,
			lang[my.lang].tabLost,
		]);
		// player rows
		for (var i=1; i<=8; i++){
			var d = stats.data[i];
			if (typeof d !== 'undefined' && d.account){
				// player data exists
				var a = [{}, {
						id: 'p'+ i +'-earned',
						max: d.earned,
						key: 'earned'
					}, {
						id: 'p'+ i +'-deployed',
						max: d.deployed,
						key: 'deployed'
					}, {
						id: 'p'+ i +'-killed',
						max: d.killed,
						key: 'killed'
					}, {
						id: 'p'+ i +'-lost',
						max: d.lost,
						key: 'lost'
					},
				]
				stats.animate(a, 1.5);
				str += '<tr class="stagBlue statRow no-pointer">' +
					stats.playerCell(d, i);
					var color = game.player[i].playerColor,
						a = ['earned', 'deployed', 'killed', 'lost'],
						len = a.length;
					for (var j=0; j<len; j++){
						str += 
						'<td class="stagBlue statTD">\
							<div class="statBar pb'+ color +'">\
								<div id="p'+ i +'-'+ a[j] +'-bar" class="statBarBg pbar'+ color +'">&nbsp</div>\
								<div id="p'+ i +'-'+ a[j] +'" class="statVal">0</div>\
							</div>\
						</td>';
					}
				str += '</tr>';
			}
		}
		return str;
	},
	statStructures: function(){
		// head
		var str = stats.playerHead([
			lang[my.lang].tabBunkers,
			lang[my.lang].tabWalls,
			lang[my.lang].tabFortresses
		]);
		// player rows
		for (var i=1; i<=8; i++){
			var d = stats.data[i];
			if (typeof d !== 'undefined' && d.account){
				// player data exists
				var a = [{}, {
						id: 'p'+ i +'-bunkers',
						max: d.bunkers,
						key: 'bunkers'
					}, {
						id: 'p'+ i +'-walls',
						max: d.walls,
						key: 'walls'
					}, {
						id: 'p'+ i +'-fortresses',
						max: d.fortresses,
						key: 'fortresses'
					}
				]
				stats.animate(a, 1);
				str += '<tr class="stagBlue statRow no-pointer">' +
					stats.playerCell(d, i);
					var color = game.player[i].playerColor,
						a = ['bunkers', 'walls', 'fortresses'],
						len = a.length;
					for (var j=0; j<len; j++){
						str += 
						'<td class="stagBlue statTD">\
							<div class="statBar pb'+ color +'">\
								<div id="p'+ i +'-'+ a[j] +'-bar" class="statBarBg pbar'+ color +'">&nbsp</div>\
								<div id="p'+ i +'-'+ a[j] +'" class="statVal">0</div>\
							</div>\
						</td>';
					}
					str += '</tr>';
			}
		}
		return str;
	},
	statWeapons: function(){
		// head
		var str = stats.playerHead([
			lang[my.lang].tabCannons,
			lang[my.lang].tabMissiles,
			lang[my.lang].tabNukes
		]);
		// player rows
		for (var i=1; i<=8; i++){
			var d = stats.data[i];
			if (typeof d !== 'undefined' && d.account){
				// player data exists
				var a = [{}, {
						id: 'p'+ i +'-cannons',
						max: d.cannons,
						key: 'cannons'
					}, {
						id: 'p'+ i +'-missiles',
						max: d.missiles,
						key: 'missiles'
					}, {
						id: 'p'+ i +'-nukes',
						max: d.nukes,
						key: 'nukes'
					}
				]
				stats.animate(a, 1);
				str += '<tr class="stagBlue statRow no-pointer">'+
					stats.playerCell(d, i);
					var color = game.player[i].playerColor,
						a = ['cannons', 'missiles', 'nukes'],
						len = a.length;
					for (var j=0; j<len; j++){
						str += 
						'<td class="stagBlue statTD">\
							<div class="statBar pb'+ color +'">\
								<div id="p'+ i +'-'+ a[j] +'-bar" class="statBarBg pbar'+ color +'">&nbsp</div>\
								<div id="p'+ i +'-'+ a[j] +'" class="statVal">0</div>\
							</div>\
						</td>';
					}
					str += '</tr>';
			}
		}
		return str;
	},
	statResources: function(){
		// head
		var str = stats.playerHead([
			lang[my.lang].tabEnergy,
			lang[my.lang].tabScience,
			lang[my.lang].tabFood,
			lang[my.lang].tabCulture
		]);
		// player rows
		for (var i=1; i<=8; i++){
			var d = stats.data[i];
			if (typeof d !== 'undefined' && d.account){
				// player data exists
				var a = [{}, {
						id: 'p'+ i +'-moves',
						max: d.moves,
						key: 'moves'
					}, {
						id: 'p'+ i +'-production',
						max: d.production,
						key: 'production'
					}, {
						id: 'p'+ i +'-food',
						max: d.food,
						key: 'food'
					}, {
						id: 'p'+ i +'-culture',
						max: d.culture,
						key: 'culture'
					}
				]
				stats.animate(a, 1.5);
				str += '<tr class="stagBlue statRow no-pointer">' +
					stats.playerCell(d, i);
					var color = game.player[i].playerColor;
					str += '<td class="stagBlue statTD">\
						<div class="statBar pb'+ color +'">\
							<div id="p'+ i +'-moves-bar" class="statBarBg pbar'+ color +'">&nbsp</div>\
							<div id="p'+ i +'-moves" class="statVal">0</div>\
						</div>\
					</td>\
					<td class="stagBlue statTD">\
						<div class="statBar pb'+ color +'">\
							<div id="p'+ i +'-production-bar" class="statBarBg pbar'+ color +'">&nbsp</div>\
							<div id="p'+ i +'-production" class="statVal">0</div>\
						</div>\
					</td>\
					<td class="stagBlue statTD">\
						<div class="statBar pb'+ color +'">\
							<div id="p'+ i +'-food-bar" class="statBarBg pbar'+ color +'">&nbsp</div>\
							<div id="p'+ i +'-food" class="statVal">0</div>\
						</div>\
					</td>\
					<td class="stagBlue statTD">\
						<div class="statBar pb'+ color +'">\
							<div id="p'+ i +'-culture-bar" class="statBarBg pbar'+ color +'">&nbsp</div>\
							<div id="p'+ i +'-culture" class="statVal">0</div>\
						</div>\
					</td>\
				</tr>';
			}
		}
		return str;
	},
	playerHead: function(column){
		var str = '<tr><th style="width: 420px"></th>';
		for (var i=0, len=column.length; i<len; i++){
			if (i === 4){
				str += '<th class="text-center statHead chat-warning">'+ column[i] +'</th>';
			} else {
				str += '<th class="text-center statHead">'+ column[i] +'</th>';
			}
		}
		str += '</tr><tr class="statSpacer2"></tr>';
		return str;
	},
	playerCell: function(p, i){
		var z = game.player[i],
			color = z.playerColor,
			flag = p.flag.split('.')[0];
		flag = flag + ui.getFlagExt(flag);
		var str = '<td class="stat-detail-wrap">\
			<div class="statWrapper">\
				<img class="statFlagBG" src="images/flags/'+ flag +'">\
			</div>\
			<img class="statsFlags" src="images/flags/'+ flag +'">\
			<div class="statsPlayerWrap">\
				<div class="statsAccount chat-warning nowrap">' + lobby.governmentIcon(z);
					if (g.teamMode){
						str += '<span class="diploTeam">'+ z.team +'</span>';
					}
					// TODO: undefined error here on difficulty after CPU was eliminated and I surrendered
					var account = p.cpu === 1 ? z.difficulty : p.account;
					str += account +
				'</div>\
				<div class="statsNation nowrap">'+ p.nation +'</div>\
			</div>\
		</td>';
		return str;
	},
	initStats: function() {
		stats.data = [];
		for (var i=0; i<=8; i++) {
			stats.data[i] = {
				account: '',
				nation: '',
				flag: '',
				cpu: '',
				earned: 0,
				deployed: 0,
				killed: 0,
				lost: 0,
				bunkers: 0,
				walls: 0,
				fortresses: 0,
				cannons: 0,
				missiles: 0,
				nukes: 0,
				moves: 0,
				food: 0,
				culture: 0,
				production: 0,
			}
		}
		// add player data
		game.player.forEach(function(v, i) {
			if (v.account) {
				stats.data[i].account = v.account;
				stats.data[i].flag = v.flag;
				stats.data[i].government = v.government;
				stats.data[i].nation = v.nation;
			}
		});
	},
	delete: function() {
		sessionStorage.removeItem('fwstats');
	},
	update: function(data) {
		// console.info("stats.update", data);
		for (var player in data.contents) {
			var pObj = data.contents[player];
			for (var key in pObj) {
				stats.data[player][key] += pObj[key];
				// console.info('adding: player', player, key, pObj[key], stats.data[player][key]);
			}
		};
		sessionStorage.setItem('fwstats', JSON.stringify(stats.data));
	},
	data: [],
	gameDuration: function(data){
		return stats.hours(data) + stats.minutes(data) +':'+ stats.seconds(data)
	},
	hours: function(data){
		var hours = '';
		if (data >= 3600){
			hours = ~~(data / 3600) + ':';
		}
		return hours;
	},
	minutes: function(data){
		var min = '';
		if (data < 60){
			if (data >= 3600){
				min = '00:';
			}
		} else {
			min = ~~(data / 60 % 60);
			if (min < 10){
				min = '0' + min + '';
			}
		}
		return min;
	},
	seconds: function(data){
		var sec = ~~(data % 60);
		if (sec < 10){
			return '0' + sec + '';
		}
		return sec;
	},
	get: function(){
		$.ajax({
			url: app.url + 'php/stats.php',
			data: {
				killRatio: ~~action.getKillRatio()
			}
		}).done(function(data){
			stats.init(data);
			stats.notifyRibbons(data.ribbons);
			stats.notifySteam(data.ribbons);
		});
	},
	achievements: [],
	notifyRibbons: function(data){
		var str = '';
		data.forEach(function(e){
			str += 
			'<div class="ribbonName ranked">'+ lang[my.lang].ribbonTitle[e] +'</div>\
			<div class="ribbonDescription ranked">'+ lang[my.lang].ribbonDescription[e] +'</div>\
			<img class="giantRibbon block" src="images/ribbons/ribbon'+ e +'.jpg">';  
		});
		document.getElementById('ribbonBody').innerHTML = str;
		stats.achievements = data;
		if (stats.achievements.length){
			new Audio('sound/ding3.mp3');
			if (app.isApp) {
				// notify Steam
				var greenworks = require('./greenworks');
				if (greenworks.initAPI()) {
					greenworks.init();
					// send achievement data
				}
			}
		}
	},
	notifySteam: function(data) {
		if (app.isApp) {
			var greenworks = require('./greenworks');
			if (greenworks.initAPI()) {
				greenworks.init();
				data.forEach(function(i) {
					greenworks.activateAchievement('medal' + i, function(){});
				});
			}
		}
	},
	overviewTotal: function(i){
		return this.unitsTotal(i) + this.structuresTotal(i) + this.weaponsTotal(i) + this.resourcesTotal(i);
	},
	unitsTotal: function(i){
		var x = stats.data[i];
		return (x.deployed * 100) + (x.killed * 3);
	},
	structuresTotal: function(i){
		var x = stats.data[i];
		return (x.bunkers * 80) + (x.walls * 140) + (x.fortresses * 200);
	},
	weaponsTotal: function(i){
		var x = stats.data[i];
		return (x.cannons * 40) + (x.missiles * 60) + (x.nukes * 400);
	},
	resourcesTotal: function(i){
		var x = stats.data[i];
		return ~~( (x.food / 20) + (x.culture / 60) + (x.production / 20) );
	}
}
// animate.js
var animate = {
	colors: [
		'#ffffff',
		'#fff',
		'#eeffee',
		'#ffffee',
		'#99ff99',
		'#eefff3',
		'#ddddff'
	],
	randomColor: function(){
		return animate.colors[~~(Math.random()*6)];
	},
	getXY: function(tile){
		var box = DOM['unit' + tile].getBBox(),
			o = {
				x: box.x,
				y: box.y
			}
		return o;
	},
	icon: {
		troops: {
			audio: '',
			image: 'troops.png',
			color: '#ff0'
		},
		energy: {
			audio: '',
			image: 'energy.png',
			color: '#ffa'
		},
		food: {
			audio: '',
			image: 'food.png',
			color: '#b5ff00'
		},
		production: {
			audio: '',
			image: 'production.png',
			color: '#7cf'
		},
		culture: {
			audio: '',
			image: 'culture.png',
			color: '#d2d'
		},
		shield: {
			audio: 'build',
			image: 'tile-defense.png',
			color: '#ff0'
		}
	},
	upgrade: function(tile, type, count){
		if (animate.icon[type].audio){
			audio.play(animate.icon[type].audio);
		}
		var box = DOM['unit' + tile].getBBox();
		var x = box.x + box.width/2 - 10;
		var y = box.y + box.height/2 + 10;
		// show icon
		var wrap = document.createElementNS('http://www.w3.org/2000/svg', 'g');
		var text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
		text.setAttributeNS(null,"x",x - 10);
		text.setAttributeNS(null,"y",y + 10);
        text.style.fontFamily = 'FontAwesome';
        text.style.fontSize = '20px';
        text.style.fill = animate.icon[type].color;
		if (count){
			text.textContent = '+'+ count;
		} else {
			//text.textContent = animate.icon[type].text;
		}
		var image = document.createElementNS('http://www.w3.org/2000/svg', 'image');
		image.setAttributeNS(null,"width",'3rem');
		image.setAttributeNS(null,"height",'3rem');
		image.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","images/icons/"+ animate.icon[type].image);
		image.setAttributeNS(null,"x",x + 10);
		image.setAttributeNS(null,"y",y - 20);
		wrap.appendChild(image);
		wrap.appendChild(text);
		DOM.mapAnimations.appendChild(wrap);
		TweenMax.to([text, image], .5, {
			startAt: {
				xPercent: -50,
				yPercent: -50,
				transformOrigin: '50% 50%',
				alpha: 1,
				scale: .1
			},
			scale: 1,
			ease: Back.easeOut.config(3)
		});
		TweenMax.to([text, image], 1.5, {
			y: '-=30'
		});
		TweenMax.to([text, image], .5, {
			delay: 1.5,
			alpha: 0,
			onComplete: function(){
				wrap.parentNode.removeChild(wrap);
			}
		});
		// update bars
		this.updateMapBars(tile);
	},
	paths: function() {
		/*TweenMax.to('.paths > path', 2, {
			startAt: {
				strokeDashoffset: 0
			},
			strokeDashoffset: -12,
			repeat: -1,
			ease: Linear.easeNone
		});*/
	},
	rifle: function() {
		TweenMax.to(DOM.troopIcon, .05, {
			startAt: {
				x: -1,
				y: -2
			},
			x: 1,
			y: 2,
			repeat:3,
			yoyo:true,
			ease: RoughEase.ease.config({
				template: Power0.easeNone,
				strength: 2,
				points: 5,
				taper: "none",
				randomize: true,
				clamp: false
			}),
			onComplete: function(){
				TweenMax.to(this.target, 1.5, {
					y:0,
					ease:Elastic.easeOut
				})
			}
		});
	},
	updateMapBars: function(tile){
		var box = DOM['unit' + tile].getBBox(),
			x = box.x + box.width/2 - 10,
			y = box.y + box.height/2 + 10;
		$(".mapBars" + tile).remove();
		this.initMapBars(tile, x, y);
	},
	target: function() {
		var o = {
			brightness: 200
		};
		TweenMax.to(o, .5, {
			brightness: 100,
			onUpdate: function() {
				animate.brightness(DOM.targetUiWrap, o.brightness);
			}
		})
	},
	initMapBars: function(i, x, y){
		var e = DOM['unit' + i],
			x = e.getAttribute('x') - 25,
			y = e.getAttribute('y') - 24,
			boxHeight = 0,
			barHeight = 5,
			barPad = 1,
			widthPerTick = 5,
			widthMax = 40;
		
		if (game.tiles[i].food){
			boxHeight += barHeight + barPad;
		}
		if (game.tiles[i].production){
			boxHeight += barHeight + barPad;
		}
		if (game.tiles[i].culture){
			boxHeight += barHeight + barPad; 
		}
		var totalDef = game.tiles[i].defense;
		if (totalDef){
			boxHeight += barHeight + barPad;
		}
		var foodWidth = game.tiles[i].food * widthPerTick;
		if (foodWidth > widthMax){
			foodWidth = widthMax;
		}
		// wrapper
		x += barHeight
		if (boxHeight){
			var svg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
			svg.setAttributeNS(null, 'width', widthMax);
			svg.setAttributeNS(null, 'height', boxHeight);
			svg.setAttributeNS(null,"x",x);
			svg.setAttributeNS(null,"y",y + 26);
			svg.setAttributeNS(null,"fill","#151515");
			svg.setAttributeNS(null,"stroke","#000000");
			svg.setAttributeNS(null,"stroke-width",1);
			svg.setAttributeNS(null,"opacity",1);
			svg.setAttributeNS(null,"class","mapBars" + i);
			DOM.mapBars.appendChild(svg);
			// food
			y += 23; // fixed value?
			//x += 1 // padding
			if (game.tiles[i].food){
				y += barHeight + barPad;
				var svg = document.createElementNS('http://www.w3.org/2000/svg', 'line');
				svg.setAttributeNS(null,"x1",x);
				svg.setAttributeNS(null,"y1",y);
				svg.setAttributeNS(null,"x2",x + foodWidth);
				svg.setAttributeNS(null,"y2",y);
				svg.setAttributeNS(null,"stroke","#b5ff00");
				svg.setAttributeNS(null,"stroke-width",widthPerTick);
				svg.setAttributeNS(null,"opacity",1);
				svg.setAttributeNS(null,"class","mapBars mapBars" + i);
				DOM.mapBars.appendChild(svg);
			}
			// production
			if (game.tiles[i].production){
				y += barHeight + barPad;
				var productionWidth = game.tiles[i].production * (widthPerTick * 2);
				if (productionWidth > widthMax){
					productionWidth = widthMax;
				}
				var svg = document.createElementNS('http://www.w3.org/2000/svg', 'line');
				svg.setAttributeNS(null,"x1",x);
				svg.setAttributeNS(null,"y1",y);
				svg.setAttributeNS(null,"x2",x + productionWidth);
				svg.setAttributeNS(null,"y2",y);
				svg.setAttributeNS(null,"stroke","#7cf");
				svg.setAttributeNS(null,"stroke-width",widthPerTick);
				svg.setAttributeNS(null,"opacity",1);
				svg.setAttributeNS(null,"class","mapBars mapBars2x mapBars" + i);
				DOM.mapBars.appendChild(svg);
			}
			// culture
			if (game.tiles[i].culture){
				y += barHeight + barPad;
				var cultureWidth = game.tiles[i].culture * widthPerTick;
				if (cultureWidth > widthMax){
					cultureWidth = widthMax;
				}
				var svg = document.createElementNS('http://www.w3.org/2000/svg', 'line');
				svg.setAttributeNS(null,"x1",x);
				svg.setAttributeNS(null,"y1",y);
				svg.setAttributeNS(null,"x2",x + cultureWidth);
				svg.setAttributeNS(null,"y2",y);
				svg.setAttributeNS(null,"stroke","#dd22dd");
				svg.setAttributeNS(null,"stroke-width",widthPerTick);
				svg.setAttributeNS(null,"opacity",1);
				svg.setAttributeNS(null,"class","mapBars mapBars" + i);
				DOM.mapBars.appendChild(svg);
			}
			// defense
			if (totalDef){
				y += barHeight + barPad;
				var defWidth =
					totalDef * (widthMax/4),
					svg = document.createElementNS('http://www.w3.org/2000/svg', 'line');

				svg.setAttributeNS(null,"x1",x);
				svg.setAttributeNS(null,"y1",y);
				svg.setAttributeNS(null,"x2",x + defWidth);
				svg.setAttributeNS(null,"y2",y);
				svg.setAttributeNS(null,"stroke","#ffff00");
				svg.setAttributeNS(null,"stroke-width",barHeight);
				svg.setAttributeNS(null,"opacity",1);
				svg.setAttributeNS(null,"class","mapBars mapBars3x mapBars" + i);
				DOM.mapBars.appendChild(svg);
			}
		}
	},
	gunfire: function(atkTile, defTile, volume){
		var box1 = DOM['unit' + atkTile].getBBox(),
			box2 = DOM['unit' + defTile].getBBox();
		var sfx = ~~(Math.random()*9);
		var delay = [.6, .6, .43, .43, .43, .43, .9, .43, .76, .43];
		if (volume){
			audio.play('machine' + sfx, null, volume);
			game.tiles[atkTile].player === my.player && animate.rifle();
		}
		var shots = 30,
			w1 = 50,
			h1 = 50;
			//w2 = w1/2,
			//h2 = h1/2 - 10;
		for (var i=0; i<shots; i++){
			(function(){
				var path = document.createElementNS("http://www.w3.org/2000/svg","path"),
					x2 = box2.x + (Math.random() * w1),
					y2 = box2.y + (Math.random() * h1),
					x1 = box1.x + ~~(Math.random()*16)-8,
					y1 = box1.y + ~~(Math.random()*16)-8,
					drawPath = Math.random() > .5 ?
						"M "+ x1 +","+ y1 + ' '+ x2 +","+ y2 :
						"M "+ x2 +","+ y2 +' ' + x1 +","+ y1;

				path.setAttributeNS(null,"stroke",animate.randomColor());
				path.setAttributeNS(null,"stroke-width",1);
				DOM.world.appendChild(path);
				/*TweenLite.to(path, .1, {
					delay: (i / shots) * delay[sfx],
					startAt: {
						attr: {
							d: drawPath
						},
						drawSVG: '0%'
					},
					drawSVG: '0% 100%',
					ease: Power2.easeIn,
					onComplete: function(){
						TweenLite.to(path, .15, {
							drawSVG: '100% 100%',
							ease: Power2.easeOut,
							onComplete: function(){
								this.target.parentNode.removeChild(this.target);
							}
						});
					}
				});*/
				TweenLite.to(path, .08, {
					delay: (i / shots) * delay[sfx],
					startAt: {
						attr: {
							d: drawPath
						},
						drawSVG: '0% 25%'
					},
					drawSVG: '75% 100%',
					ease: Linear.easeIn,
					onComplete: function(){
						TweenLite.to(path, .033, {
							drawSVG: '100% 100%',
							ease: Linear.easeOut,
							onComplete: function(){
								this.target.parentNode.removeChild(this.target);
							}
						});
					}
				});

				if (i % 8 === 0) {
					animate.flash({
						d: .2,
						scale: 2,
						x: x2 - 100,
						y: y2 - 100,
					});
				}
				else if (i % 8 === 4) {
					animate.flash({
						d: .15,
						scale: 1.5,
						x: x1 - 100,
						y: y1 - 100,
					});
				}

			})();
		}
	},
	flash: function(o) {
		var image = document.createElementNS('http://www.w3.org/2000/svg', 'image');
		image.setAttributeNS(null,"width",'200px');
		image.setAttributeNS(null,"height",'200px');
		image.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","images/flash.png");
		image.setAttributeNS(null, 'class', 'no-pointer');
		image.setAttributeNS(null,"x",o.x);
		image.setAttributeNS(null,"y",o.y);
		DOM.world.appendChild(image);
		TweenLite.to(image, o.d, {
			startAt: {
				transformOrigin: '50% 50%',
				scale: o.scale
			},
			scale: 0,
			onComplete: function() {
				this.target.parentNode.removeChild(this.target);
			}
		});
	},
	flashNuke: function(o) {
		var image = document.createElementNS('http://www.w3.org/2000/svg', 'image');
		image.setAttributeNS(null,"width",'200px');
		image.setAttributeNS(null,"height",'200px');
		image.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","images/flash-nuke.png");
		image.setAttributeNS(null, 'class', 'no-pointer');
		image.setAttributeNS(null,"x",o.x);
		image.setAttributeNS(null,"y",o.y);
		DOM.world.appendChild(image);
		TweenLite.to(image, o.d, {
			startAt: {
				transformOrigin: '50% 50%',
				scale: 0
			},
			scale: o.scale,
			onComplete: function() {
				this.target.parentNode.removeChild(this.target);
			}
		});
		TweenMax.to(image, .5, {
			startAt: { rotation: 0 },
			rotation: -360,
			repeat: -1,
			ease: Linear.easeIn
		});
		TweenLite.to(image, .7, {
			delay: 1.8,
			opacity: 0,
		})
	},
	cannons: function(atkTile, defTile, playSound, delay, delay2){
		var box1 = DOM['unit' + atkTile].getBBox(),
			box2 = DOM['land' + defTile].getBBox(),
			box3 = DOM['unit' + defTile].getBBox()
			delay = delay === undefined ? .08 : delay;

		if (game.tiles[atkTile].player === my.player ||
			game.tiles[defTile].player === my.player){
			var a = [5, 6, 8];
			var sfx = ~~(Math.random() * 3);
			playSound && audio.play('grenade' + a[sfx]);
		}
		var x1 = box1.x + box1.width * .5,
			y1 = box1.y + box1.height * .5,
			w1 = box2.width * .5,
			w2 = w1/2,
			h1 = box2.height * .5,
			h2 = h1/2 - 10;

		for (var i=0; i<20; i++){
			(function(Math){
				var circ = document.createElementNS("http://www.w3.org/2000/svg","circle"),
					x2 = box3.x + (Math.random() * w1) - w2,
					y2 = box3.y + (Math.random() * h1) - h2;
				circ.setAttributeNS(null,"cx",x1);
				circ.setAttributeNS(null,"cy",y1);
				circ.setAttributeNS(null,"r",4);
				circ.setAttributeNS(null,"fill",g.color[game.player[game.tiles[atkTile].player].playerColor]);
				circ.setAttributeNS(null, 'class', 'no-pointer');
				circ.setAttributeNS(null,"stroke",animate.randomColor());
				circ.setAttributeNS(null,"strokeWidth",1);
				DOM.mapAnimations.appendChild(circ);
				
				TweenLite.to(circ, delay, {
					delay: i * .0125,
					startAt: {
						alpha: 1
					},
					attr: {
						cx: x2,
						cy: y2
					},
					ease: Linear.easeNone,
					onComplete: function(){
						// explode outward
						var d1 = Math.random()*.5 + .3,
							d2 = delay2 === undefined ? d1/2 : delay2,
							s1 = (d1 * 10) + 3;
						TweenLite.to(circ, d2, {
							startAt: {
								fill: 'none',
								strokeWidth: 0,
								attr: {
									r: 0
								}
							},
							strokeWidth: s1,
							attr: {
								r: s1/2
							},
							ease: Linear.easeNone,
							onComplete: function(){
							// explode fades from inner
								if (i % 2 === 0) {
									animate.flash({
										d: .25,
										scale: 1,
										x: x2 - 100,
										y: y2 - 100,
									});
								}
								TweenLite.to(circ, d2, {
									attr: {
										r: s1
									},
									strokeWidth: 0,
									ease: Sine.easeOut
								});
								TweenLite.to(circ, d2, {
									alpha: 0,
									onComplete: function(){
										this.target.parentNode.removeChild(this.target);
									},
									ease: Sine.easeOut
								});
							}
						});
					}
				});
				if (i === 0) {
					animate.flash({
						d: 1,
						scale: 2,
						x: x1 - 100,
						y: y1 - 100,
					});
				}
			})(Math);
		}
		animate.smoke(defTile, box3.x, box3.y, .8);
	},
	missile: function(attacker, defender, playSound){
		if (playSound){
			audio.play('missile7');
		}
		var e2 = DOM['unit' + attacker],
			boxA = e2.getBBox(),
			x1 = boxA.x + boxA.width/2,
			y1 = boxA.y + boxA.height/2,
			e3 = DOM['unit' + defender],
			boxB = e3.getBBox(),
			x2 = boxB.x + boxB.width/2,
			y2 = boxB.y + boxB.height/2;
			
		// get missile line coordinates
		my.motionPath[0] = e2.getAttribute('x')*1 - 10;
		my.motionPath[1] = e2.getAttribute('y')*1 - 10;
		my.motionPath[4] = e3.getAttribute('x')*1 - 10;
		my.motionPath[5] = e3.getAttribute('y')*1 - 10;
		my.motionPath[2] = (my.motionPath[0] + my.motionPath[4]) / 2;
		my.motionPath[3] = ((my.motionPath[1] + my.motionPath[5]) / 2) - (Math.abs(x1-x2)/3);
		TweenMax.set(DOM.motionPath, {
			attr: {
				d: "M " + my.motionPath[0] +","+ my.motionPath[1] + ' ' +
					+ my.motionPath[4] +" "+ my.motionPath[5]
			}
		});
		// missile flash
		var flash = document.createElementNS('http://www.w3.org/2000/svg', 'image');
		flash.setAttributeNS(null,"width",'200px');
		flash.setAttributeNS(null,"height",'200px');
		flash.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","images/flash-orange.png");
		flash.setAttributeNS(null, 'class', 'no-pointer');
		flash.setAttributeNS(null,"x",x1);
		flash.setAttributeNS(null,"y",y1);
		//console.info('1', x1, y1);
		//console.info('2', x2, y2);
		DOM.mapAnimations.appendChild(flash);
		TweenLite.to(flash, 1, {
			startAt: {
				xPercent: -50,
				yPercent: -50
			},
			x: x2 - x1 - 24,
			y: y2 - y1 - 24,
			ease: Power2.easeIn,
			onComplete: function() {
				this.target.parentNode.removeChild(this.target);
			}
		});

		var mis = document.createElementNS("http://www.w3.org/2000/svg", "circle");
		mis.setAttributeNS(null, "cx", x1);
		mis.setAttributeNS(null, "cy", y1);
		mis.setAttributeNS(null, "r", 12);
		mis.setAttributeNS(null, "fill", g.color[game.player[game.tiles[attacker].player].playerColor]);
		mis.setAttributeNS(null,"stroke","#ffddaa");
		mis.setAttributeNS(null,"stroke-width",2);
		mis.setAttributeNS(null, 'class', 'no-pointer');
		DOM.mapAnimations.appendChild(mis);
		var count = 0;
		TweenMax.to(mis, .1, {
			attr: {
				r: 3
			},
			repeat: -1
		});
		TweenLite.to(mis, 1, {
			startAt: {
				alpha: 1,
				xPercent: -50,
				yPercent: -50
			},
			attr: {
				cx: x2,
				cy: y2
			},
			ease: Power2.easeIn,
			onUpdate: function(){
				count++;
				if (count % 2 === 0){
					// smoke trail
					var svg = document.createElementNS('http://www.w3.org/2000/svg', 'image');
					svg.setAttributeNS(null, 'height', 40);
					svg.setAttributeNS(null, 'width', 40);
					svg.setAttributeNS(null, 'opacity', 1);
					svg.setAttributeNS(null, "x", mis.getAttribute('cx')-10);
					svg.setAttributeNS(null, "y", mis.getAttribute('cy')-10);
					svg.setAttributeNS(null, 'class', 'no-pointer');
					svg.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', 'images/smoke.png');
					DOM.mapAnimations.appendChild(svg);
					TweenLite.to(svg, .3, {
						startAt: {
							xPercent: -50,
							yPercent: -50,
							transformOrigin: '50% 50%'
						},
						scale: 3,
						onComplete: function(){
							this.target.parentNode.removeChild(this.target);
						}
					});
					TweenLite.to(svg, .5, {
						alpha: 0
					});
				}
			},
			onComplete: function(){
				this.target.parentNode.removeChild(this.target);
				animate.missileExplosion(defender, g.color[game.player[game.tiles[attacker].player].playerColor]);
			}
		});
		animate.flash({
			d: 1,
			scale: 3,
			x: x1 - 100,
			y: y1 - 100,
		});
		animate.flash({
			d: 1,
			scale: 3,
			x: x1 - 100,
			y: y1 - 100,
		});
	},
	missileExplosion: function(tile, misColor){
		var box = DOM['unit' + tile].getBBox(),
			a = [5, 6, 8],
			sfx = ~~(Math.random() * 3);
		audio.play('grenade' + a[sfx]);
		// animate.screenShake(5, 3, .016);
		var x = 0,
			y = 0;
		for (var i=0; i<5; i++){
			(function(Math){
				animate.flash({
					d: .5,
					scale: 3,
					x: x - 100,
					y: y - 100,
				});
				animate.flash({
					d: .5,
					scale: 2,
					x: x - 100,
					y: y - 100,
				});
				var circ = document.createElementNS("http://www.w3.org/2000/svg","circle");
				x = box.x + Math.random() * 60 - 30;
				y = box.y + Math.random() * 60 - 30;
				circ.setAttributeNS(null,"cx",x);
				circ.setAttributeNS(null,"cy",y);
				circ.setAttributeNS(null,"r",0);
				circ.setAttributeNS(null, 'class', 'no-pointer');
				circ.setAttributeNS(null,"fill",misColor);
				circ.setAttributeNS(null,"stroke",'#ffffaa');
				DOM.mapAnimations.appendChild(circ);
				
				var delay = i * .05;
				TweenLite.to(circ, .75, {
					delay: delay,
					attr: {
						r: 32
					},
					onComplete: function(){
						TweenMax.to(circ, 1, {
							attr: {
								r: 1
							},
							ease: Power1.easeIn,
							onComplete: function(){
								this.target.parentNode.removeChild(this.target);
							},
						});
					},
					ease: Power4.easeOut
				});
				TweenMax.to(circ, .1, {
					fill: "hsl(+=0%, +=0%, +="+ ~~(Math.random()*100) +"%)",
					repeat: -1
				});
				TweenLite.to(circ, 1.75, {
					startAt:{
						alpha: 1
					},
					alpha: 0,
					ease: Power2.easeIn
				});
			})(Math);
		}
		animate.smoke(tile, x, y, 1);
	},
	nuke: function(tile, attacker){
		var box = DOM['unit' + tile].getBBox();
		var x = box.x;
		var y = box.y;
		// bomb shadow
		shadow = document.createElementNS("http://www.w3.org/2000/svg","ellipse");
		shadow.setAttributeNS(null,"cx",x);
		shadow.setAttributeNS(null,"cy",y);
		shadow.setAttributeNS(null,"rx",2);
		shadow.setAttributeNS(null,"ry",1);
		shadow.setAttributeNS(null,"fill",'#000000');
		shadow.setAttributeNS(null,"stroke",'none');
		DOM.mapAnimations.appendChild(shadow);
		TweenMax.to(shadow, 1, {
			startAt: {
				opacity: .5
			},
			attr: {
				rx: 10,
				ry: 5
			},
			ease: Power1.easeIn,
			onComplete: function(){
				this.target.parentNode.removeChild(this.target);
			}
		});
		// drop bomb svg
		var bomb = document.createElementNS("http://www.w3.org/2000/svg", "circle");
		bomb.setAttributeNS(null, "cx", x);
		bomb.setAttributeNS(null, "cy", y - window.innerHeight);
		bomb.setAttributeNS(null, "r", 15);
		bomb.setAttributeNS(null,"fill",g.color[game.player[attacker].playerColor]);
		bomb.setAttributeNS(null,"stroke","#ffddaa");
		bomb.setAttributeNS(null, 'class', 'no-pointer');
		bomb.setAttributeNS(null,"stroke-width",2);
		DOM.mapAnimations.appendChild(bomb);
		TweenLite.to(bomb, .1, {
			attr: {
				r: 3
			},
			ease: Linear.easeIn,
			repeat: -1
		});
		TweenLite.to(bomb, 1, {
			startAt: {
				alpha: 1,
			},
			attr: {
				cy: y
			},
			ease: Power1.easeIn,
			onComplete: function(){
				this.target.parentNode.removeChild(bomb);
			}
		});
		// start bomb explosion sequence
		TweenLite.to(g, 1, {
			onComplete: function(){
				audio.play('bomb9');
				animate.screenShake(33, 7, .033, 1);
				//animate.sepia();
				animate.flashNuke({
					d: 2.5,
					scale: 2.5,
					opacity: 0,
					x: x - 100,
					y: y - 100,
				});
				animate.flashNuke({
					d: 2.5,
					scale: 2,
					x: x - 100,
					y: y - 100,
				});
				animate.flashNuke({
					d: 2.5,
					scale: 1.5,
					x: x - 100,
					y: y - 100,
				});
				animate.flashNuke({
					d: 2.5,
					scale: .75,
					x: x - 100,
					y: y - 100,
				});
				TweenMax.to(DOM.screenFlash, .05, {
					startAt: {
						opacity: .7,
						background: '#ffffff'
					},
					opacity: 0,
					background: '#ff8800',
					ease: Expo.easeOut
				});
				// shake
				var circ = document.createElementNS("http://www.w3.org/2000/svg","circle");
				circ.setAttributeNS(null,"cx",x);
				circ.setAttributeNS(null,"cy",y);
				circ.setAttributeNS(null,"r",1);
				circ.setAttributeNS(null,"fill",g.color[game.player[attacker].playerColor]);
				circ.setAttributeNS(null,"stroke",'#ffdd88');
				circ.setAttributeNS(null, 'class', 'no-pointer');
				DOM.mapAnimations.appendChild(circ);
				
				TweenLite.to(circ, 1.5, {
					startAt: {
						alpha: 1
					},
					attr: {
						r: 100
					},
					onComplete: function(){
						TweenMax.to(circ, 1, {
							attr: {
								r: 50
							},
							ease: Power1.easeIn
						});
					},
					ease: Power3.easeOut
				});
				TweenMax.to(circ, .05, {
					fill: "hsl(+=0%, +=0%, +=20%)",
					repeat: -1,
					yoyo: true,
					ease: SteppedEase.config(6)
				});
				TweenLite.to(circ, 2.5, {
					alpha: 0,
					ease: Power4.easeIn,
					onComplete: function(){
						this.target.parentNode.removeChild(this.target);
					}
				});
				
				animate.smoke(tile, x, y);
				animate.smoke(tile, x, y);
				animate.smoke(tile, x, y);
				animate.smoke(tile, x, y);
			}
		});
	},
	sepia: function() {
		var o = {
			sepia: 100,
			brightness: 200,
			blur: 3
		};

		TweenLite.to(o, 2.5, {
			sepia: 0,
			brightness: 100,
			blur: 0,
			ease: Power3.easeOut,
			onUpdate: function() {
				TweenMax.set(DOM.worldWrap, {
					filter: 'sepia(' + o.sepia +'%) brightness(' +
						o.brightness +'%) blur(' +
						o.blur +'px)'
				})
			}
		})
	},
	smoke: function(tile, x, y, scale){
		if (x === undefined){
			var o = animate.getXY(tile);
			x = o.x;
			y = o.y;
		}
		if (scale === undefined){
			scale = 1.25;
		}
		var smoke = document.createElementNS("http://www.w3.org/2000/svg","image");
		smoke.setAttributeNS(null,"width",256);
		smoke.setAttributeNS(null,"height",256);
		smoke.setAttributeNS(null,"x",x);
		smoke.setAttributeNS(null,"y",y);
		smoke.setAttributeNS(null,"opacity",0);
		smoke.setAttributeNS(null, 'class', 'no-pointer');
		smoke.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","images/smoke.png");
		DOM.mapAnimations.appendChild(smoke);
		TweenLite.to(smoke, 3, {
			startAt: {
				alpha: 1,
				transformOrigin: '50% 50%',
				xPercent: -50,
				yPercent: -50,
				scale: 0
			},
			ease: Power4.easeOut,
			scale: scale
		});
		TweenLite.to(smoke, 3, {
			alpha: 0,
			onComplete: function(){
				this.target.parentNode.removeChild(this.target);
			}
		});
		
	},
	screenShake: function(count, d, interval, fade){
		// number of shakes, distance of shaking, interval of shakes
		var foo = 0;
		(function doit(count, d, interval, e, M){
			var d2 = d/2;
			if (fade){
				if (foo % 2 === 0){
					d--;
					if (d < 2){
						d = 2;
					}
				}
			}
			TweenLite.to(e, interval, {
				x: ~~(M.random()*(d)-d2),
				y: ~~(M.random()*(d)-d2),
				onComplete:function(){
					TweenMax.to(e, interval, {
						x: ~~(M.random()*(d)-d2),
						y: ~~(M.random()*(d)-d2),
						onComplete:function(){
							TweenMax.to(e, interval, {
								x: ~~(M.random()*(d)-d2),
								y: ~~(M.random()*(d)-d2),
								onComplete:function(){
									TweenMax.to(e, interval,{
										x: 0,
										y: 0,
										onComplete: function(){
											foo++;
											if(foo < count){ 
												doit(count, d, interval, e, M); 
											}
										}
									});
								}
							});
						}
					});
				}
			});
		})(count, d, interval, DOM.gameWrap, Math);
	},
	selectTile: function(oldTgt, newTgt){
		TweenLite.set(DOM['land' + oldTgt], {
			filter: 'none',
			fill: g.color[game.player[game.tiles[oldTgt].player].playerColor],
			stroke: game.tiles[oldTgt].player ? g.color[game.player[game.tiles[oldTgt].player].playerColor] : '#aaa',
			strokeDasharray: 'none',
			strokeDashoffset: 0,
			strokeWidth: 1,
			onComplete: function(){
				if (game.tiles[oldTgt].player){
					TweenMax.set(this.target, {
						strokeWidth: 1,
						stroke: "hsl(+=0%, +=0%, -=30%)"
					});
				}
			}
		});
		// move to top
		var x = DOM['land' + newTgt].cloneNode(true);
		DOM.landWrap.appendChild(x);
		DOM['land' + newTgt].parentNode.removeChild(DOM['land' + newTgt]);
		// cache
		DOM['land' + newTgt] = document.getElementById('land' + newTgt);
		
		var newStroke = g.color[game.player[!game.tiles[newTgt].player ? 
			my.player : game.tiles[newTgt].player].playerColor];
		var newFill = g.color[game.player[!game.tiles[newTgt].player ? 
			0 : game.tiles[newTgt].player].playerColor];
		TweenLite.set(DOM['land'+ newTgt], {
			fill: newFill,
			stroke: newStroke,
			onComplete: function(){
				TweenMax.set(this.target, {
					stroke: "hsl(+=0%, +=0%, +=15)"
				});
			}
		});
		TweenMax.to(DOM['land' + newTgt], .4, {
			startAt: {
				filter: 'url(#emboss)',
				strokeDasharray: '5,5',
				strokeWidth: 3,
				strokeDashoffset: 0
			},
			strokeDashoffset: 10,
			repeat: -1,
			ease: Linear.easeNone
		});
	},
	brightness: function(e, brightness) {
		TweenLite.set(e, {
			filter: 'brightness('+ brightness +'%)'
		});
	},
	muhBible: function() {
		var tl = new TimelineMax();
		var split = new SplitText(document.getElementById('muh-bible'), {
			type: "words,chars"
		});
		var chars = split.chars;
		tl.staggerFromTo(chars, .2, {
			immediateRender: true,
			alpha: 0
		}, {
			delay: .1,
			alpha: 1
		}, .033);
	},
	energyBar: function(tick){
		// 2.7 for 12? 2.9 for 15? this is really confusing
		TweenLite.to(DOM.energyIndicator, g.speed * 2.8, {
			startAt: {
				strokeDasharray: '0,100'
			},
			force3D: true,
			strokeDasharray: '100,100',
			ease: Linear.easeNone
		});
		TweenLite.to(DOM.currentYear, 3, {
			startAt: { color: '#ff0' },
			color: '#fff',
		});
		if (tick) {
			DOM.currentYear.textContent = ui.transformYear(tick);
			var o = {
				blur: 15
			};
			/*TweenLite.to(o, 1, {
				blur: 0,
				ease: Linear.easeIn,
				onUpdate: function() {
					animate.blur(DOM.currentYear, o.blur);
				}
			});*/
			/*TweenLite.to(DOM.currentYear, 2, {
				scrambleText:{
					text: ui.transformYear(year),
      				chars: "1234567890ABCD.",
					tweenLength: false,
					ease: Linear.easeIn
				}
			});*/
		}
	},
	blur: function(e, blur) {
		TweenLite.set(e, {
			filter: blur === 0 ? 'none' : 'blur('+ blur +'px)'
		})
	},
	research: function(o) { // element, duration, tech, method
		// create new DOM element
		var e = document.createElement('div'),
			e2 = document.createElement('div'),
			e3 = document.createElement('div'),
			e4 = document.createElement('div'),
			ref = document.getElementById(o.element);

		e.className = 'research-progress';

		e2.className = 'research-label';
		e2.innerHTML = o.tech;

		e3.className = 'research-bar';

		e4.className = 'research-bar-bg';

		ref.parentNode.insertBefore(e, ref.nextSibling);
		e.appendChild(e2);
		e.appendChild(e3);
		e3.appendChild(e4);

		TweenMax.to(e4, o.duration, {
			startAt: { width: 0 },
			width: '100%',
			ease: Linear.easeIn,
			onComplete: function() {
				e.parentNode.removeChild(e);
				research[o.method]();
				if (o.tech === 'Future Tech') {
					$("#researchFutureTech").css('display', 'flex');
				}
			}
		});
		// remove original element
		if (o.tech === 'Future Tech') {
			$("#researchFutureTech").css('display', 'none');
		}
		else {
			ref.parentNode.removeChild(ref);
		}
		// remove stale tooltip
		$(".tooltip.in").remove();
	}
}
// my.js
var my = {
	window: 'Full Screen',
	lastReceivedWhisper: '',
	account: '',
	channel: '',
	player: 0,
	playerColor: 0,
	team: 0,
	gameName: 'Earth Alpha',
	max: 8,
	tgt: 1,
	lastTgt: 1,
	capital: 0,
	lastTarget: {},
	units: 0,
	food: 0,
	production: 25,
	culture: 0,
	oBonus: -1,
	dBonus: -1,
	productionBonus: -1,
	foodBonus: -1,
	cultureBonus: -1,
	foodMax: 25,
	cultureMax: 300,
	manpower: 0,
	moves: 4,
	sumMoves: 4,
	sumFood: 0,
	sumProduction: 0,
	sumCulture: 0,
	flag: "",
	targetLine: [0,0,0,0,0,0],
	motionPath: [0,0,0,0,0,0],
	attackOn: false,
	splitAttack: false,
	splitAttackCost: 1,
	attackCost: 2,
	deployCost: 1,
	rushCost: 2,
	maxDeployment: 12,
	cannonBonus: 0,
	targetData: {},
	selectedFlag: "blank",
	selectedFlagFull: "blank.png",
	government: 'Despotism',
	tech: {
		masonry: 0,
		construction: 0,
		engineering: 0,
		gunpowder: 0,
		rocketry: 0,
		atomicTheory: 0
	},
	hud: function(msg, d){
		timer.hud.kill();
		DOM.hud.style.visibility = 'visible';
		DOM.hud.textContent = msg;
		if (d){
			timer.hud = TweenMax.to(DOM.hud, 5, {
				onComplete: function(){
					DOM.hud.style.visibility = 'hidden';
				}
			});
		}
	},
	clearHud: function(){
		timer.hud.kill();
		DOM.hud.style.visibility = 'hidden';
		TweenMax.set([DOM.targetLine, DOM.targetLineBorder, DOM.targetLineShadow, DOM.targetCrosshair], {
			visibility: 'hidden',
			strokeDashoffset: 0
		});
		$("#style-land-pointer").remove();
		$DOM.head.append('<style id="style-land-pointer">.land{ cursor: pointer; }</style>');
	},
	checkSelectLastTarget: function(){
		if (game.tiles[my.tgt].player !== my.player){
			if (game.tiles[my.lastTgt].player === my.player){
				my.nextTarget(false, my.lastTgt);
			} else {
				my.nextTarget(false);
			}
		}

	},
	nextTarget: function(backwards, setTgt){
		console.info('nextTarget', backwards, setTgt);
		if (!g.spectateStatus){
			my.lastTgt = my.tgt;
			var count = 0,
				len = game.tiles.length;
			if (setTgt === undefined){
				// TAB targeting
				backwards ? my.tgt-- : my.tgt++;
			}
			else {
				my.tgt = setTgt;
			}
			if (my.tgt < 0){
				my.tgt = len-1;
			}
			while (count < len && my.player !== game.tiles[my.tgt % len].player){
				backwards ? my.tgt-- : my.tgt++;
				if (my.tgt < 0){
					my.tgt = len - 1;
				}
				count++;
			}
			if (setTgt === undefined){
				// TAB targeting
				if (!backwards){
					my.tgt = my.tgt % len;
				}
				else {
					my.tgt = Math.abs(my.tgt);
				}
			}
			else {
				my.tgt = setTgt;
			}
			my.focusTile(my.tgt, .1);
			animate.selectTile(my.lastTgt, my.tgt);
		}
	},
	// shift camera to tile
	focusTile: function(tile, d){
		console.info('focusTile', tile, d);
		var e = DOM['land' + tile];
		if (e !== null){
			var box = e.getBBox();
			if (d === undefined){
				d = .5;
			}
			// 300 is left padding; 200 top padding
			var x = -box.x - (box.width/2) - 300 + (window.innerWidth/2);
			if (x > 0){
				// if positive, it's too far left
				x = 0;
			}
			var xMin = (g.map.sizeX - window.innerWidth) * -1;
			if (x < xMin){
				// if negative it's too high
				x = xMin;
			}

			var y = -box.y - (box.height/2) - 200 + (window.innerHeight/2);
			if (y > 0){
				y = 0;
			}
			var yMin = (g.map.sizeY - window.innerHeight) * -1;
			if (y < yMin){
				y = yMin;
			}
			console.info('focusTile: ', ~~x, ~~y);
			TweenMax.to(DOM.worldWrap, d, {
				left: ~~x,
				top: ~~y,
				onUpdate: function() {
					applyBounds()
				}
			});
			ui.showTarget(DOM['land' + tile], false, 1);
		}
	}
};
// core.js
$.ajaxSetup({
	type: 'POST',
	timeout: 5000
});
TweenMax.defaultEase = Quad.easeOut;
var g = {
	ribbons: [],
	reloadGame: false,
	attackTimer: 0,
	splitAttackTimer: 0,
	cannonTimer: 0,
	missileTimer: 0,
	nukeTimer: 0,
	Msg: document.getElementById('Msg'),
	msgTimer: new TweenMax.delayedCall(0, ''),
	camel: function(str){
		str = str.split("-");
		for (var i=1, len=str.length; i<len; i++){
			str[i] = str[i].charAt(0).toUpperCase() + str[i].substr(1);
		}
		return str.join("");
	},
	msg: function(msg, d) {
		if (!msg.trim()) return;
		if (d === 0){
			TweenMax.set(g.Msg, {
				overwrite: 1,
				startAt: {
					opacity: 1
				}
			});
		}
		else {
			if (d === undefined || d < 2){
				d = 2;
			}
			g.msgTimer.kill();
			g.msgTimer = TweenMax.to(g.Msg, d, {
				startAt: {
					scaleY: 1,
					opacity: 1
				},
				onComplete: function(){
					g.msgClose();
				}
			});
		}
		if (msg) {
			g.Msg.innerHTML = msg;
		}
		// split text animation
		var tl = new TimelineMax(),
			split = new SplitText(g.Msg, {
				type: "words,chars"
			}),
			chars = split.chars;

		tl.staggerFromTo(chars, .01, {
			immediateRender: true,
			alpha: 0
		}, {
			delay: .1,
			alpha: 1
		}, .01);
	},
	msgClose: function() {
		TweenMax.to(g.Msg, .3, {
			scaleY: 0
		});
	},
	gameDuration: 0,
	spectateStatus: 0,
	modalSpeed: .5,
	friends: [],
	ignore: [],
	color: [
		"#02063a",
		"#bb0000",
		"#0077ff",
		"#a5a500",
		"#006000",
		"#b06000",
		"#33ddff",
		"#b050b0",
		"#5500aa",
		"#660000",
		"#0000bb",
		"#663300",
		"#33dd33",
		"#222222",
		"#00ff99",
		"#ff6666",
		"#ff00ff",
		'#e4e4e4',
		'#220088',
		'#404000',
		'#888888'
	],
	rankedMode: 0,
	teamMode: 0,
	joinedGame: false,
	searchingGame: false,
	defaultTitle: 'Firmament Wars',
	titleFlashing: false,
	name: "",
	password: "",
	speed: 12,
	focusUpdateNationName: false,
	focusGameName: false,
	view: "title",
	sfxFood: false,
	sfxCulture: false,
	chatOn: false,
	overlay: document.getElementById("overlay"),
	over: 0,
	showSpectateButton: 1,
	victory: false,
	startTime: Date.now(),
	keyLock: false,
	loadAttempts: 0,
	upgradeCost: [40, 50, 60],
	isModalOpen: false,
	lock: function(clear){
		g.overlay.style.display = "block";
		g.overlay.style.opacity = clear === void 0 ? 0 : 1;
		g.keyLock = true;
	},
	unlock: function(clear){
		g.overlay.style.display = "none";
		clear ? g.overlay.style.opacity = 0 : g.overlay.style.opacity = 1;
		g.keyLock = false;
	},
	unlockFade: function(d){
		if (!d){
			d = 1;
		}
		TweenMax.to(g.overlay, d, {
			startAt: {
				opacity: 1,
			},
			ease: Power3.easeIn,
			opacity: 0,
			onComplete: function(){
				g.overlay.style.display = 'none';
			}
		});
	},
	TDC: function(){
		return new TweenMax.delayedCall(0, '');
	},
	screen: {
		resizeMap: function(){
			// set worldWrap CSS
			$("#mapStyle").remove();
			var css =
				'<style id="mapStyle">#worldWrap{ '+
					'position: absolute; '+
					'top: 0%; '+
					'left: 0%; '+
					'width: ' + ((g.map.sizeX / window.innerWidth) * 100) + '%; '+
					'height: ' + ((g.map.sizeY / window.innerHeight) * 100) + '%; '+
				'}</style>';
			$DOM.head.append(css);
			setTimeout(applyBounds);
		}
	},
	mouse: {
		x: 0,
		y: 0,
		zoom: 100,
		mouseTransX: 50,
		mouseTransY: 50
	},
	map: {
		sizeX: 5099,
		sizeY: 2627,
		name: 'Alpha Earth',
		key: 'AlphaEarth',
		tiles: 143
	},
	updateUserInfo: function(){
		if (location.host !== 'localhost'){
			$.ajax({
				async: true,
				type: 'GET',
				dataType: 'jsonp',
				url: 'https://geoip-db.com/json/geoip.php?jsonp=?'
			}).done(function(data){
				data.latitude += '';
				data.longitude += '';
				g.geo = data;
				$.ajax({
					url: app.url + 'php/updateUserInfo.php',
					data: {
						location: g.geo
					}
				}).done(function(){
					localStorage.setItem('geo', JSON.stringify(g.geo));
					localStorage.setItem('geoSeason', 1);
					localStorage.setItem('geoTime', Date.now());
				});
				//console.info('loc: ', g.geo);
			});
		}
	},
	checkPlayerData: function(){
		var geo = localStorage.getItem(my.account+ '_geo'),
			geoTime = localStorage.getItem(my.account+ '_geoTime'),
			geoSeason = localStorage.getItem(my.account+ '_geoSeason');

		if (geoTime !== null || geoSeason === null){
			// longer than 90 days?
			if ((Date.now() - geoTime) > 7776000 || geoSeason === null){
				g.updateUserInfo();
			}
		}
		else if (geo === null){
			g.updateUserInfo();
		}
		// ignore list
		var ignore = localStorage.getItem('ignore');
		if (ignore !== null){
			g.ignore = JSON.parse(ignore);
		} else {
			// first time user... open configure nation
			app.isApp && title.configureNation();
			var foo = [];
			localStorage.setItem('ignore', JSON.stringify(foo));
		}
		var bible = localStorage.getItem('bible') * 1;
		$("#bible-status").prop('checked', !!bible);
		stats.setBibleMode(bible);
	},
	config: {
		audio: {
			musicVolume: 10,
			soundVolume: 20
		}
	},
	geo: {},
	keepAlive: function(){
		if (g.view !== 'game') {
			$.ajax({
				type: 'GET',
				url: app.url + "php/keepAlive.php"
			});
		}
		setTimeout(g.keepAlive, 120000);
	},
	removeContainers: function(){
		$("#firmament-wars-logo-wrap, #mainWrap").remove();
	},
	notification: {},
	sendNotification: function(data){
		if (!document.hasFocus() && g.view !== 'game' && typeof Notification === 'function'){
			
			Notification.requestPermission().then(function(permission){
				if (permission === 'granted'){
					// it's a player message
					var type = ' says: ';
					if (data.flag && (data.msg || data.message)){
						// sent by a player
						if (data.type === 'chat-whisper'){
							type = ' whispers: ';
						}
						var prefix = data.account + type;
						g.notification = new Notification(prefix, {
							icon: 'images/flags/' + flagFile,
							tag: "Firmament Wars",
							body: data.msg ? data.msg : data.message
						});
						g.notification.onclick = function(){
							window.focus();
						}
						// title flash
						if (!g.titleFlashing){
							g.titleFlashing = true;
							(function repeat(toggle){
								if (!document.hasFocus()){
									if (toggle % 2 === 0){
										document.title = prefix;
									} else {
										document.title = g.defaultTitle;
									}
									setTimeout(repeat, 3000, ++toggle);
								}
							})(0);
						}
						audio.play('chat');
					}
				}
			});
		}
	},
	chat: function(msg, type){
		var o = {
			message: msg,
			type: type
		};
		if (g.view === 'title'){
			title.chat(o);
		} else if (g.view === 'lobby'){
			lobby.chat(o);
		} else {
			game.chat(o);
		}
	},
	getRandomFlag: function(){
		var a = [],
			i = 0;
		for (var key in g.flagData){
			g.flagData[key].name.forEach(function(flag){
				a[i++] = flag;
			});
		}
		var len = a.length,
			ind = ~~(Math.random() * len);
		return a[ind];
	},
	flagData: {
		Africa: {
			group: "Africa",
			name: ['Algeria', 'Angola', 'Benin', 'Botswana', 'Burkina Faso', 'Burundi', 'Cameroon', 'Cape Verde', 'Central African Republic', 'Chad', 'The Comoros', 'The Congo', 'Democratic Republic of the Congo', 'Djibouti', 'Equatorial Guinea', 'Eritrea', 'Gabon', 'The Gambia', 'Guinea', 'Guinea-Bissau', 'Ivory Coast', 'Egypt', 'Ethiopia', 'Ghana', 'Kenya', 'Lesotho', 'Liberia', 'Libya', 'Madagascar', 'Malawi', 'Mali', 'Mauritania', 'Mauritius', 'Morocco', 'Mozambique', 'Namibia', 'Niger', 'Nigeria', 'Rwanda', 'Sao Tome and Prncipe', 'Senegal', 'Seychelles', 'Sierra Leone', 'Somalia', 'South Africa', 'South Sudan', 'Sudan', 'Swaziland', 'Tanzania', 'Togo', 'Tunisia', 'Uganda', 'Zambia', 'Zimbabwe']
		},
		Asia: {
			group: "Asia",
			name: ['Bangladesh', 'Bhutan', 'Brunei', 'Cambodia', 'China', 'East Timor', 'Hong Kong', 'India', 'Indonesia', 'Japan', 'Laos', 'Malaysia', 'Maldives', 'Mongolia', 'Myanmar', 'Nepal', 'North Korea', 'Pakistan', 'Philippines', 'Republic of Korea', 'Singapore', 'Sri Lanka', 'Suriname', 'Taiwan', 'Thailand', 'Vietnam']
		},
		CentralAsia: {
			group: "Central Asia",
			name: ['Armenia', 'Azerbaijan', 'Georgia', 'Kazakhstan', 'Kyrgyzstan', 'Tajikistan', 'Turkmenistan', 'Uzbekistan']
		},
		Europe: {
			group: "Europe",
			name: ['Albania', 'Andorra', 'Austria', 'Belarus', 'Belgium', 'Bosnia and Herzegovina', 'Bulgaria', 'Croatia', 'Cyprus', 'Czechia', 'Denmark', 'England', 'Estonia', 'Finland', 'France', 'Germany', 'Greece', 'Hungary', 'Iceland', 'Ireland', 'Italy', 'Kosovo', 'Latvia', 'Liechtenstein', 'Lithuania', 'Luxembourg', 'Macedonia', 'Malta', 'Moldova', 'Monaco', 'Montenegro', 'Netherlands', 'Norway', 'Poland', 'Portugal', 'Romania', 'Russia', 'San Marino', 'Scotland', 'Serbia', 'Slovakia', 'Slovenia', 'Spain', 'Sweden', 'Switzerland', 'Ukraine', 'United Kingdom', 'Vatican City']
		},
		Historic: {
			group: "Historic",
			name: ['Benin Empire', 'Byzantine Empire', 'Confederate Flag', 'Flanders', 'Gadsden Flag', 'Holy Roman Empire', 'Isle of Man', 'Rising Sun Flag', 'NSDAP Flag', 'NSDAP War Ensign', 'Ottoman Empire', 'Rhodesia', 'Roman Empire', 'Shahanshahi', 'USSR', 'Veneto', 'Welsh']
		},
		MiddleEast: {
			group: "Middle East",
			name: ['Afghanistan', 'Bahrain', 'Iran', 'Iraq', 'Israel', 'Jerusalem', 'Jordan', 'Kurdistan', 'Kuwait', 'Lebanon', 'Oman', 'Palestine', 'Qatar', 'Saudi Arabia', 'Syria', 'Turkey', 'United Arab Emirates', 'Yemen']
		},
		Miscellaneous: {
			group: "Miscellaneous",
			name: ['Anarcho-Capitalist', 'Anarcho-Syndicalist', 'Antifa', 'Cascadia', 'Christian', 'European Union', 'High Energy', 'ISIS', 'Jefferson State', 'Jolly Roger', 'Kekistan', 'Northwest Front', 'Pan-African Flag', 'pol', 'Rainbow Flag', 'Sicily', 'United Nations']
		},
		NorthAmerica: {
			group: "North America",
			name: ['Antigua and Barbuda', 'Bahamas', 'Barbados', 'Belize', 'Canada', 'Costa Rica', 'Cuba', 'Dominica', 'Dominican Republic', 'El Salvador', 'Grenada', 'Guatemala', 'Jamaica', 'Haiti', 'Honduras', 'Mexico', 'Panama', 'Saint Kitts and Nevis', 'Saint Lucia', 'Saint Vincent and the Grenadines', 'Trinidad and Tobago', 'United States']
		},
		Oceania: {
			group: "Oceania",
			name: ['Australia', 'Fiji', 'Kiribati', 'Marshall Islands', 'Federated States of Micronesia', 'Nauru', 'New Zealand', 'Palau', 'Papua New Guinea', 'Samoa', 'Solomon Islands', 'Tonga', 'Tuvalu', 'Vanuatu']
		},
		SouthAmerica: {
			group: "South America",
			name: ['Argentina', 'Bolivia', 'Brazil', 'Chile', 'Colombia', 'Ecuador', 'Guyana', 'Nicaragua', 'Paraguay', 'Peru', 'Uruguay', 'Venezuela']
		},
		US_States: {
			group: "State Flags",
			name: ['Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware', 'Florida', 'Georgia State', 'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada', 'New Hampshire', 'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington', 'West Virginia', 'Wisconsin', 'Wyoming']
		},
		US_Territories: {
			group: "US Territories",
			name: ['American Samoa', 'District of Columbia', 'Guam', 'Johnston Atoll', 'Midway Islands', 'Navassa Island', 'Northern Mariana Islands', 'Palmyra Atoll', 'Puerto Rico', 'Virgin Islands', 'Wake Island']
		},
	},
	initGameCallback: function(data) {
		// handle hiding/showing menu based on environment
		if (localStorage.getItem('disconnects') === null) {
			localStorage.setItem('disconnects', 0);
		}
		if (localStorage.getItem('disconnects') * 1) {
			$.ajax({
				type: 'GET',
				url: app.url + 'php/disconnect.php'
			});
			localStorage.setItem('disconnects', 0);
		}

		if (app.isApp) {
			$("#logout").remove();
		}
		else {
			$("#logout").css('display', 'inline-block');
		}
		lang.updateIndexHtml();
		TweenMax.staggerTo(document.getElementsByClassName('action-btn'), .5, {
			startAt: { x: -30 },
			x: 0,
			opacity: 1
		}, .1);

		console.info('init-game', data.account, data);

		$('.actionButtons').tooltip({
			animation: false,
			placement: 'left',
			container: 'body'
		});
		$('[title]').tooltip({
			animation: false,
			placement: 'bottom',
			container: 'body'
		});
		if (data.account) {
			app.account = data.account; // for global reference
			isLoggedIn = 1;
			$('#logout').text('Logout ' + data.account);
			app.isApp && $("#login-modal").remove();
			// people playing firmament wars:
			/*title.chat({
				message: 'There are '+ data.currentPlayers +' people playing Firmament Wars.'
			});*/
			// set flag
			document.getElementById('updateNationFlag').src = 'images/flags/'+ data.flag;
			document.getElementById('selectedFlag').textContent = data.flagShort;
			// initChatId
			my.account = data.account;
			my.flag = data.flag;
			my.rating = data.rating;
			my.nation = data.nation;
			g.checkPlayerData();
			title.friendGet();
			g.msgClose();
		}
		else {
			notLoggedIn();
		}
		// animate logo
		/* blur(5px) hue-rotate(360deg) brightness(100%) contrast(100%) shadow(100%) (chrome not supported?) grayscale(100%) invert(100%) opacity(100%) saturate(100%) sepia(100%) */
		var e = document.getElementById('firmamentWarsLogo');
		function applyFilter(o) {
			e.style.filter =
				'drop-shadow(0px 0px '+ o.shadow +'px #048) ' +
				'brightness('+ o.brightness +'%)';
		}
		var o = {
			shadow: 2,
			brightness: 100
		};
		TweenMax.to(o, 3, {
			overwrite: 1,
			shadow: 12,
			brightness: 150,
			repeat: -1,
			yoyo: true,
			ease: Power4.easeIn,
			onUpdate: function() {
				applyFilter(o);
			}
		});
		// handle setting accounts and config nation for new players
		console.info('setAccountName', data.setAccountName);
		(function repeat() {
			if (typeof socket === 'object') {
				socket.init();
			}
			else {
				setTimeout(repeat, 100);
			}
		})();
		data.isNewAccount && title.configureNation();
		g.ribbons = data.ribbons;
	}
};
g.init = (function(){
	g.lock();
	if (app.isApp) {
		$("#exit-game").on('click', function() {
			title.exitGame();
		});
	}
	$("#reset-game").on('click', function() {
		location.reload();
	});
	TweenMax.to('#title-stars-1', 50, {
		startAt: { backgroundPosition: '0'},
		force3D: true,
		backgroundPosition: '-1920px',
		repeat: -1,
		ease: Linear.easeNone
	});
	TweenMax.to('#title-stars-2', 75, {
		startAt: { backgroundPosition: '200px -200px'},
		backgroundPosition: '-1720px -200px',
		repeat: -1,
		ease: Linear.easeNone
	});
	TweenMax.to('#title-stars-3', 100, {
		startAt: { backgroundPosition: '400px -400px'},
		backgroundPosition: '-1520px -400px',
		repeat: -1,
		ease: Linear.easeNone
	});
	TweenMax.to('#title-backdrop', 12, {
		startAt: { scale: 1, transformOrigin: '0% 100%' },
		scale: 3,
		repeat: -1,
		yoyo: true,
		ease: Power1.easeInOut
	});
	TweenMax.to('#firmamentWarsBG', 1, {
		startAt: { y: '-47%' },
		y: '-50%',
		onComplete: function() {
			TweenMax.to('#firmamentWarsBG', 10, {
				startAt: { scale: 1 },
				scale: 1.08,
				repeat: -1,
				yoyo: true,
				ease: Power1.easeInOut
			});
		}
	});
	// default
	my.lang = 'english';
	my.channel = localStorage.getItem('channel') === null ?
		'usa-1' : localStorage.getItem('channel');
	if (app.isApp) {
		g.lock(1);
		// app login, check for steam ticket
		var greenworks = require('./greenworks'),
			steam = {
				screenName: '',
				steamid: '',
				handle: 0
			};

		if (greenworks.initAPI()) {
			greenworks.init();
			var langPref = greenworks.getCurrentUILanguage(),
				z = greenworks.getSteamId();

			var index = lang.alternateSupportedLanguages.indexOf(langPref);
			/*title.chat({
				message: 'Detected language: ' + langPref
			});*/
			if (index > -1) {
				my.lang = lang.alternateSupportedLanguages[index];
			}

			g.msg(lang[my.lang].verifyingSteam);

			steam.screenName = z.screenName;
			steam.steamid = z.steamId;
			greenworks.getAuthSessionTicket(function (data) {
				steam.handle = data.handle;
				$.ajax({
					type: 'POST',
					url: app.url + 'php/init-game.php',
					data: {
						version: app.version,
						screenName: steam.screenName,
						steamid: steam.steamid,
						channel: my.channel,
						ticket: data.ticket.toString('hex')
					}
				}).done(function(data) {
					greenworks.cancelAuthTicket(steam.handle);
					g.initGameCallback(data);
				}).fail(function(data) {
					g.lock(1);
					data.responseText && g.msg(data.responseText, 0);
				});
			});
		}
		else {
			g.lock(1);
			g.msg(lang[my.lang].steamNotFound, 0);
		}
	}
	else {
		// non-app login
		$.ajax({
			type: "POST",
			url: app.url + 'php/init-game.php',
			data: {
				version: app.version,
				channel: my.channel,
				screenName: '',
				steamid: '',
				ticket: ''
			}
		}).done(function(data) {
			g.initGameCallback(data);
		}).fail(function(data) {
			g.lock(1);
			data.responseText && g.msg(data.responseText, 0);
		});
	}

	// TODO separate this confusing logic a bit
	if (location.hostname === 'localhost'){
		if (location.hash === '#stop') {
			stats.delete();
		}
		else {
			g.reloadGame = true;
			$.ajax({
				type: "GET",
				url: app.url + 'php/rejoinGame.php' // check if already in a game
			}).done(function(data) {
				console.info('rejoin ', data.gameId, data.team);
				if (data.gameId > 0){
					my.player = data.player;
					my.playerColor = data.player;
					g.teamMode = data.teamMode;
					g.rankedMode = data.rankedMode;
					my.team = data.team;
					game.id = data.gameId;
					g.map = data.mapData;
					// g.speed = data.speed;
					// join lobby in progress
					setTimeout(function(){
						lobby.init(data);
						lobby.join(0); // autojoin
						initResources(data); // setResources(data);
						my.government = data.government;
						lobby.updateGovernmentWindow(my.government);
						socket.joinGame();
					}, 111);
				}
				else {
					stats.delete();
				}
			}).fail(function(data){
				g.msg(data.responseText);
			});
		}
	}
	else {
		stats.delete();
	}
})();

// game state and methods
var game = {
	name: '',
	tiles: [],
	initialized: false,
	presence: {
		list: {},
		hb: function(data) {
			data.timestamp = Date.now();
			/*console.log('%c gameHeartbeat: ', 'background: #0f0; color: #f00');
			console.info(data);*/
			this.update(data);
			this.audit(data.timestamp);
		},
		update: function(data) {
			this.list[data.account] = data;
		},
		remove: function(data) {
			console.log("remove: ", data.account, data.player);
			socket.zmq.publish('game:'+ game.id, {
				message: '<span class="chat-warning">'+ data.account +' has disconnected.</span>',
				type: 'eliminated',
				player: data.player,
			});
		},
		reset: function() {
			this.list = {};
		},
		audit: function(now) {
			for (var key in this.list) {
				this.list[key] !== void 0 &&
					now - this.list[key].timestamp > 8000 &&
					this.remove(this.list[key]);
			}
		}
	},
	toggleGameWindows: function(){
		var x = $("#ui2-head").css('visibility') === 'visible';
		TweenMax.set(DOM.gameWindows, {
		  	visibility: x ? 'hidden' : 'visible'
		});
		if (x) {
			TweenMax.to('#hotkey-ui', .5, {
				startAt: {
					opacity: 0,
					visibility: 'visible'
				},
				opacity: 1
			});
		}
		else {
			TweenMax.set('#hotkey-ui', {
				visibility: 'hidden'
			});
		}
	},
	toggleFlags: function(){
		var x = $("#diplomacy-body").css('display') === 'block';
		TweenMax.set('#diplomacy-body', {
		  	display: x ? 'none' : 'block'
		});
	},
	player: [0,0,0,0,0,0,0,0,0], // cached values on client to reduce DB load
	initMap: function(){
		(function(d, len){
			for (var i=0; i<len; i++){
				DOM['land' + i] = d.getElementById('land' + i);
				DOM['flag' + i] = d.getElementById('flag' + i);
				DOM['unit' + i] = d.getElementById('unit' + i);
			}
		})(document, game.tiles.length);
	},
	chat: function(data){
		while (DOM.chatContent.childNodes.length > 10) {
			DOM.chatContent.removeChild(DOM.chatContent.firstChild);
		}
		var z = document.createElement('div');
		if (data.type){
			z.className = data.type;
		}
		z.innerHTML = data.message;
		DOM.chatContent.appendChild(z);
		setTimeout(function(){
			if (z !== undefined){
				if (z.parentNode !== null){
					TweenMax.to(z, .125, {
						alpha: 0,
						onComplete: function(){
							z.parentNode !== null && z.parentNode.removeChild(z);
						}
					});
				}
			}
		}, 12000);
	},
	publishEliminatePlayer: function(player) {
		socket.zmq.publish('game:'+ game.id, {
			type: 'eliminated',
			sfx: 'chat',
			player: player,
			message: '<span class="chat-warning">'+ game.player[player].nation + ' has been eliminated.</span>',
			eliminateType: 'byPlayer',
		});
	},
	eliminatePlayer: function(data){
		// player eliminated
		var i = data.player,
			playerCount = 0,
			cpuCount = 0,
			teams = [];

		// avoid calling multiple times
		console.info("eliminatePlayer: ", i, 'alive? ', game.player[i].alive);
		if (!game.player[i].alive) return;
		game.player[i].alive = 0;
		// count alive players remaining
		game.player.forEach(function(e, index){
			if (e.account && e.alive){
				if (e.cpu){
					// console.info('CPU player found at: '+ index);
					cpuCount++;
				}
				else {
					// only counts human players
					// console.info('Human player found at: '+ index);
					playerCount++;
				}
				if (teams.indexOf(e.team) === -1){
					// get a unique array of teams
					teams.push(e.team);
				}
			}
		});

		// found 2 players on diplomacy panel
		$("#diplomacyPlayer" + i).removeClass('alive');
		console.info(playerCount, cpuCount, teams);
		if (g.teamMode){
			if (teams.length <= 1){
				// disables spectate button
				g.showSpectateButton = 0;
			}
		}
		else {
			if (playerCount <= 1){
				// disables spectate button
				g.showSpectateButton = 0;
			}
		}
		// game over - insurance check to avoid multiples somehow happening
		if (!g.over){
			// it's not over... check with server
			console.info('ELIMINATED: ', i, playerCount, teams.length);
			if (i === my.player){
				console.info('I was eliminated!!!! ', i, my.player);
				gameDefeat();
			}
			else {
				// check if I won
				// cpus must be dead
				if (g.teamMode){
					if (teams.length <= 1){
						setTimeout(function(){
							gameVictory();
						}, 1000);
					}
				}
				else {
					if (playerCount <= 1 && !cpuCount){
						setTimeout(function(){
							gameVictory();
						}, 1000);
					}
				}
			}
		}
		// remove
		TweenMax.set('#diplomacyPlayer' + i, {
			autoAlpha: 0,
			onComplete: function(){
				$("#diplomacyPlayer" + i).css('display', 'none');
			}
		});
		TweenMax.set('#diplomacyPlayer' + i, 0, {
			startAt: {
				transformPerspective: 400,
				transformOrigin: '50% 0',
				rotationX: 0
			},
			paddingTop: 0,
			paddingBottom: 0,
			height: 0,
			rotationX: -90
		});
		// remove player??? always???
		data.eliminateType !== 'byPlayer' && game.removePlayer(i);
		game.chat(data);
	},
	removePlayer: function(p){
		/*game.tiles[p].account = '';
		game.tiles[p].nation = '';
		game.tiles[p].flag = '';*/
		var timestamp = Date.now();
		for (var i=0, len=game.tiles.length; i<len; i++){
			if (game.tiles[i].player === p){
				game.tiles[i].tile = i;
				game.tiles[i].account = '';
				game.tiles[i].flag = '';
				game.tiles[i].nation = '';
				game.tiles[i].defense = 0;
				game.tiles[i].player = 0;
				game.tiles[i].playerColor = 0;
				game.tiles[i].team = 0;
				game.tiles[i].units = 0;
				game.tiles[i].timestamp = 0;
				game.updateTile(game.tiles[i], timestamp);
			}
		}
	},
	getGameState: function(){
		// this is now a reality check in case zmq messes up?
		// or check that players are still online?
		$.ajax({
			type: 'GET',
			url: app.url + "php/getGameState.php"
		}).done(function(data){
			// get tile data
			for (var i=0, len=data.tiles.length; i<len; i++){
				var d = data.tiles[i],
					updateTargetStatus = false;
				// check player value
				if (d.player !== game.tiles[i].player){
					// player value has changed
					if (!game.tiles[i].units){
						// set text visible if uninhabited
						// this confuses me still...
						TweenMax.set(DOM['unit' + i], {
							visibility: 'visible'
						});
					}
					// only update client data
					game.tiles[i].player = d.player;
					game.tiles[i].account = game.player[d.player].account;
					game.tiles[i].nation = game.player[d.player].nation;
					game.tiles[i].flag = game.player[d.player].flag;

					if (my.tgt === i){
						// current target was updated
						updateTargetStatus = true;
					}
					var newFlag = !game.player[d.player].flag ?
						'blank.png' : game.player[d.player].flag;
					if (DOM['flag' + i] !== null){
						DOM['flag' + i].href.baseVal = "images/flags/" + newFlag;
					}
					TweenMax.set(DOM['land' + i], {
						fill: g.color[game.player[d.player].playerColor],
						stroke: d.player ? g.color[game.player[d.player].playerColor] : '#aaa',
						strokeWidth: 1,
						onComplete: function(){
							if (d.player){
								TweenMax.set(this.target, {
									stroke: "hsl(+=0%, +=0%, -=30%)"
								});
							}
						}
					});
				}
				// check unit value
				if (d.units !== game.tiles[i].units){
					game.tiles[i].units = d.units;
					if (my.tgt === i){
						// defender won
						updateTargetStatus = true;
					}
					ui.setTileUnits(i);
				}

				updateTargetStatus && ui.showTarget(DOM['land' + i]);
			}
		}).fail(function(data){
			console.info(data.responseText);
		});
	},
	updateDefense: function(data){
		var i = data.tile;
		game.tiles[i].defense = data.defense;
		animate.updateMapBars(i);
		if (my.tgt === i){
			ui.showTarget(DOM['land' + my.tgt]);
		}
	},
	updateTile: function(d, localTimestampBypass){
		var i = d.tile * 1,
			attackPlayer = d.player * 1,
			timestamp = d.timestamp * 10000;

		// this update happened on the server earlier than most recent update... ignore!
		if (timestamp < game.tiles[i].timestamp) {
			if (localTimestampBypass) {
				timestamp = localTimestampBypass;
			}
			else {
				console.warn('did not update', i, timestamp, game.tiles[i].timestamp, timestamp < game.tiles[i].timestamp);
				return;
			}
		}
		// only update client data
		var tileObj = JSON.parse(JSON.stringify(game.tiles[i])),
			defendPlayer = tileObj.player,
			defendingFlag = tileObj.flag,
			playerChanged = tileObj.player === attackPlayer;

		// console.info('updateTile: ', d);
		game.tiles[i].player = attackPlayer;
		game.tiles[i].account = game.player[attackPlayer].account;
		game.tiles[i].nation = game.player[attackPlayer].nation;
		game.tiles[i].flag = game.player[attackPlayer].flag;
		game.tiles[i].timestamp = timestamp;
		var newFlag = game.player[attackPlayer].flag;
		// change flag
		//if (DOM['flag' + i] !== null && newFlag){
			// check barb
			if (newFlag === 'blank.png' && d.units) {
				newFlag = 'Barbarian.jpg';
			}
			//console.info('newFlag', newFlag, d.units);
			DOM['flag' + i].href.baseVal = "images/flags/" + newFlag;
		//}
		// land color
		TweenMax.set(DOM['land' + i], {
			fill: g.color[game.player[attackPlayer].playerColor],
			stroke: attackPlayer ? g.color[game.player[attackPlayer].playerColor] : '#aaa',
			strokeWidth: 1,
			onComplete: function(){
				if (attackPlayer){
					TweenMax.set(this.target, {
						stroke: "hsl(+=0%, +=0%, "+ (my.tgt === i ? "+=15%)" : "-=30%)")
					});
				}
			}
		});

		// check unit value
		if (d.units){
			if (d.units !== game.tiles[i].units){
				game.tiles[i].units = d.units;
				ui.setTileUnits(i);
			}
		}
		else {
			// dead/surrender
			game.tiles[i].units = 0;
			TweenMax.set(DOM['unit' + i], {
				visibility: 'hidden'
			});
		}

		my.tgt === i && ui.showTarget(DOM['land' + i]);
		ui.drawDiplomacyPanel();
		location.host === 'localhost' &&
			localStorage.setItem('fwtiles', JSON.stringify(game.tiles));
		// only check if tile changed to a player
		/*if (defendingFlag && playerChanged) {
			console.info('player compare: ', game.tiles[i].player, defendPlayer);
			console.info("check eliminate? ", game.tiles[i].name, defendPlayer, defendingFlag);
			game.checkEliminatedPlayers();
			console.info("playerEliminated? ", playerEliminated);
		}*/
	},
	isMineOrAdjacent: function(tile) {
		if (game.tiles[tile].player === my.player) return 1;
		if (!game.tiles[tile].units) return 0;
		var foo = 0;
		game.tiles[tile].adj.forEach(function(v) {
			if (game.tiles[v].player === my.player) {
				foo = 1;
			}
		});
		return foo;
	},
	setVisibilityAll: function() {
		game.tiles.forEach(function(o, i) {
			//tile.adj.forEach(function(v) {
				ui.setUnitVisibility(i);
			//});
		});
	},
	setSumValues: function(){
		var o = {
			food: 0,
			production: 0,
			culture: 0
		}
		for (var i=0; i<g.tileCount; i++){
			if (my.player === game.tiles[i].player){
				o.food += game.tiles[i].food;
				o.production += game.tiles[i].production;
				o.culture += game.tiles[i].culture;
			}
		}
		//DOM.sumFood.textContent = o.food;
		//DOM.sumProduction.textContent = o.production;
		//DOM.sumCulture.textContent = o.culture;
	},
	energyTimer: 0,
	startGameState: function(){
		// add function to get player data list?
		// game.getGameState();
		game.energyTimer = setInterval(game.updateResources, g.speed * 1000);
		animate.energyBar();
	},
	triggerNextTurn: function(){
		console.info("TRIGGERING NEXT TURN!");
		// clearInterval(game.energyTimer);
		// game.energyTimer = setInterval(game.updateResources, g.speed * 1000);
		game.updateResources();
	},
	lowestPlayerIsMe: function() {
		var lowestId = my.player;
		game.player.forEach(function(v) {
			if (!v.cpu &&
				v.alive &&
				v.player < lowestId) {
				lowestId = v.player;
			}
		});
		return lowestId === my.player;
	},
	playerActivatesCpuTurn: function(cpu) {
		var count = 0,
			alivePlayers = [];

		game.player.forEach(function(v, i) {
			//console.info('alivePlayers status: ', v.alive, v.cpu);
			if (v.alive && v.cpu === 0) {
				// add human players only
				//console.info('alivePlayers PUSH: ', i);
				alivePlayers.push(i);
				count++;
			}
		});
		var result = alivePlayers[cpu % count];
		/*console.info('alivePlayers: ', alivePlayers);
		console.info('cpu: ', cpu);
		console.info('count: ', count);*/
		console.info('Player '+ result + ' taking turn for cpu ' + cpu);
		return result === my.player;
	},
	getResourceSums: function() {
		var o = {
			food: 0,
			production: 0,
			culture: 0
		};
		game.tiles.forEach(function(v) {
			if (v.player === my.player) {
				if (v.food) {
					o.food += v.food;
				}
				if (v.production) {
					o.production += v.production;
				}
				if (v.culture) {
					o.culture += v.culture;
				}
			}
		});
		return o;
	},
	updateResources: function(){
		if (!g.over){
			var firstPlayer = 0,
				pingCpu = 0;
			game.player.forEach(function(d){
				if (d.alive){
					if (d.cpu){
						// game.lowestPlayerIsMe() && ai.takeTurn(d);
						game.playerActivatesCpuTurn(d.player) && ai.takeTurn(d);
					}
					else {
						// 0 means player, null means barb
						if (!firstPlayer){
							firstPlayer = 1;
							if (d.account === my.account){
								// so only one players updates
								pingCpu = 1;
							}
						}
					}
				}
			});

			var res = game.getResourceSums();
			$.ajax({
				url: app.url + "php/updateResources.php",
				data: {
					pingCpu: pingCpu,
					resourceTick: g.resourceTick,
					food: res.food,
					production: res.production,
					culture: res.culture,
					revTile: game.getRevolutionTile()
				}
			}).done(game.updateResourcesDone)
			.fail(function(data){
				console.info(data.responseText);
			});
		}
	},
	getRevolutionTile: function() {
		var tile = -1,
			units = 0;
		game.tiles.forEach(function(v, i) {
			if (g.teamMode) {
				if (v.team !== my.team &&
					v.flag &&
					!v.capital) {
					if (v.units > units) {
						tile = i;
						units = v.units;
					}
				}
			}
			else {
				if (v.player !== my.player &&
					v.flag &&
					!v.capital) {
					if (v.units > units) {
						tile = i;
						units = v.units;
					}
				}
			}
		});
		return tile;
	},
	updateResourcesDone: function(data) {
		console.info('updateResources.php', data);
		g.resourceTick = data.resourceTick;
		setResources(data);
		game.reportMilestones(data);
		animate.energyBar(data.resourceTick);
		// game.lowestPlayerIsMe() && game.triggerNextTurn();
	},
	reportMilestones: function(data){
		if (data.cultureMsg !== undefined){
			if (data.cultureMsg){
				var o = {
					message: data.cultureMsg
				};
				game.chat(o);
				audio.play('culture');
				audio.play('cheer3');
				// rush bonus changes
				initOffensiveTooltips();
			}
		}
	},
	getPlayersTiles: function(player) {
		if (player === undefined) {
			return;
		}
		var arr = [];
		game.tiles.forEach(function(v, i) {
			player === v.player && arr.push(i);
		});
		return arr;
	}
};
var timer = {
	hud: g.TDC()
};
// DOM caching
var DOM;
function initDom(){
	var d = document;
	DOM = {
		diplomacyBody: d.getElementById("diplomacy-body"),
		targetUiWrap: d.getElementById('target-ui-wrap'),
		endTurn: d.getElementById('endTurn'),
		energyIndicator: d.getElementById('energyIndicator'),
		currentYear: d.getElementById('currentYear'),
		currentYearWrap: d.getElementById('currentYearWrap'),
		//targetTargetWrap: d.getElementById('targetTargetWrap'),
		targetFlag: d.getElementById('targetFlag'),
		//targetCapStar: d.getElementById('targetCapStar'),
		targetResources: d.getElementById('targetResources'),
		targetNameWrap: d.getElementById('targetNameWrap'),
		targetBarsWrap: d.getElementById('targetBarsWrap'),
		targetNameAnchor: d.getElementById('targetNameAnchor'),
		landWrap: d.getElementById('landWrap'),
		gameWindows: d.getElementsByClassName('gameWindow'),
		sumMoves: d.getElementById('sumMoves'),
		moves: d.getElementById('moves'),
		gameWrap: d.getElementById('gameWrap'),
		gameTableBody: d.getElementById('gameTableBody'),
		food: d.getElementById('food'),
		production: d.getElementById('production'),
		culture: d.getElementById('culture'),
		Msg: d.getElementById('Msg'),
		hud: d.getElementById("hud"),
		sumFood: d.getElementById("sumFood"),
		foodMax: d.getElementById("foodMax"),
		cultureMax: d.getElementById("cultureMax"),
		manpower: d.getElementById("manpower"),
		sumProduction: d.getElementById("sumProduction"),
		sumCulture: d.getElementById("sumCulture"),
		chatContent: d.getElementById("chat-content"),
		chatInput: d.getElementById("chat-input"),
		lobbyChatInput: d.getElementById("lobby-chat-input"),
		titleChatInput: d.getElementById("title-chat-input"),
		worldWrap: d.getElementById('worldWrap'),
		motionPath: d.getElementById('motionPath'),
		troopIcon: d.getElementById('troop-icon'),
		targetLine: d.getElementById('targetLine'),
		targetLineBorder: d.getElementById('targetLineBorder'),
		arrowheadTip: d.getElementById('arrowhead-tip'),
		arrowhead: d.getElementById('arrowhead'),
		arrowheadBorder: d.getElementById('arrowhead-border'),
		targetLineShadow: d.getElementById('targetLineShadow'),
		targetCrosshair: d.getElementById('targetCrosshair'),
		target: d.getElementById('target'),
		//avatar: d.getElementById('avatar'),
		//ribbonWrap: d.getElementById('ribbonWrap'),
		targetName: d.getElementById('targetName'),
		oBonus: d.getElementById('oBonus'),
		dBonus: d.getElementById('dBonus'),
		productionBonus: d.getElementById('productionBonus'),
		foodBonus: d.getElementById('foodBonus'),
		cultureBonus: d.getElementById('cultureBonus'),
		foodBar: d.getElementById('foodBar'),
		cultureBar: d.getElementById('cultureBar'),
		world: d.getElementById('world'),
		bgmusic: d.getElementById('bgmusic'),
		tileName: d.getElementById('tileName'),
		buildWord: d.getElementById('buildWord'),
		buildCost: d.getElementById('buildCost'),
		cannonsCost: d.getElementById('cannonsCost'),
		missileCost: d.getElementById('missileCost'),
		nukeCost: d.getElementById('nukeCost'),
		masonryCost: d.getElementById('masonryCost'),
		constructionCost: d.getElementById('constructionCost'),
		gunpowderCost: d.getElementById('gunpowderCost'),
		engineeringCost: d.getElementById('engineeringCost'),
		rocketryCost: d.getElementById('rocketryCost'),
		atomicTheoryCost: d.getElementById('atomicTheoryCost'),
		futureTechCost: d.getElementById('futureTechCost'),
		upgradeTileDefense: d.getElementById('upgradeTileDefense'),
		screenFlash: d.getElementById('screenFlash'),
		fireCannons: d.getElementById('fireCannons'),
		launchMissile: d.getElementById('launchMissile'),
		launchNuke: d.getElementById('launchNuke'),
		researchMasonry: d.getElementById('researchMasonry'),
		researchConstruction: d.getElementById('researchConstruction'),
		researchEngineering: d.getElementById('researchEngineering'),
		researchGunpowder: d.getElementById('researchGunpowder'),
		researchRocketry: d.getElementById('researchRocketry'),
		researchAtomicTheory: d.getElementById('researchAtomicTheory'),
		researchFutureTech: d.getElementById('researchFutureTech'),
		lobbyChatLog: d.getElementById('lobbyChatLog'),
		titleChatLog: d.getElementById('titleChatLog'),
		mapAnimations: d.getElementById('mapAnimations'),
		mapBars: d.getElementById('mapBars'),
		titleChatBody: d.getElementById('titleChatBody')
	}
};
initDom();

var $DOM = {
	head: $("#head"),
	chatInputOpen: $("#chat-input-open"),
	chatInputWrap: $("#chat-input-wrap"),
	chatInput: $("#chat-input"),
	lobbyChatInput: $("#lobby-chat-input"),
	titleChatInput: $("#title-chat-input")
};
// team colors
var worldMap = [];


var video = {
	cache: {},
	load: {
		game: function(){
			var x = [
				'smoke.png'
			];
			for (var i=0, len=x.length; i<len; i++){
				var z = x[i];
				video.cache[z] = new Image();
				video.cache[z].src = "images/" + z;
			}
		}
	}
}

function playerLogout(){

    g.lock();
	socket.publish.title.remove(my.account);
    /*$.ajax({
		type: 'GET',
		url: app.url + 'php/deleteFromFwtitle.php'
	});*/

	try {
		FB.getLoginStatus(function(ret) {
			ret.authResponse && FB.logout(function(response) {});
		});
	} catch (err){
		console.info('Facebook error: ', err);
	}

	try {
		var auth2 = gapi.auth2.getAuthInstance();
		auth2.signOut().then(function(){});
	} catch (err){
		console.info('Google error: ', err);
	}

	localStorage.removeItem('email');
	localStorage.removeItem('token');

	setTimeout(function(){
		$.ajax({
			type: 'GET',
			url: app.url + 'php/logout.php'
		}).done(function(data) {
			localStorage.removeItem('token');
			location.reload();
			g.msg(lang[my.lang].logoutSuccess);
		}).fail(function() {
			g.msg(lang[my.lang].logoutFailed);
		});
	}, 1000);
}

function exitGame(bypass){
	/*if (g.view === 'game'){
		var r = confirm("Are you sure you want to surrender?");
	}*/
	if (bypass || g.view !== 'game'){
		g.lock(1);
		$.ajax({
			url: app.url + 'php/exitGame.php',
			data: {
				view: g.view
			}
		}).always(function() {
			location.reload();
		});
	}
}
function surrenderMenu(){
	document.getElementById('surrenderScreen').style.display = 'block';
	audio.play('click');
}
function surrender(){
	document.getElementById('surrenderScreen').style.display = 'none';
	var tiles = game.getPlayersTiles(my.player);
	if (!tiles.length) {
		tiles = [];
	}
	console.info('surrender tiles: ', tiles);
	$.ajax({
		url: app.url + 'php/surrender.php',
		data: {
			tiles: JSON.stringify(tiles)
		}
	});
	audio.play('click');

}
// title.js
var title = {
	players: [],
	getLeaderboard: function(type){
		var e = document.getElementById('leaderboardBody');
		e.innerHTML = '';
		g.lock();
		$.ajax({
			url: app.url + 'php/leaderboard.php',
			data: {
				type: type
			}
		}).done(function(data) {
			e.innerHTML = data.str;
		}).always(g.unlock);
	},
	init: (function(){
		$(document).ready(function(){
			// console.info("Initializing title screen...");
			// prevents auto scroll while scrolling
			$("#titleChatLog").on('mousedown', function(){
				title.chatDrag = true;
			}).on('mouseup', function(){
				title.chatDrag = false;
			});
			$("#title-chat-input").on('focus', function(){
				title.chatOn = true;
			}).on('blur', function(){
				title.chatOn = false;
			});
			$(".createGameInput").on('focus', function(){
				title.createGameFocus = true;
			}).on('blur', function(){
				title.createGameFocus = false;
			});
			$("#login-container").on(ui.click, '.nw-link', function() {
				title.openWindow($(this).attr('href'));
			})
			/*$("#titleChatSend").on(ui.click, function(){
				title.sendMsg(true);
			});*/
			// initial refresh of games
			setTimeout(g.keepAlive, 180000);
		});
	})(),
	updateGame: function(data){
		if (data.type === 'updateToGame'){
			title.games.presence.hb(data);
		}
		else if (data.type === 'addGame'){
			title.games.presence.add(data);
		}
		else if (data.type === 'removeGame'){
			title.games.presence.remove(data);
		}
	},
	games: {
		presence: {
			list: {},
			hb: function(data) {
				data.timestamp = Date.now();
				console.log('%c titleGamesHeartbeat: '+ data.id, 'background: #f8f; color: #f00');
				if (typeof this.list[data.id] === 'undefined') {
					this.add(data);
				}
				else {
					this.update(data);
				}
				this.auditTry(data.timestamp);
			},
			add: function(data) {
				//data
				this.update(data);
				//dom
				var e = document.createElement('tr');
				e.id = 'game_' + data.id;
				e.className = 'shadow4 wars wars-'+ data.gameMode +' no-select';
				e.setAttribute('data-name', data.name);
				e.innerHTML =
					"<td class='warCells'>"+ data.name + "</td>\
					<td class='warCells'>" + data.map + "</td>\
					<td class='warCells'>" + data.gameMode + "</td>";
				DOM.gameTableBody.insertBefore(e, DOM.gameTableBody.childNodes[0]);

			},
			update: function(data) {
				console.info('update: ', data);
				if (data.players === data.max &&
					this.list[data.id].players < data.max) {
					// hide it!
					document.querySelector('#game_' + data.id).style.display = 'none';
				}
				if (typeof this.list[data.id] !== 'undefined' &&
					this.list[data.id].players === data.max &&
					data.players < data.max) {
					// show it!
					document.querySelector('#game_' + data.id).style.display = 'table-row';
				}
				this.list[data.id] = data;

			},
			remove: function(data) {
				console.log("remove: ", data.id)
				this.list[data.id] = void 0;
				var e = document.getElementById('game_' + data.id);
				if (e !== null){
					e.parentNode.removeChild(e);
				}
			},
			audit: function(now) {
				for (var key in this.list) {
					this.list[key] !== void 0 &&
						now - this.list[key].timestamp > 5000 &&
						this.remove({
							id: key
						});
				}
			},
			auditTry: _.throttle(function(data) {
				this.audit(data);
			}, 1000)
		},
	},
	mapData: {
		AlphaEarth: {
			name: 'Alpha Earth',
			tiles: 143,
			startTiles: [135, 4, 65, 81, 100, 13, 73, 21],
			sizeX: 5299,
			sizeY: 2627,
			names: [
				'Kabul', 'Luanda', 'Libreville', 'Muscat', 'Rio Gallegos', //0
				'Puerto Montt', 'Santiago', 'Athens', 'Istanbul', 'Gaziantep',
				'Tbilisi', 'Volgograd', 'Adelaide', 'Sydney', 'Darwin', //10
				'Perth', 'Brisbane', 'Zagreb', 'Dar es Salaam', 'Berlin',
				'Abidjan', 'Mumbai', 'New Delhi', 'Dhaka', 'Minsk', //20
				'Guatemala City', 'Asuncion', 'So Lus', 'Rio de Janeiro', 'Brasilia',
				'Fortaleza', 'Manaus', 'Kashgar', 'Ulaanbaatar', 'Kathmandu', //30
				'Wuwei', 'Shanghai', 'Hong Kong', 'Kunming', 'Chengdu',
				'Beijing', 'Changchun', 'Gaborone', 'Yaounde', 'Vancouver', //40
				'Calgary', 'Toronto', 'Manitoba', 'Quebec', "St. John's",
				'Yellowknife', 'Whitehorse', 'Iqaluit', 'Resolute', 'Rome', //50
				'Conakry', 'Kinshasa', 'Bogota', 'Addis Ababa', 'Algiers',
				'Lima', 'Quito', 'Cairo', 'Jerusalem', 'Helsinki', //60
				'London', 'Nuuk', 'Narsaq', 'Daneborg', 'Paramaribo',
				'Tehran', 'Baghdad', 'Reykjavik', 'Tokyo', 'Astana', //70
				'Aktau', 'Nairobi', 'Ashgabat', 'Hanoi', 'Seoul',
				'Tripoli', 'Cape Town', 'Bucharest', 'Antananarivo', 'Mexico City', //80
				'Ciudad Juarez', 'Bamako', 'Mandalay', 'Maputo', 'Windhoek',
				'Niamey', 'Abuja', 'Oslo', 'Svalbard', 'Wellington', //90
				'Karachi', 'Manila', 'Port Moresby', 'Warsaw', 'Madrid',
				'Mecca', 'Abu Dhabi', 'Riyadh', 'Medina', 'Yakutsk', //100
				'Kamchatka', 'Chita', 'Irkutsk', 'Moscow', 'St. Petersburg',
				'Novgorod', 'Novosibirsk', 'Novy Urengoy', 'Syktyvkar', 'Krasnoyarsk', //110
				'Abakan', 'Chatanga', 'Norilsk', 'Nordvik', 'Sklad',
				'Rabat', 'Khartoum', 'Stockholm', "N'Djamena", 'Bangkok', //120
				'Sorong', 'Jakarta', 'Kiev', 'Los Angeles', 'Seattle',
				'Austin', 'Atlanta', 'New York City', 'Denver', 'Chicago', //130
				'Juneau', 'Caracas', "Sana'a", 'Lusaka', 'Mogadishu',
				'Paris', 'Havana', 'Kuala Lumpur'
			],
			players: 8
		},
		China: {
			name: 'China',
			tiles: 126,
			startTiles: [94,110,119,125,51,16],
			sizeX: 4473,
			sizeY: 2525,
			names: [
				'Xiamen', 'Nanping', 'Shantou', 'Guazhou', 'Shanwei', //0
				'Shenzhen', 'Wenshan', 'Guangzhou', 'Guilin', 'Baise',
				'Yangjiang', 'Zhanjiang', 'Anshun', 'Qianxinan', 'Haikou', //10
				'Zhengzhou', 'Da Hinggan Ling', 'Harbin', 'Sunwu', 'Mudanjiang',
				'Qiqihar', 'Shuangyashan', 'Suihua', 'Yichun', 'Changsha', //20
				'Tongren', 'Jining', 'Fuyang', 'Huaihua', 'Qiandongnan',
				'Qiannan', 'Shaoguan', 'Hechi', 'Guiyang', 'Xuzhou', //30
				'Linyi', 'Nantong', 'Sanming', 'Laibin', 'Hefei',
				'Baicheng', 'Jilin', 'Changchun', 'Baishan', 'Yanbian', //40
				'Qinhuangdao', 'Fuxin', 'Dalian', 'Dandong', 'Wuwei',
				'Jiuquan', 'Bayan Nur', 'Chifeng', 'Baotou', 'Daonan', //50
				'Nenjiang', 'Hulun Buir', 'Tongliao', 'Hohhot', 'Hanzhong',
				'Ulanqab', 'Xilin Gol', 'Hinggan', 'Guangyuan', 'Dege', //60
				'Yushu', 'Amdo', 'Gyaring', 'Luobubozhen', 'Baima',
				'Golog', 'Mianyang', 'Zunyi', 'Yibin', 'Shiyan', //70
				'Ankang', 'Baoding', 'Yancheng', 'Qiangdao', 'Jinan',
				'Dongying', 'Zhumadian', 'Sanmenxia', 'Nanyang', 'Xiangyang', //80
				'Batang', 'Liupanshui', 'Liangshan', 'Bijie', 'Chongqing',
				'Aba', 'Zhaotong', 'Chengdu', 'Beijing', 'Altay', //90
				'Bayingol', 'Turpan', 'Dushanzi', 'Kumul', 'Aksu',
				'Hotan', 'Kashgar', 'Alashankou', 'rmqi', 'Qamdo', //100
				'Nagqu', 'Aru', 'Heishi', 'Nyingchi', 'Xigaze',
				'Zhongba', 'Sirenshou', 'Ngari', 'Dongruxiang', 'Lijiang', //110
				'Dehong', 'Deqen', 'Kunming', 'Honghe', 'Xishuangbanna',
				'Jiangcheng', 'Qujing', 'Hangzhou', 'Shanghai', 'Jinhua', //120
				'Ningbo'
			],
			players: 8
		},
		EarthOmega: {
			name: 'Earth Omega',
			tiles: 78,
			startTiles: [72, 5, 47, 77, 66, 8],
			sizeX: 4000,
			sizeY: 1900,
			names: [
				'Afghanistan', 'Angola', 'Gabon', 'Greece', 'Oman', //0
				'Argentina', 'Turkey', 'Romania', 'Australia', 'Austria',
				'Tanzania', 'Germany', 'Ghana', 'India', 'Belarus', //10
				'Panama', 'Bolivia', 'Brazil', 'Indonesia', 'Botswana',
				'Cameroon', 'Canada', 'Italy', 'China', 'Liberia', //20
				'Nigeria', 'Congo', 'Colombia', 'Cuba', 'Ethiopia',
				'Algeria', 'Peru', 'Egypt', 'Finland', 'United Kingdom', //30
				'Greenland', 'Guyana', 'Iran', 'Iraq', 'Iceland',
				'Israel', 'Japan', 'Kazakhastan', 'Uzbekistan', 'Cambodia', //40
				'Korea', 'Libya', 'South Africa', 'Morocco', 'Madagascar',
				'Mexico', 'Mali', 'Thailand', 'Mongolia', 'Mozambique', //50
				'Namibia', 'Niger', 'Norway', 'Svalbard', 'New Zealand',
				'Pakistan', 'Philippines', 'Papua New Guinea', 'Poland', 'Spain', //60
				'Paraguay', 'Saudi Arabia', 'Russia', 'Sudan', 'Sweden',
				'Chad', 'Ukraine', 'United States', 'Alaska', 'Venezuela', // 70
				'Yemen', 'Somalia', 'France'
			],
			players: 6
		},
		/*EarthAlpha: {
			name: 'Earth Alpha',
			tiles: 83,
			startTiles: [40, 44, 58, 51, 5, 52, 63, 62],
			sizeX: 2800,
			sizeY: 1500,
			names: [
				'Chicago', 'Pakistan', 'Namibia', 'Congo', 'Greece',
				'Oman', 'Patagonia', 'Buenos Aires', 'Turkey', 'Sydney',
				'Perth', 'Gibson Desert', 'Queensland', 'Germany', 'Persia',
				'Kenya', 'France', 'Italy', 'Mali', 'Sri Lanka',
				'India', 'Ontario', 'Estonia', 'Panama', 'Bolivia', // 20
				'Brazil', 'Rio de Janeiro', 'Guyana', 'Kyrgyzstan', 'Zimbabwe',
				'South Africa', 'Sudan', 'Quebec', 'Alberta', 'Nunavut',
				'British Colombia', 'Shanghai', 'Tibet', 'Beijing', 'Colombia',
				'Cuba', 'Poland', 'Ethiopia', 'Algeria', 'Peru', // 40
				'Egypt', 'Scandinavia', 'United Kingdom', 'Greenland', 'Yemen',
				'Babylon', 'Iceland', 'Japan', 'Kazakhstan', 'Thailand',
				'Libya', 'Morocco', 'Ukraine', 'Madagascar', 'Mexico',
				'Mongolia', 'Nigeria', 'Svalbard', 'New Zealand', 'Philippines', // 60
				'Indonesia', 'Alaska', 'Papua New Guinea', 'Spain', 'Saudi Arabia',
				'Norilsk', 'Tomsk', 'St. Petersburg','Moscow', 'Ural',
				'Yakutsk', 'Kamchatka', 'Irkutsk', 'Syberia', 'California',
				'New York', 'Florida', 'Texas' // 80
			],
			players: 8
		},*/
		EuropeMena: {
			name: 'Europe Mena',
			tiles: 137,
			startTiles: [40,56,134,31,107,86,114,96],
			sizeX: 5130,
			sizeY: 4132,
			names: [
				'Tirana', 'Yerevan', 'Baku', 'Vienna', 'Brussels', //0
				'Sofia', 'Sarajevo', 'Osijek', 'Zagreb', 'Smolensk',
				'Geneva', 'Prague', 'Bremen', 'Dresden', 'Stuttgart', //10
				'Munich', 'Cologne', 'Hanover', 'Berlin', 'Hamburg',
				'Copenhagen', 'Mazzer', 'Tinduf', 'Tinzaouten', 'Tamanrasset', //20
				'El Menia', 'Illizi', 'Touggourt', 'Oran', 'Algiers',
				'Suez', 'Cairo', 'Aswan', 'Luxor', 'Marsa Matruh', //30
				'Helsinki', 'Helsinki', 'Oulu', 'Dublin', 'Cardiff',
				'London', 'Edinburgh', 'Tbilisi', 'Athens', 'Thessaloniki', //40
				'Budapest', 'Kuwait City', 'Al Salman', 'Rutba', 'Kut',
				'Baghdad', 'Erbil', 'Reykjavik', 'Jerusalem', 'Syracuse', //50
				'Naples', 'Rome', 'Florence', 'Turin', 'Venice',
				'Amman', 'Beirut', 'Al Jaghbub', 'Benghazi', 'Wath', //60
				'Buzaymah', 'Tmassah', 'Ghat', 'Maradah', 'Sinawin',
				'Tripoli', 'Riga', 'Marrakesh', 'Rabat', 'Iasi', //70
				'Skopje', 'Amsterdam', 'Oslo', 'Krakw', 'Warsaw',
				'Szczecin', 'Lisbon', 'Porto', 'Bucharest', 'Timisoara', //80
				'Cluj-Napoca', 'Moscow', 'Grozny', 'Krasnodar', 'Volgograd',
				'Voronezh', 'Tambov', 'Yaroslavl', 'St. Petersburg', 'Murmansk', //90
				'Vilnius', 'Mecca', 'Medina', "Sana'a", 'Muscat',
				'Abu Dhabi', 'Riyadh', 'Tabuk', 'Belgrade', 'Koice', //100
				'Ljubljana', 'Gothenburg', 'Stockholm', 'Skellefte', 'Damascus',
				'Tunis', 'Erzurum', 'Gaziantep', 'Izmir', 'Istanbul', //110
				'Konya', 'Ankara', 'Lutsk', 'Sevastopol', 'Odesa',
				'Donetsk', 'Kiev', 'Cagliari', 'Toulouse', 'Marseilles', //120
				'Nantes', 'Paris', 'Limoges', 'Lyon', 'Lille',
				'Bilbao', 'Barcelona', 'Seville', 'Murcia', 'Madrid', //130
				'Valencia', 'Vigo'
			],
			players: 8
		},
		FlatEarth: {
			name: 'Flat Earth',
			tiles: 135,
			startTiles: [133,19,39,134,56,74,85,128],
			sizeX: 4623,
			sizeY: 4487,
			names: [
				'Santiago', 'La Paz', 'Asuncion', 'Rio de Janiero', 'Salvador', //0
				'Braslia', 'So Lus', 'Lima', 'Paramaribo', 'Belm',
				'Manaus', 'Caracas', 'Bogot', 'Panama', 'Guatemala', //10
				'Mexico City', 'Los Angeles', 'Austin', 'Atlanta', 'New York City',
				'Chicago', 'Winnipeg', 'Edmonton', 'Havana', 'Vancouver', //20
				'Yukon', 'Anchorage', 'Northwest Territories', 'Nunavut', 'Nuuk',
				'Daneborg', 'Qaanaaq', 'Resolute', 'Toronto', 'Reykjavik', //30
				'Auckland', 'Makassar', 'Jakarta', 'Manila', 'Tokyo',
				'Medan', 'Paris', 'Sofia', 'Bucharest', 'Sarajevo', //40
				'Warsaw', 'Vienna', 'Kiev', 'Belarus', 'Istanbul',
				'Gaziantep', 'Damascus', 'Tripoli', 'Rabat', 'Bamako', //50
				'Dakar', 'Abidjan', 'Ouagadougou', 'Niamey', 'Accra',
				'Lome', 'Abuja', 'Addis Ababa', "N'Djamena", 'Libreville', //60
				'Brazzaville', 'Luanda', 'Windhoek', 'Pretoria', 'Gaborone',
				'Maputo', 'Lusaka', 'Lubumbashi', 'Dar es Salaam', 'Nairobi', //70
				'Bangui', 'Kisangani', 'Kampala', 'Khartoum', 'Mogadishu',
				'Algiers', 'Tunis', 'Cairo', 'Jerusalem', "Sana'a", //80
				'Mecca', 'Medina', 'Riyadh', 'Doha', 'Abu Dhabi',
				'Phnom Penh', 'Hanoi', 'Mandalay', 'Dhaka', 'New Delhi', //90
				'Karachi', 'Kabul', 'Baghdad', 'Tehran', 'Tbilisi',
				'Ashgabat', 'Helsinki', 'Tashkent', 'Islamabad', 'Astana', //100
				'Ulaanbaatar', 'rmqi', 'Qinghai', 'Beijing', 'Hong Kong',
				'Shanghai', 'Seoul', 'Singapore', 'Ankara', 'Rome', //110
				'Madrid', 'Berlin', 'Stockholm', 'Antananarivo', 'Mumbai',
				'Moscow', 'Ural', 'Siberia', 'Yakutsk', 'Vladivostok', //120
				'Kamchatka', 'Yaounde', 'Athens', 'Perth', 'Brisbane',
				'Sydney', 'Jayapura', 'Port Moresby', 'Buenos Aires', 'London'
			],
			players: 8
		},
		France: {
			name: 'France',
			tiles: 81,
			startTiles: [34, 42, 38, 67, 78, 30, 63, 11],
			sizeX: 2720,
			sizeY: 1992,
			names: [
				'Oyonnax', 'Maubeuge', 'Nevers', 'Digne', 'Nice', //0
				'Lyon', 'Charleville-Mezieres', 'Toulouse', 'Chalons-en-Champagne', 'Narbonne',
				'Saint-Flour', 'Haguenau', 'Marseille', 'Caen', 'Egletons', //10
				'Angouleme', 'Rochefort', 'Melun', 'Limoges', 'Ajaccio',
				'Langres', 'Saint-Brieuc', 'La Souterraine', 'Cholet', 'Bergerac', //20
				'Besancon', 'Valence', 'Paris', 'Lisieux', 'Versailles',
				'Brest', 'Nimes', 'Orthez', 'Bordeaux', 'Bastia', //30
				'Saint-Etienne', 'Bar-le-Duc', 'Langres', 'Thonon-les-Bains', 'Bellac',
				'Briancon', 'Larrau', 'Montpellier', 'St-Malo', 'Chateauroux', //40
				'Tours', 'Grenoble', 'Champagnole', 'Sabres', 'Chartres',
				'Lyon', 'Nantes', 'Evry', 'Montauban', 'Agen', //50
				'Le Puy', 'Angers', 'Saulces-Monclin', 'Gorron', 'Metz',
				'Verdun', 'Lorient', 'Auxerre', 'Calais', 'Montdidier', //60
				'Evreux', 'Vichy', 'Bayonne', 'Perpignan', 'Dijon',
				'Alencon', 'Meaux', 'Le Havre', 'Amiens', 'Rodez', //70
				'Mulhouse', 'Cannes', 'La Roche-sur-Yon', 'Poitiers', 'Nancy',
				'Nangis' //80
			],
			players: 8
		},
		Germany: {
			name: 'Germany',
			tiles: 150,
			startTiles: [24, 6, 116, 75, 137, 66, 130, 43],
			sizeX: 3791,
			sizeY: 2939,
			names: [
				'Darmstadt', 'Ortenaukreis', 'Rems-Murr-Kreis', 'Neckar-Odenwald-Kreis', 'Konstanz',  //0
				'Freudenstadt', 'Lrrach', 'Schwarzwald-Baar-Kreis', 'Frth', 'Cham',
				'Augsburg', 'Ostalbkreis', 'Bamberg', 'Erding', 'Landshut',  //10
				'Kronach', 'Ravensburg', 'Alttting', 'Ebersberg', 'Miesbach',
				'Wetteraukreis', 'Bayreuth', 'Erlangen-Hchstadt', 'Oberallgu', 'Freyung-Grafenau',  //20
				'Eichsttt', 'Regen', 'Regensburg', 'Rhn-Grabfeld', 'Rosenheim',
				'Rottal-Inn', 'Neumarkt In Der Oberpfalz', 'Schwandorf', 'Haberge', 'Starnberg',  //30
				'Straubing-Bogen', 'Wunsiedel', 'Berchtesgadener Land', 'Ulm', 'Unterallgu',
				'Wrzburg', 'Weienburg-Gunzenhausen', 'Garmisch-Partenkirchen', 'Hof', 'Mrkisch-Oderland',  //40
				'Barnim', 'Elbe-Elster', 'Oder-Spree', 'Ostprignitz-Ruppin', 'Potsdam-Mittelmark',
				'Prignitz', 'Cottbus', 'Teltow-Flming', 'Uckermark', 'Bad-Kissingen',  //50
				'Rastatt', 'Lahn-Dill-Kreis', 'Vogelsbergkreis', 'Waldeck-Frankenberg', 'Werra-Meiner-Kreis',
				'Main-Kinzig-Kreis', 'Mecklenburgische-Seenplatte', 'Nordwestmecklenburg', 'Rostock', 'Ludwigslust-Parchim',  //60
				'Vorpommern-Greifswald', 'Vorpommern-Rgen', 'Cloppenburg', 'Cloppenburg', 'Cuxhaven',
				'Gifhorn', 'Emsland', 'Harburg', 'Hildesheim', 'Lchow-Dannenberg',  //70
				'Leer', 'Hameln-Pyrmont', 'Oldenburg', 'Osterholz', 'Osterode am Harz',
				'Hannover Region', 'Rotenburg', 'Stade', 'Heidekreis', 'Uelzen',  //80
				'Osnabrck', 'Diepholz', 'Wesermarsch', 'Wittmund', 'Wolfenbttel',
				'Borken', 'Euskirchen', 'Gtersloh', 'Hochsauerlandkreis', 'Schaumburg',  //90
				'Minden-Lbbecke', 'Mrkischer Kreis', 'Hxter', 'Soest', 'Stdteregion Aachen',
				'Steinfurt', 'Recklinghausen', 'Heinsberg', 'Warendorf', 'Kleve',  //100
				'Mettmann', 'Siegen-Wittgenstein', 'Eifelkreis Bitburg-Prm', 'Birkenfeld', 'Alzey-Worms',
				'Mayen-Koblenz', 'Rhein-Hunsrck-Kreis', 'Sdliche-Weinstrae', 'Bernkastel-Wittlich', 'Kreisverwaltung',  //110
				'Donnersbergkreis', 'Trier-Saarburg', 'Sdwestpfalz', 'Altmarkkreis-Salzwedel', 'Kyffhuserkreis',
				'Anhalt Bitterfeld', 'Harz', 'Jerichower Land', 'Saalekreis', 'Salzlandkreis',  //120
				'Brde', 'Stendal', 'Wittenberg', 'Bautzen', 'Erzgebirgskreis',
				'Grlitz', 'Meien', 'Mittelsachsen', 'Nordsachsen', 'Schsische Schweiz-Osterzgebirge',  //130
				'Vogtlandkreis', 'Dithmarschen', 'Nordfriesland', 'Ostholstein', 'Rendsburg-Eckernfrde',
				'Schleswig-Flensburg', 'Steinburg', 'Pinneberg', 'Zwickau', 'Greiz',  //140
				'Saalfeld-Rudolstadt', 'Schmalkalden-Meiningen', 'Hildburghausen', 'Eichsfeld', 'Unstrut-Hainich-Kreis'
			],
			players: 8
		},
		Italy: {
			name: 'Italy',
			tiles: 81,
			startTiles: [45, 39, 13, 29, 6, 9, 72, 73],
			sizeX: 2720,
			sizeY: 2406,
			names: [
				'Bologna', 'Parma', 'Varzi', 'Chioggia', 'Ferrara', //0
				'Rimini', 'Pesaro', 'Genoa', 'Savona', 'Ventimiglia',
				'La Spezia', 'Carbonia', 'Oristano', 'Sassari', 'Olbia', //10
				'Nuoro', 'Arbatax', 'Cagliari', 'Grosseto', 'Livorno',
				'Viareggio', 'Florence', 'Bibbiena', 'Paganico', 'Policoro', //20
				'Potenza', 'Cosenza', 'Catanzaro', 'Reggio Calabria', 'Naples',
				'Benevento', 'Avellino', 'Pompeii', 'Termoli', 'Isernia', //30
				'Bari', 'Foggia', 'Barletta', 'Brindisi', 'Lecce',
				'Taranto', 'Marsala', 'Palermo', 'Messina', 'Catania', //40
				'Syracuse', 'Agrigento', 'Vasto', 'Pescara', 'Avezzano',
				'Latina', 'Rome', 'Tivoli', 'Terracina', 'Ancona', //50
				'Teramo', 'Montesilvano', "L'Aquila", 'Turin', 'Biella',
				'Premia', 'Varese', 'Allessandria', 'Cuneo', 'Aosta', //60
				'Clusone', 'Sondrio', 'Breno', 'Verona', 'Voghera',
				'Pavia', 'Milan', 'Como', 'Udine', 'Pordenone', //70
				'Bressanone', 'Bolzano', 'Venice', 'Vicenza', 'Treviso',
				'Belluno' //80
			],
			players: 8
		},
		Japan: {
			name: "Japan",
			tiles: 47,
			startTiles: [11, 29],
			sizeX: 4081,
			sizeY: 3859,
			names: [
				'Aichi', 'Akita', 'Aomori', 'Chiba', 'Ehime',
				'Fukui', 'Fukuoka', 'Fukushima', 'Gifu', 'Gunma',
				'Hyogo', 'Hokkaido', 'Hiroshima', 'Ibaraki', 'Ishikawa', // 10
				'Iwate', 'Kochi', 'Kogawa', 'Kumamoto', 'Kanagawa',
				'Kagoshima', 'Kyoto', 'Mie', 'Miyaki', 'Miyazaki', // 20
				'Niigata', 'Nagano', 'Nara', 'Nagasaki', 'Okinawa',
				'Osaka', 'Okayama', 'Oita', 'Saga', 'Shiga', // 30
				'Shimane', 'Saitama', 'Shizuoka', 'Tochigi', 'Tokyo',
				'Tokushima', 'Tottori', 'Toyama', 'Wakayama', 'Yamaguchi', // 40
				'Yamanashi', 'Yamagata'
			],
			players: 2
		},
		Turkey: {
			name: "Turkey",
			tiles: 75,
			startTiles: [56,40,65,9],
			sizeX: 3050,
			sizeY: 1480,
			names: [
				'Adana', 'Adiyaman', 'Afyonkarahisar', 'Agri', 'Aksaray', //0
				'Amasya', 'Ankara', 'Antalya', 'Ardahan', 'Artvin',
				'Aydin', 'Balikesir', 'Bartin', 'Siirt', 'Bayburt', //10
				'Bilecik', 'Bingol', 'Bitlis', 'Bolu', 'Burdur',
				'Bursa', 'Canakkale', 'Cankiri', 'Corum', 'Denizli', //20
				'Diyarbakir', 'Sakarya', 'Edirne', 'Elazig', 'Erzincan',
				'Erzurum', 'Eskisehir', 'Gaziantep', 'Giresun', 'Gumushane', //30
				'Hakkari', 'Hatay', 'Mersin', 'Igdir', 'Isparta',
				'Istanbul', 'Izmir', 'Kahramanmaras', 'Karaman', 'Kars', //40
				'Kastamonu', 'Kayseri', 'Kirikkale', 'Kirklarelli', 'Kirsehir',
				'Kocaeli', 'Konya', 'Kutayah', 'Malatya', 'Manisa', //50
				'Mardin', 'Mugla', 'Mus', 'Nevsehir', 'Nigde',
				'Ordu', 'Rize', 'Samsun', 'Sanliurfa', 'Sinop', //60
				'Sirnak', 'Sivas', 'Tekirdag', 'Tokat', 'Trabzon',
				'Tunceli', 'Usak', 'Van', 'Yozgat', 'Zonguldak' //70
			],
			players: 4
		},
		UnitedKingdom: {
			name: "United Kingdom",
			tiles: 69,
			startTiles: [35, 52, 45, 62, 33, 38],
			sizeX: 2720,
			sizeY: 2600,
			names: [
				'Paisley', 'Stirling', 'Glasgow', 'Aberdeen', 'Dundee', //0
				'Edinburgh', 'Middlesbrough', 'Alnwick', 'Southampton', 'Northampton',
				'Cheltenham', 'Windsor', 'Luton', 'Bristol', 'Taunton', //10
				'Exeter', 'Weymouth', 'Peterborough', 'Leicester', 'Hull',
				'Scunthorpe', 'Sheffield', 'London', 'Grimsby', 'Belfast', //20
				'Colerane', 'Omagh', 'Armagh', 'Newcastle', 'Cookstown',
				'Ballymena', 'Swansea', 'Aberystwyth', 'Haverfordwest', 'Chester', //30
				'Falmouth', 'Newtown', 'Newport', 'Scarborough', 'Shrewsbury',
				'Preston', 'Rhyl', 'Holyhead', 'Colwyn Bay', 'Bangor', //40
				'Enniskillen', 'Dumfries', 'Carlisle', 'Chelmsford', 'Ipswich',
				'Norwich', 'Hastings', 'Canterbury', 'Inverness', 'Oban', //50
				'Brighton', 'Kettering', 'Coventry', 'West Berkshire', 'Guildford',
				'Bath', 'Nottingham', 'Stornoway', 'Liverpool', 'Worcester', //60
				'Oxford', 'Birmingham', 'Leeds', 'Doncaster'
			],
			players: 6
		},
		UnitedStates: {
			name: 'United States',
			tiles: 48,
			startTiles: [7, 46],
			sizeX: 2720,
			sizeY: 1791,
			names: [
				'Massachusetts', 'Minnesota', 'Montana', 'North Dakota', 'Idaho',
				'Washington', 'Arizona', 'California', 'Colorado', 'Nevada',
				'New Mexico', 'Oregon', 'Utah', 'Wyoming', 'Arkansas', // 10
				'Iowa', 'Kansas', 'Missouri', 'Nebraska', 'Oklahoma',
				'South Dakota', 'Louisiana', 'Texas', 'Connecticut', 'New Hampshire', // 20
				'Rhode Island', 'Vermont', 'Alabama', 'Florida', 'Georgia',
				'Mississippi', 'South Carolina', 'Illinois', 'Indiana', 'Kentucky', // 30
				'North Carolina', 'Ohio', 'Tennessee', 'Virginia', 'Wisconsin',
				'West Virginia', 'Delaware', 'Maryland', 'New Jersey', 'New York', // 40
				'Pennsylvania', 'Maine', 'Michigan'
			],
			players: 2
		}
	},
	chatDrag: false,
	chatOn: false,
	scrollBottom: function(){
		if (!title.chatDrag){
			DOM.titleChatLog.scrollTop = DOM.titleChatLog.scrollHeight;
		}
	},
	chat: function (data){
		if (g.view === 'title' && data.message){
			while (DOM.titleChatLog.childNodes.length > 500) {
				DOM.titleChatLog.removeChild(DOM.titleChatLog.firstChild);
			}
			if (data.type === 'inserted-image'){
				(function repeat(count){
					if (++count < 10){
						title.scrollBottom();
						setTimeout(repeat, 200, count);
					}
				})(0);
			}
			var z = document.createElement('div'); 
			if (data.type){
				z.className = data.type;
			}
			z.innerHTML = data.message;
			DOM.titleChatLog.appendChild(z);
			title.scrollBottom();
			/*
			if (!data.skip){
				g.sendNotification(data);
			}
			*/
		}
	},
	friendStatus: {},
	listFriends: function(){
		if (Date.now() - title.listFriendsThrottle < 5000) return;
		title.listFriendsThrottle = Date.now();
		var len = g.friends.length;
		g.chat('<div>Checking friends list...</div>');
		if (g.friends.length){
			g.chat('<div>Friend List ('+ len +')</div>');

			for (var i=0; i<len; i++){
				socket.zmq.publish('account:'+ g.friends[i], {
					type: 'callback-friend-tx',
					account: 'chrome',
				});
				console.info("Sending...", 'account:'+ g.friends[i]);
				title.friendStatus[g.friends[i]] = [
					'<span class="chat-muted titlePlayerAccount">',
					g.friends[i],
					'</span>'
				].join('');
			}
			setTimeout(function() {
				// console.info("title.friendStatus: ", title.friendStatus);
				for (var key in title.friendStatus) {
					g.chat(title.friendStatus[key]);
				}
			}, 1000);
		}
		else {
			g.chat("<div>You don't have any friends! Use /friend account to add a new friend.</div>", 'chat-muted');
		}
		$("#title-chat-input").focus();
	},
	friendGet: function(){
		// friend list
		g.friends = localStorage.getItem('friends') === null ?
			[] : JSON.parse(localStorage.getItem('friends'));
	},
	toggleFriend: function(account){
		account = account.trim();
		if (account !== my.account){
			console.info('toggle: ', account, account.length);

			if (g.friends.length >= 20){
				g.chat('You cannot have more than 20 friends!');
			}
			else if (g.friends.indexOf(account) > -1) {
				g.chat('Removed '+ account +' from your friend list');
				var index = g.friends.indexOf(account);
				g.friends.splice(index, 1);
				localStorage.setItem('friends', JSON.stringify(g.friends));
			}
			else {
				// add
				g.chat('Added '+ account +' to your friend list');
				g.friends.push(account);
				localStorage.setItem('friends', JSON.stringify(g.friends));
				if (g.friends.length >= 2 &&
					g.ribbons.indexOf(3) === -1) {
					$.ajax({
						type: 'GET',
						url: app.url + 'php/friend-ribbon.php'
					});
				}
			}
		}
		else {
			// cannot add yourself
			g.chat("You can't be friends with yourself!", 'chat-muted');
		}
	},
	listIgnore: function(){
		var len = g.ignore.length;
		g.chat('<div>Ignore List ('+ len +')</div>');
		for (var i=0; i<len; i++){
			var str = '<span class="chat-news titlePlayerAccount">' + g.ignore[i] +'</span>';
			g.chat(str);
		}
	},
	addIgnore: function(account){
		account = account.toLowerCase().trim();
		g.chat('<div>Ignoring '+ account +'</div>');
		if (g.ignore.indexOf(account) === -1 && account){
			if (g.ignore.length < 20){
				if (account !== my.account){
					g.ignore.push(account);
					localStorage.setItem('ignore', JSON.stringify(g.ignore));
					g.chat('Now ignoring account: ' + account, 'chat-muted');
				} else {
					g.chat("<div>You can't ignore yourself!</div><img src='"+ app.url +"images/chat/random/autism.jpg'>", 'chat-muted');
				}
			} else {
				g.chat('You cannot ignore more than 20 accounts!', 'chat-muted');
			}
		} else {
			g.chat('Already ignoring ' + account +'! Try /unignore to stop ignoring them.', 'chat-muted');
		}
	},
	removeIgnore: function(account){
		account = account.toLowerCase().trim();
		if (account && g.ignore.indexOf(account) > -1){
			// found account
			var index = g.ignore.indexOf(account);
			g.ignore.splice(index, 1);
			localStorage.setItem('ignore', JSON.stringify(g.ignore));
			g.chat('Stopped ignoring account: ' + account, 'chat-muted');
		} else {
			g.chat(account + ' is not on your ignore list.', 'chat-muted');
		}
	},
	presence: {
		list: {},
		setHeader: function() {
			if (g.view === 'title') {
				document.getElementById('titleChatHeaderChannel').textContent =
					my.channel + ' ('+ this.getListLength() + ')';
			}
		},
		getListLength: function() {
			var count = 0;
			for (var key in this.list) {
				if (this.list[key] !== void 0) {
					count++;
				}
			}
			return count;
		},
		hb: function(data) {
			data.timestamp = Date.now();
			console.log('%c titleHeartbeat: '+ data.account, 'background: #0f0; color: #f00');
			if (typeof this.list[data.account] === 'undefined') {
				this.add(data);
			}
			else {
				this.update(data);
			}
			this.auditTry(data.timestamp);
			title.games.presence.auditTry(data.timestamp);
		},
		add: function(data) {
			//data
			this.update(data);
			//dom
			var e = document.getElementById('titlePlayer' + data.account);
			if (e !== null){
				e.parentNode.removeChild(e);
			}
			e = document.createElement('div');
			e.className = "titlePlayer";
			e.id = "titlePlayer" + data.account;
			e.innerHTML =
				'<img id="titlePlayerFlag_'+ data.account +'" class="flag" src="images/flags/'+ data.flag +'">' +
				'<span class="chat-rating">['+ data.rating +']</span> '+
				'<span class="titlePlayerAccount">'+ data.account +'</span>';
			DOM.titleChatBody.appendChild(e);
			this.setHeader();

		},
		update: function(data) {
			this.list[data.account] = data;
		},
		remove: function(account) {
			console.log("remove: ", account)
			this.list[account] = void 0;
			var z = document.getElementById('titlePlayer' + account);
			if (z !== null){
				z.parentNode.removeChild(z);
			}
			this.setHeader();
		},
		reset: function() {
			this.list = {};
			this.setHeader();
		},
		audit: function(now) {
			for (var key in this.list) {
				this.list[key] !== void 0 &&
					now - this.list[key].timestamp > 5000 &&
					this.remove(key);
			}
		},
		auditTry: _.throttle(function(data) {
			this.audit(data);
		}, 1000)
	},
	sendWhisper: function(msg, splitter){
		// account
		var msg = msg.split(splitter),
			msg = msg[1].split(" "),
			account = msg.shift();
		console.info('sendWhisper', account, msg[0]);
		$.ajax({
			url: app.url + 'php/insertWhisper.php',
			data: {
				account: account,
				flag: my.flag,
				playerColor: my.playerColor,
				message: msg[0],
				action: 'send'
			}
		});
	},
	lastWhisper: {
		account: '',
		message: '',
		timestamp: 0
	},
	receiveWhisper: function(data){
		// console.info('receiveWhisper ', data);
		if (g.ignore.indexOf(data.account) === -1) {
			if (g.view === 'title') {
				title.chat(data);
			}
			else if (g.view === 'lobby') {
				lobby.chat(data);
			}
			else {
				game.chat(data);
			}
		}
	},
	changeChannel: function(msg, splitter){
		var arr = msg.split(splitter);
		socket.setChannel(arr[1]);
	},
	who: function(msg){
		var a = msg.split("/who ");
		$.ajax({
			url: app.url + 'php/whoUser.php',
			data: {
				account: a[1]
			}
		}).done(function(data){
			function getRibbonStr(){
				var str = '';
				if (data.ribbons !== undefined){
					data.ribbons.reverse();
					var i = 0,
						len = data.ribbons.length,
						z;

					if (len){
						str += '<div class="ribbon-wrap">';
						for (; i<len; i++){
							z = data.ribbons[i];
							str += '<img class="pointer ribbon" data-ribbon="'+ z +'" src="images/ribbons/ribbon'+ z +'.jpg">';
						}
						str += '</div>';
					}
				}
				return str;
			}
			
			var str = 
			'<div class="who-wrap">'+
				'<div class="who-wrap-left">';
				// left col
				str += data.str;
				if (data.account !== my.account && g.friends.indexOf(data.account) === -1){
					str += '<button style="pointer-events: initial" class="addFriend btn btn-xs fwBlue" data-account="'+ data.account +'">Add Friend</button>';
				}
			str += 
				'</div>'+
				'<div class="who-wrap-right">';
				// right col
				str += getRibbonStr() +
				'</div>'+
			'</div>';
			g.chat(str);
		}).fail(function(){
			g.chat('No data found.');
		});
	},
	help: function(){
		var a = [
			'<div class="chat-warning">Chat Commands:</div>',
			'<div>#channel: join channel</div>',
			'<div>@account: whisper user</div>',
			'<div>/ignore account: ignore account</div>',
			'<div>/unignore account: stop ignoring account</div>',
			'<div>/friend account: add/remove friend</div>',
			'<div>/who account: check account info (or click account name)</div>'
		];
		a.forEach(function(v) {
			title.chat({
				message: v,
				type: 'chat-muted'
			});
		});
	},
	broadcast: function(msg){
		$.ajax({
			url: app.url + 'php/insertBroadcast.php',
			data: {
				message: msg
			}
		});
	},
	closeApp: function(){
		$.ajax({
			type: 'GET',
			url: app.url + 'php/close-app.php'
		}).done(function() {
			console.info('close-app');
		});
	},
	url: function(url){
		$.ajax({
			url: app.url + 'php/insertUrl.php',
			data: {
				url: url
			}
		});
	},
	img: function(url){
		$.ajax({
			url: app.url + 'php/insertImg.php',
			data: {
				url: url
			}
		});
	},
	video: function(url){
		$.ajax({
			url: app.url + 'php/insertVideo.php',
			data: {
				url: url
			}
		});
	},
	fwpaid: function(msg){
		$.ajax({
			url: app.url + 'php/fwpaid.php',
			data: {
				message: msg
			}
		});
	},
	addRibbon: function(account, ribbon){
		$.ajax({
			url: app.url + 'php/fw-add-ribbon.php',
			data: {
				account: account,
				ribbon: ribbon
			}
		});
	},
	sendMsg: function(bypass){
		var msg = $DOM.titleChatInput.val().trim();
		// bypass via ENTER or chat has focus
		if (bypass || title.chatOn){
			if (msg){
				// is it a command?
				if (msg === '/friend'){
					title.listFriends();
				}
				else if (msg.indexOf('/friend ') === 0){
					title.toggleFriend(msg.slice(8));
				}
				else if (msg.indexOf('/unignore ') === 0){
					var account = msg.slice(10);
					title.removeIgnore(account);
				}
				else if (msg === '/ignore'){
					title.listIgnore();
				}
				else if (msg.indexOf('/ignore ') === 0){
					var account = msg.slice(8);
					title.addIgnore(account);
				}
				else if (msg.indexOf('/join ') === 0){
					title.changeChannel(msg, '/join ');
				}
				else if (msg.indexOf('#') === 0){
					title.changeChannel(msg, '#');
				}
				else if (msg.indexOf('/j ') === 0){
					title.changeChannel(msg, '/j ');
				}
				else if (msg.indexOf('@') === 0){
					title.sendWhisper(msg , '@');
				}
				else if (msg.indexOf('/who ') === 0){
					title.who(msg);
				}
				else if (msg.indexOf('/broadcast ') === 0){
					title.broadcast(msg);
				}
				else if (msg.indexOf('/closeApp') === 0){
					title.closeApp();
				}
				else if (msg.indexOf('/url ') === 0){
					title.url(msg);
				}
				else if (msg.indexOf('/img ') === 0){
					title.img(msg);
				}
				else if (msg.indexOf('/video ') === 0){
					title.video(msg);
				}
				else if (msg.indexOf('/fw-paid ') === 0){
					var account = msg.slice(8);
					title.fwpaid(account);
				}
				else if (msg.indexOf('/fw-add-ribbon ') === 0){
					var a = msg.split(" "),
						account = a[1],
						ribbon = a[2];
					title.addRibbon(account, ribbon);
				}
				else {
					if (msg.charAt(0) === '/' && msg.indexOf('/me') !== 0 || msg === '/me'){
						// skip
					}
					else {
						$.ajax({
							url: app.url + 'php/insertTitleChat.php',
							data: {
								message: msg
							}
						});
					}
				}
			}
			$DOM.titleChatInput.val('');
		}
	},
	listFriendsThrottle: 0,
	showBackdrop: function(e){
		TweenMax.to('#titleViewBackdrop', .3, {
			startAt: {
				visibility: 'visible',
				alpha: 0
			},
			alpha: 1,
			onComplete: function(){
				if (e !== undefined){
					e.focus();
				}
			}
		});
		g.isModalOpen = true;
		var filter = {
			blur: 0
		};
		TweenMax.to(filter, .3, {
			blur: 3,
			onUpdate: function() {
				animate.blur('#mainWrap, #gameWrap', filter.blur);
			}
		});
	},
	toggleModal: function() {
		if (g.isModalOpen) {
			title.closeModal();
		}
		else {
			title.showModal();
		}
	},
	showModal: function() {
		TweenMax.to("#optionsModal", g.modalSpeed, {
			startAt: {
				visibility: 'visible',
				y: 0,
				alpha: 0
			},
			y: 30,
			alpha: 1
		});
		title.showBackdrop();
		var filter = {
			blur: 0
		};
		TweenMax.to(filter, .3, {
			blur: 3,
			onUpdate: function() {
				animate.blur('#mainWrap, #gameWrap', filter.blur);
			}
		});
	},
	closeModal: function(){
		TweenMax.set('.title-modals, #titleViewBackdrop', {
			alpha: 0,
			visibility: 'hidden'
		});
		g.isModalOpen = false;
		var filter = {
			blur: 3
		};
		TweenMax.to(filter, .3, {
			blur: 0,
			onUpdate: function() {
				animate.blur('#mainWrap, #gameWrap', filter.blur);
			}
		});
	},
	exitGame: function() {
		// exit from app
		title.closeGame();
		nw.App.closeAllWindows();
	},
	closeGame: function() {
		if (app.isApp) {
			// do things I should do before leaving the game
			if (g.view === 'title') {
				my.account && title.presence.remove(my.account);
			}
			else if (g.view === 'lobby') {
				exitGame();
			}
			else if (g.view === 'game') {
				surrender();
			}
		}
	},
	addCpu: 0,
	createGameFocus: false,
	createGame: function(){
		var name = $("#gameName").val().slice(0, 32),
			pw = $("#gamePassword").val(),
			max = $("#gamePlayers").val() * 1,
			speed = g.speed;
			
		if (!g.rankedMode && (max < 2 || max > 8 || max % 1 !== 0)){
			g.msg(lang[my.lang].notEnoughPlayers, 1);
		}
		else {
			title.createGameService(
				name,
				pw,
				title.mapData[g.map.key].name,
				max,
				g.rankedMode,
				g.teamMode,
				speed
			);
		}
	},
	openWindow: function(href) {
		if (app.isApp) {
			var gui = require('nw.gui'),
				win = gui.Window.open(href, {
					position: 'center',
					width: 1280,
					height: 720
				});
		}
	},
	configureNation: function() {
		TweenMax.to('#configureNation', g.modalSpeed, {
			startAt: {
				visibility: 'visible',
				y: 0,
				alpha: 0
			},
			y: 30,
			alpha: 1,
			onComplete: function() {
				title.setFlagDropdown();
			}
		});
		title.showBackdrop();
	},
	setFlagDropdown: function(id, random) {
		// populate dropdown
		id = id || 'flagDropdown';
		var s = "";
		if (random) {
			s += '<li class="flex-row flagSelect">'+
					'<a class="flex-1 no-select" data-flag="Random">'+ lang[my.lang].random +'</a>'+
				'</li>';
		}
		for (var key in g.flagData){
			s += "<li class='dropdown-header shadow4'>" + g.flagData[key].group + "</li>";
			g.flagData[key].name.forEach(function(e){
				s += "<li class='flex-row flagSelect'>" +
						"<img class='flag' src='images/flags/"+ e + ui.getFlagExt(e) +"'>" +
						"<a class='flex-1 no-select flag-name' data-flag='"+ e +"'>" + e + "</a>" +
					"</li>";
			});
		}
		$('#'+ id).html(s);
	},
	createGameService: function(name, pw, map, max, rankedMode, teamMode, speed){
		g.lock(1);
		g.rankedMode = rankedMode;
		g.teamMode = teamMode;
		// g.speed = speed;
		$.ajax({
			url: app.url + 'php/createGame.php',
			data: {
				name: name,
				pw: pw,
				map: map,
				max: max,
				rating: rankedMode,
				teamMode: teamMode,
				speed: speed
			}
		}).done(function(data) {
			console.info("Created Game: ", data);
			socket.publish.title.remove(my.account);
			my.player = data.player;
			my.playerColor = data.playerColor;
			my.team = data.team;
			game.id = data.gameId;
			game.name = data.gameName;
			game.mode = data.gameMode;
			game.password = data.password;
			// console.info("Creating: ", data);
			lobby.init(data);
			lobby.join(); // create
			socket.joinGame();
			lobby.styleStartGame();
		}).fail(function(e){
			g.msg(e.statusText);
		}).always(function() {
			g.unlock(1);
		});
	},
	joinGame: function(){
		g.name = $("#joinGame").val();
		if (!g.name){
			g.msg(lang[my.lang].gameNameNotValid, 1.5);
			$("#joinGame").focus().select();
			return;
		}
		g.password = $("#joinGamePassword").val();
		g.lock();
		audio.play('click');
		$.ajax({
			url: app.url + 'php/joinGame.php',
			data: {
				name: g.name,
				password: g.password
			}
		}).done(function(data){
			title.joinGameCallback(data);
		}).fail(function(data){
			console.info(data);
			g.msg(data.statusText, 1.5);
		}).always(function(){
			g.unlock();
		});
	},
	joinGameCallback: function(data){
		socket.publish.title.remove(my.account);
		// console.info(data);
		my.player = data.player;
		my.playerColor = data.player;
		g.teamMode = data.teamMode;
		g.rankedMode = data.rankedMode;
		my.team = data.team;
		game.id = data.id;
		game.name = data.gameName;
		g.map = data.mapData;
		// g.speed = data.speed;
		console.info('joinGameCallback', data);
		lobby.init(data);
		lobby.join(); // normal join
		//$("#titleMenu, #titleChat").remove();
		socket.joinGame();
	},
	submitNationName: function(){
		var x = $("#updateNationName").val();
		g.lock();
		audio.play('click');
		$.ajax({
			url: app.url + 'php/updateNationName.php',
			data: {
				name: x
			}
		}).done(function(name) {
			g.msg(lang[my.lang].newNationName + name);
			$("#updateNationName").val(name);
		}).fail(function(e){
			g.msg(e.statusText);
		}).always(function(){
			g.unlock();
		});
	}
};
(function(){
	var str = '';
	for (var key in title.mapData){
		str += "<li><a class='mapSelect' href='#'>" + title.mapData[key].name + "</a></li>";
	}
	var e1 = document.getElementById('mapDropdown');
	if (e1 !== null){
		e1.innerHTML = str;
	}
	if (isLoggedIn){
		$('[title]').tooltip({
			animation: false
		});
	}
})();
// lobby.js
var lobby = {
	reloadGame: false,
	cpuFlag: 'Random',
	data: [
		{ account: '' }, 
		{ account: '' }, 
		{ account: '' }, 
		{ account: '' }, 
		{ account: '' }, 
		{ account: '' }, 
		{ account: '' }, 
		{ account: '' },
		{ account: '' }
	],
	startClassOn:  "btn btn-md btn-block btn-responsive shadow4 lobbyButtons",
	startClassOff: "btn btn-md btn-block btn-responsive shadow4 lobbyButtons lobby-gray",
	util: {
		countPlayers: function() {
			var v, key, count = 0;
			for (key in lobby.presence.list) {
				v = lobby.presence.list[key];
				if (typeof v !== 'undefined' && v.account) count++;
			}
			return count;
		},
		countCpuPlayers: function() {
			var v, key, count = 0;
			for (key in lobby.presence.list) {
				v = lobby.presence.list[key];
				if (typeof v !== 'undefined' && v.account && v.cpu) count++;
			}
			return count;
		}
	},
	addCpuPlayer: function(){
		var flag = lobby.cpuFlag === 'Random' ?
			g.getRandomFlag() : lobby.cpuFlag + ui.getFlagExt(lobby.cpuFlag);
		var count = lobby.util.countPlayers();
		console.info('add start: ', flag, count);
		if (count && count < title.mapData[g.map.key].players) {
			g.lock();
			audio.play('click');
			$.ajax({
				url: app.url +'php/cpu-add-player.php',
				data: {
					flag: flag,
				}
			}).always(g.unlock);
		}
	},
	removeCpuPlayer: function() {
		if (lobby.util.countCpuPlayers()) {
			var player = lobby.getHighestCpuPlayer();
			if (player) {
				console.info("REMOVING PLAYER: ", player);
				audio.play('click');
				g.lock();
				$.ajax({
					type: 'POST',
					url: app.url + 'php/cpu-remove-player.php',
					data: {
						player: player
					}
				}).always(g.unlock);
			}
		}
	},
	updateGovernmentWindow: function(government){ // key value in
		if (g.view === 'game') return;
		// updates government description
		var str = '';
		console.info('Government selected: ', government);
		if (government === 'Random') {
			document.getElementById('lobbyGovernment' + my.player).innerHTML = lang[my.lang].governments[government];
			document.getElementById('lobbyGovernmentDescription').innerHTML =
				'<div id="lobbyGovName" class="text-primary">Random</div>'+
				'<div id="lobbyGovPerks">'+
					'<div>???</div>'+
					'<div>???</div>'+
					'<div>???</div>'+
					'<div>???</div>'+
				'</div>';
		}
		else {
			str =
			'<div id="lobbyGovName" class="text-primary">' +
				'<img src="images/icons/'+ government +'.png" '+
				'class="fw-icon-sm">'+ lang[my.lang].governments[government] +
			'</div>';
			// perks
			str += '<div id="lobbyGovPerks">';
			// console.warn('lang[my.lang][government]', lang[my.lang][government]);
			for (var key in lang[my.lang][government]) {
				str += '<div>' + lang[my.lang][government][key] + '</div>';
			}
			str += '</div>';

			document.getElementById('lobbyGovernment' + my.player).innerHTML =
				'<img src="images/icons/'+ government +'.png" class="fw-icon-sm">' + lang[my.lang].governments[government];
			document.getElementById('lobbyGovernmentDescription').innerHTML = str;
		}
	},
	chat: function (data){
		while (DOM.lobbyChatLog.childNodes.length > 200) {
			DOM.lobbyChatLog.removeChild(DOM.lobbyChatLog.firstChild);
		}
		var z = document.createElement('div');
		if (data.type){
			z.className = data.type;
		}
		z.innerHTML = data.message;
		DOM.lobbyChatLog.appendChild(z);
		if (!lobby.chatDrag){
			DOM.lobbyChatLog.scrollTop = DOM.lobbyChatLog.scrollHeight;
		}
		// g.sendNotification(data.message);
	},
	chatDrag: false,
	gameStarted: false,
	chatOn: false,
	sendMsg: function(bypass){
		var msg = $DOM.lobbyChatInput.val().trim();
		if (bypass || lobby.chatOn){
			// bypass via ENTER or chat has focus
			if (msg){
				// is it a command?
				if (msg === '/friend'){
					title.listFriends();
				}
				else if (msg.indexOf('/friend ') === 0){
					title.toggleFriend(msg.slice(8));
				}
				else if (msg.indexOf('/unignore ') === 0){
					var account = msg.slice(10);
					title.removeIgnore(account);
				}
				else if (msg === '/ignore'){
					title.listIgnore();
				}
				else if (msg.indexOf('/ignore ') === 0){
					var account = msg.slice(8);
					title.addIgnore(account);
				}
				else if (msg.indexOf('@') === 0){
					title.sendWhisper(msg , '@');
				}
				else if (msg.indexOf('/who ') === 0){
					title.who(msg);
				}
				else {
					// send ajax chat msg
					if (msg.charAt(0) === '/' && msg.indexOf('/me') !== 0){
						// skip
					} else {
						$.ajax({
							url: app.url +'php/insertLobbyChat.php',
							data: {
								message: msg
							}
						});
					}
				}
			}
			$DOM.lobbyChatInput.val('');
		}
	},
	init: function(x){
		// build the lobby DOM
		if (lobby.initialized) return;
		document.getElementById('lobbyChatLog').innerHTML = lang[my.lang].youHaveJoined + x.name;
		lobby.sendMsg();
		var e1 = document.getElementById("lobbyGameName");
		if (e1 !== null){
			if (x.rating){
				document.getElementById('lobbyRankedMatch').style.display = 'block';
				document.getElementById('lobbyGameNameWrap').style.display = 'none';
			}
			e1.innerHTML = x.name;
			document.getElementById('lobbyGameMode').textContent = x.gameMode;
			if (x.password){
				document.getElementById('lobbyGamePasswordWrap').style.display = 'block';
				document.getElementById('lobbyGamePassword').innerHTML = x.password;
			}
			document.getElementById("lobbyGameMap").innerHTML = x.map;
			document.getElementById("lobbyGameMax").innerHTML = x.max;
			document.getElementById("startGame").style.display = x.player === 1 ? "block" : "none";
			if (!x.startGame){
				document.getElementById('mainWrap').style.display = "flex";
			}
			var str = '<div id="lobbyWrap">';
			for (var i=1; i<=8; i++){
				str += 
				'<div id="lobbyRow' +i+ '" class="lobbyRow">\
					<div class="lobby-row-col-1">\
						<img id="lobbyFlag' +i+ '" class="lobbyFlags block center no-select" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=">\
					</div>\
					<div class="lobby-row-col-2 lobbyDetails">\
						<div class="lobbyAccounts">';
						
							if (g.teamMode){
								// yes, the span is necessary to group the dropdown
								str += '<span><div id="lobbyTeam'+ i +'" data-placement="right" class="lobbyTeams dropdown-toggle pointer2" data-toggle="dropdown">';
								
								str += '<i class="fa fa-flag pointer2 lobbyTeamFlag"></i> <span id="lobbyTeamNumber'+ i +'" class="lobbyTeamNumbers">' + i +'</span></div>';
								str +=
								'<ul id="teamDropdown" class="dropdown-menu">\
									<li class="header text-center selectTeamHeader">'+ lang[my.lang].team +'</li>';
									for (var j=1; j<=8; j++){
										str += '<li class="teamChoice" data-player="'+ i +'">'+ lang[my.lang].team +' '+ j +'</li>';
									}
								str += '</ul></span>';
							}
							// square
							str += '<span><i id="lobbyPlayerColor'+ i +'" class="fa fa-square player'+ i +' lobbyPlayer dropdown-toggle';
							
							if (i === my.player){
								str += ' pointer2';
							}
							
							str += '" data-placement="right" data-toggle="dropdown"></i>';
							
							if (i === my.player){
								str += 
								'<ul id="teamColorDropdown" class="dropdown-menu">\
									<li class="header text-center selectTeamHeader">'+ lang[my.lang].playerColor +'</li>' +
									'<li id="team-color-flex">';
								for (var j=1; j<=20; j++){
									str += '<div class="pbar'+ j +' playerColorChoice" data-playercolor="'+ j +'"></div>';
								}
								str += '</li></ul></span>';
							}
							
							str += '<span id="lobbyAccountName'+ i +'" class="lobbyAccountName chat-warning"></span>\
						</div>\
						<div id="lobbyName' +i+ '" class="lobbyNames nowrap"></div>\
					</div>\
					<div class="lobby-row-col-3">';
					if (i === x.player){
						// my.player === i || data.cpu && my.player === 1
						// me - gov dropdown
						str += 
						'<div id="gov-dropdown-player'+ i +'" class="dropdown govDropdown">\
							<button class="btn btn-primary btn-responsive dropdown-toggle shadow4 fwDropdownButton" type="button" data-toggle="dropdown">\
								<span id="lobbyGovernment' +i+ '">'+ lang[my.lang].governments.Despotism +'</span>\
								<i id="lobbyCaret' +i+ '" class="fa fa-caret-down text-warning lobbyCaret"></i>\
							</button>\
							<ul class="governmentDropdown dropdown-menu no-select">';
								for (var key in lang[my.lang].governments) {
									str +=
									'<li class="governmentChoice" data-government="'+ key +'">'+
										'<a>'+ lang[my.lang].governments[key] +'</a>'+
									'</li>';
								}
							str += '</ul>\
						</div>' + 
						lobby.getCpuDropdown(i);
					}
					else {
						// not me - gov dropdown
						str += 
						'<div id="gov-dropdown-player'+ i +'" class="dropdown govDropdown">\
							<button style="cursor: default" class="btn btn-primary btn-responsive dropdown-toggle shadow4 fwDropdownButton fwDropdownButtonEnemy" type="button">\
								<span id="lobbyGovernment' +i+ '" class="pull-left">'+ lang[my.lang].governments.Despotism +'</span>\
								<i id="lobbyCaret' +i+ '" class="fa fa-caret-down text-disabled lobbyCaret"></i>\
							</button>\
						</div>' + 
						lobby.getCpuDropdown(i);
					}
					str += '</div>\
					</div>';
			}
			str += '</div>';
			if (my.player === 1 && !g.rankedMode){
				str +=
				'<div id="lobby-cpu-row" class="buffer2">\
					<span id="selectCpuFlag" class="dropdown">\
						<button id="cpuSelectWrap" class="btn dropdown-toggle shadow4 fwDropdownButton" \type="button" data-toggle="dropdown">\
							<span id="cpuFlag"></span>\
							<i class="fa fa-caret-down text-warning flex-caret"></i>\
						</button>\
						<ul id="cpuFlagDropdown" class="dropdown-menu fwDropdown"></ul>\
					</span>\
					<button id="cpu-add-player" type="button" class="btn fwBlue btn-responsive shadow4 cpu-button">\
						<img src="images/icons/computer.png" class="fw-icon-sm">'+ lang[my.lang].addCPU +'\
					</button>\
					<button id="cpu-remove-player" type="button" class="btn fwBlue btn-responsive shadow4 cpu-button">\
						<img src="images/icons/computer.png" class="fw-icon-sm">'+ lang[my.lang].removeCPU +'\
					</button>\
				</div>';
			}
			document.getElementById("lobbyPlayers").innerHTML = str;
			// default setting
			$('#cpuFlag').html(lang[my.lang].random);
			title.setFlagDropdown('cpuFlagDropdown', 1);
			lobby.updateGovernmentWindow(my.government);
		}
	},
	initialized: 0,
	getCpuDropdown: function(player){
		var str = 
		'<div id="gov-dropdown-cpu'+ player +'" class="dropdown govDropdown none">\
			<button class="btn btn-primary btn-responsive dropdown-toggle shadow4 fwDropdownButton" type="button" data-toggle="dropdown">\
				<img src="images/icons/computer.png" class="fw-icon-sm">\
				<span id="lobby-difficulty-cpu'+ player +'">'+ lang[my.lang].difficulties['Very Easy'] +'</span>\
				<i id="lobby-caret-cpu'+ player +'" class="fa fa-caret-down text-warning lobbyCaret"></i>\
			</button>\
			<ul class="governmentDropdown dropdown-menu no-select">';
				for (var key in lang[my.lang].difficulties){
					str += 
					'<li class="cpu-choice" data-player="'+ player +'" data-difficulty="'+ key +'">'+
						'<a>'+ lang[my.lang].difficulties[key] +'</a>'+
					'</li>';
				}
			str += '</ul>\
		</div>';
		return str;
	},
	presence: {
		list: {},
		hb: function(data) {
			data.timestamp = Date.now();
			console.log('%c lobbyHeartbeat: '+ data.account, 'background: #0f0; color: #f00');
			/*if (typeof data.account === 'undefined') {
				console.info("removePlayer: ", data.player);
				lobby.removePlayer(data);
			}
			else {*/
			if (typeof this.list[data.account] === 'undefined') {
				console.info("ADDING NEW:", data.account);
				this.add(data);
			}
			else {
				this.update(data);
			}
			this.audit(data.timestamp);
			/*}*/
		},
		add: function(data) {
			//data
			this.update(data);
			//dom
			lobby.addPlayer(data);
		},
		update: function(data) {
			this.list[data.account] = data;
			console.info("lobby: ", this.list);
		},
		remove: function(data) {
			console.log("remove: ", data);
			this.list[data.account] = void 0;
			// dom
			lobby.removePlayer(data);

		},
		audit: function(now) {
			var v;
			for (var key in this.list) {
				v = this.list[key];
				typeof v !== 'undefined' &&
					now - v.timestamp > 5000 &&
					this.remove({
						account: v.account,
						player: v.player,
					});
			}
		}
	},
	join: function(d){
		// transition to game lobby
		if (d === undefined){
			d = .5;
		}
		g.lock(1);
		g.view = "lobby";
		title.closeModal();
		TweenMax.to('header', d, {
			y: '-200%',
			ease: Quad.easeIn
		});
		TweenMax.to('#titleChat', d, {
			x: '100%',
			ease: Quad.easeIn
		});

		TweenMax.to('#titleMenu', d, {
			x: '-100%',
			ease: Quad.easeIn,
			onComplete: function(){
				TweenMax.to(['#titleMain', '#logoWrap', '#firmamentWarsLogoWrap'], .5, {
					alpha: 0,
					onComplete: function(){
						$("#titleMain, #title-bg-wrap").remove();
						g.unlock(1);
						TweenMax.fromTo('#joinGameLobby', d, {
							autoAlpha: 0
						}, {
							autoAlpha: 1
						});
						// add cpu automatically in Play Now
						title.addCpu && lobby.addCpuPlayer();
						title.addCpu = 0;

						d !== 0 && my.player !== 1 &&
							$(".lobbyRow:visible").length < 2 &&
							lobby.hostLeft();

						TweenMax.from('#lobbyRightCol', 1, {
							x: '150%'
						});
						TweenMax.from('#lobbyLeftCol', 1, {
							x: '-150%'
						})
					}
				});
			}
		});
		if (!d){
			// rejoin game
			setTimeout(loadGameState, 100); // page refresh
		}
	},
	hostLeft: function(){
		setTimeout(function(){
			g.msg(lang[my.lang].hostLeft);
			setTimeout(function(){
				exitGame(true);
			}, 1000);
		}, 500);
	},
	addPlayer: function(data) {
		data.timestamp = Date.now();
		var i = data.player;
		console.info("ADD PLAYER: ", data);

		document.getElementById("lobbyRow" + i).style.display = 'flex';
		// different player account
		document.getElementById("lobbyAccountName" + i).innerHTML = data.cpu ?
			'Computer' : data.account;
		// nation name
		if (data.cpu) {
			data.nation = data.nation.split('.')[0];
		}
		document.getElementById("lobbyName" + i).innerHTML = data.nation;
		var flag = data.flag.split('.')[0];
		document.getElementById("lobbyFlag" + i).src =
			'images/flags/'+ flag + ui.getFlagExt(flag);

		if (my.player === i && isLoggedIn){
			$("#lobbyPlayerColor" + i).attr('title', lang[my.lang].selectPlayerColor)
				.tooltip({
					container: 'body',
					animation: false
				});
			$("#lobbyTeam" + i).attr('title', lang[my.lang].selectTeam)
				.tooltip({
					container: 'body',
					animation: false
				});
		}
		console.info('LOBBY: updatePlayer', data);
		lobby.presence.list[data.account] = data;
		lobby.updateGovernment(data);
		lobby.updatePlayerColor(data);
		document.getElementById('lobbyGovernment'+ i).innerHTML = data.cpu ?
			('<img src="images/icons/computer.png" class="fw-icon-sm">'+ data.difficulty) :
			'<img src="images/icons/Despotism.png" class="fw-icon-sm">'+ lang[my.lang].governments.Despotism;

		$("#lobbyCaret"+ i)
			.removeClass("text-warning text-disabled")
			.addClass(my.player === i || data.cpu && my.player === 1 ? 'text-warning' : 'text-disabled');

		document.getElementById('gov-dropdown-player'+ data.player).style.display =
			data.cpu ? 'none' : 'block';
		document.getElementById('gov-dropdown-cpu'+ data.player).style.display =
			data.cpu ? 'block' : 'none';
		lobby.styleStartGame();
	},
	removePlayer: function(data) {
		console.info("REMOVE PLAYER: ", data);
		var i = data.player,
			account = '',
			key,
			v;
		for (key in lobby.presence.list) {
			v = lobby.presence.list[key];
			if (typeof v !== 'undefined' && v.player === i) {
				account = v.account;
			}
		}
		console.info('account: ', account)
		if (account) {
			lobby.presence.list[data.account] = void 0;
			document.getElementById("lobbyRow" + i).style.display = 'none';
			document.getElementById('lobby-difficulty-cpu' + i).innerHTML = lang[my.lang].difficulties['Very Easy'];
			lobby.styleStartGame();
			// remove in case they dropped
			if (my.player === 1) {
				$.ajax({
					type: 'POST',
					url: app.url +'php/deletePlayerFromFwplayers.php',
					data: {
						player: data.player,
					}
				});
			}
		}
	},
	getHighestCpuPlayer: function() {
		var player = 1, index = 0, v;
		for (var key in lobby.presence.list) {
			v = lobby.presence.list[key];
			index++;
			if (typeof v !== 'undefined' && v.account && v.cpu) {
				player = index;
			}
		}
		return player;
	},
	getLowestAvailablePlayer: function() {
		var index = 0;
		for (var key in lobby.presence.list) {
			index++;
		}
		return index;
	},
	getLowestAvailableColor: function() {
		var taken = [0],
			color = 0,
			index = 0,
			v;
		for (var key in lobby.presence.list) {
			v = lobby.presence.list[key];
			index++;
			if (index && v.account) {
				taken.push(v.player);
			}
		}
		g.color.forEach(function(v, i) {
			if (!color && taken.indexOf(i) === -1) {
				color = i;
			}
		});
		return color;
	},
	// update player's team number
	updateTeamNumber: function(data){
		//console.info("UPDATE TEAM NUMBER: ", data);
		var i = data.player;
		var e = document.getElementById('lobbyTeamNumber' + i);
		if (e !== null){
			e.textContent = data.team;
		}
	},
	// update player's color only
	updatePlayerColor: function(data){
		//console.info("UPDATE PLAYER COLOR ", data);
		var i = data.player;
		var str = my.player === i ? 
			'fa fa-square lobbyPlayer dropdown-toggle pointer2 player' + data.playerColor :
			'fa fa-square lobbyPlayer dropdown-toggle player' + data.playerColor;
		$("#lobbyPlayerColor" + i).removeClass()
			.addClass(str)
			.data('playerColor', data.playerColor);
		lobby.presence.list[data.account].playerColor = data.playerColor;
	},
	// update player's government only
	updateGovernment: function(data){
		// update button & window
		var i = data.player;
		console.info('updateGovernment', data.government);
		lobby.presence.list[data.account].government = data.government;
		document.getElementById('lobbyGovernment' + i).innerHTML =
			data.government === 'Random' ?
				lang[my.lang].governments[data.government] :
				'<img src="images/icons/'+ data.government +'.png" class="fw-icon-sm">' + lang[my.lang].governments[data.government];
	},
	updateDifficulty: function(data){
		var i = data.player * 1,
			account = '',
			key,
			v = lobby.presence.list;
		for (key in v) {
			if (v[key].player === i) {
				account = v[key].account;
			}
		}
		if (account) {
			console.info('updateDifficulty', data, data.difficulty);
			$('#lobby-difficulty-cpu' + i).html(lang[my.lang].difficulties[data.difficulty]);
			lobby.presence.list[account].difficulty = data.difficulty;
		}
	},
	styleStartGame: function(){
		if (my.player === 1){
			// set start game button
			if (lobby.util.countPlayers() === 1){
				startGame.className = lobby.startClassOff;
			}
			else {
				startGame.className = lobby.startClassOn;
			}
		}
	},
	countdown: function(data){
		// still in the lobby?
		if (!lobby.gameStarted || my.player === 1){
			$("#lobby-cpu-row").remove();
			lobby.gameStarted = true;
			new Audio('sound/beepHi.mp3');
			// normal countdown
			countdown.style.display = 'block';
			(function repeat(secondsToStart){
				countdown.textContent = lang[my.lang].startingGame + secondsToStart--;
				if (secondsToStart >= 0){
					audio.play('beep');
					setTimeout(repeat, 1000, secondsToStart);
				}
				else {
					audio.play('beepHi');
					audio.load.game();
					video.load.game();
				}
				if (secondsToStart === 1){
					TweenMax.to('#mainWrap', 1.5, {
						delay: 1,
						alpha: 0,
						ease: Linear.easeNone,
						onComplete: function(){
							my.player === 1 && loadGameState();
						}
					});
					audio.fade();
				}
			})(5);
			cancelGame.style.display = 'none';
			$("#teamDropdown").css('display', 'none');
		}
	},
	governmentIcon: function(p){
		var str = '';
		if (p.cpu) {
			str += '<img src="images/icons/computer.png" class="fw-icon-sm">';
		}
		else {
			str += '<img src="images/icons/'+ p.government +'.png" class="fw-icon-sm">';
		}
		return str;
	},
	getFood: function() {
		var foo = 2,
			roll = ~~(Math.random() * 20) + 1;
		if (roll >= 19){
			foo = 4;
		} else if (roll >= 14){
			foo = 3;
		}
		return foo;
	},
	getProduction: function() {
		var foo = 1,
			roll = ~~(Math.random() * 20) + 1;
		if (roll >= 19) {
			foo = ~~(Math.random() * 2) + 3;
		}
		else if (roll >= 16) {
			foo = 2;
		}
		return foo;
	},
	getCulture: function() {
		var foo = 0,
			roll = ~~(Math.random() * 20) + 1;
		if (roll >= 19){
			foo = ~~(Math.random() * 4) + 5;
		} else if (roll >= 16){
			foo = ~~(Math.random() * 2) + 3;
		} else if (roll >= 12){
			foo = 2;
		}
		return foo;
	},
	getPlayers: function() {
		var players = [{
				account: '',
				nation: '',
				flag: "blank.png",
				player: 0,
				playerColor: 0,
				team: 1,
				oBonus: 0,
				dBonus: 0,
				alive: 1,
				government: '',
			}],
			key,
			v;
		for (key in lobby.presence.list) {
			v = lobby.presence.list[key];
			typeof v !== 'undefined' && v.account && players.push(v);
		}
		console.info("getPlayers: ", players);
		return players;
	},
	getGameTiles: function() {
		var tiles = [],
			i = 0,
			key, v, t,
			len = title.mapData[g.map.key].tiles,
			startTiles = title.mapData[g.map.key].startTiles,
			tileNames = title.mapData[g.map.key].names,
			units = 0,
			barbEnabled = ~~(Math.random() * 4),
			bonusType = 0,
			food = 0,
			production = 0,
			culture = 0;

		// fwtiles
		for (; i<len; i++) {
			units = 0;
			if (i % 4 === barbEnabled) {
				units = ~~(Math.random() * 3) + 2;
			}
			food = this.getFood();
			production = this.getProduction();
			culture = this.getCulture();
			// apply barb resource bonus
			if (units) {
				bonusType = ~~(Math.random() * 2);
				if (bonusType) {
					if (culture) {
						culture += ~~(Math.random() * 2) + 2;
					}
					else if (production) {
						production += 1;
					}
					else {
						food += ~~(Math.random() * 3) + 2;
					}
				}
				else {
					food += ~~(Math.random() * 2) + 2;
				}
			}
			tiles[i] = {
				account: '',
				adj: [],
				capital: 0,
				cpu: 0,
				culture: culture,
				defense: 0,
				flag: '',
				food: food,
				name: tileNames[i],
				nation: '',
				player: 0,
				playerColor: 0,
				production: production,
				team: 0,
				units: units,
			}
		}
		// update for capitals etc
		food = 5;
		production = 4;
		culture = 8;
		for (key in lobby.presence.list) {
			v = lobby.presence.list[key];
			if (typeof v !== 'undefined') {
				var startLen = startTiles.length,
					startIndex = ~~(Math.random() * startLen - 1),
					startTile = startTiles[startIndex],
					units = 12,
					defense = 1,
					cpu = 0;

				v.start = startTile;

				startTiles.splice(startIndex, 1);

				if (v.government === 'Despotism') {
					defense = 2;
				}
				if (v.cpu === 1) {
					cpu = 1;
				}
				t = tiles[startTile];
				t.account = v.account;
				t.player = v.player;
				t.playerColor = v.playerColor;
				t.team = v.team;
				t.nation = v.nation;
				t.flag = v.flag;
				t.units = units;
				t.food = food;
				t.production = production;
				t.culture = culture;
				t.defense = defense;
				t.capital = 1;
				t.cpu = cpu;
				console.info("Setting cap: ", v.account, startTile, t);
			}
		}
		console.info("getGameTiles: ", tiles);
		return tiles;
	},
	getMyCapital: function() {
		var capital = 0, key, v;
		for (key in game.player) {
			v = game.player[key];
			if (typeof v !== 'undefined') {
				if (v.start && v.player === my.player) {
					capital = v.start;
				}
			}
		}
		return capital;
	},
	setCapitalData: function() {
		var capitalTiles = [];
		for (var key in game.tiles) {
			if (game.tiles[key].capital &&
				game.tiles[key].player) {
				capitalTiles.push(key * 1);
			}
		}
		my.capital = lobby.getMyCapital();
		$.ajax({
			url: app.url +'php/set-capital-data.php',
			data: {
				capital: my.capital,
				capitalTiles: capitalTiles,
			}
		});
		return capitalTiles;
	},
	rxGameInit: function(data) {
		console.info("rxGameInit", data);
		// game tiles
		game.tiles = data.tiles;
		localStorage.setItem('fwtiles', JSON.stringify(game.tiles));
		// game players
		game.player = data.players;
		localStorage.setItem('fwplayers', JSON.stringify(game.player));
		this.setCapitalData(data);
	},
	startGame: function(){
		if (my.player === 1){
			if (lobby.util.countPlayers() >= 2){
				g.lock();
				audio.play('click');
				lobby.gameStarted = true;
				startGame.style.display = "none";
				cancelGame.style.display = 'none';
				$.ajax({
					type: 'GET',
					url: app.url +"php/startGame.php"
				}).done(function() {
					// send tile data
					setTimeout(function() {
						var players = lobby.getPlayers(),
							tiles = lobby.getGameTiles();
						$.ajax({
							url: app.url +"php/send-game-init.php",
							data: {
								tiles: JSON.stringify(tiles),
							}
						}).done(function(data) {
							console.info("send-game-init.php", data);
						});
						socket.zmq.publish('game:' + game.id, {
							type: 'send-game-init',
							tiles: tiles,
							players: players
						});
					}, 3500);
				}).fail(function(data){
					g.msg(data.statusText);
					startGame.style.display = "block";
					cancelGame.style.display = 'block';
				}).always(g.unlock);
			}
			else {
				g.msg(lang[my.lang].needTwoPlayers, 5);
			}
		}
	}
};

function initOffensiveTooltips(){
	if (isLoggedIn){
		$('#fireCannons')
			.attr('title', ui.cannonTooltip())
			.tooltip('fixTitle')
			.tooltip({ animation: false });
		$('#launchMissile')
			.attr('title', ui.missileTooltip()).tooltip('fixTitle')
			.tooltip({ animation: false });
		$('#rush')
			.attr('title', ui.rushTooltip())
			.tooltip('fixTitle')
			.tooltip({ animation: false });
	}
}
function initResources(d){
	my.food = d.food;
	my.production = d.production;
	my.culture = d.culture;
	// current
	DOM.moves.textContent = d.moves;
	DOM.production.textContent = d.production;
	DOM.food.textContent = d.food;
	DOM.culture.textContent = d.culture;
	// turn
	// max
	DOM.manpower.textContent = my.manpower;
	my.manpower = d.manpower;
	DOM.foodMax.textContent = d.foodMax;
	DOM.cultureMax.textContent = d.cultureMax;
	// sum
	//DOM.sumFood.textContent = d.sumFood;
	//DOM.sumProduction.textContent = d.sumProduction;
	//DOM.sumCulture.textContent = d.sumCulture;
	// bonus values
	DOM.oBonus.textContent = d.oBonus;
	DOM.dBonus.textContent = d.dBonus;
	DOM.productionBonus.textContent = d.productionBonus;
	DOM.foodBonus.textContent = d.foodBonus;
	DOM.cultureBonus.textContent = d.cultureBonus;
	setBars(d);
}
function setMoves(d){
	if (d.moves !== undefined){
		my.moves = d.moves;
		DOM.moves.textContent = d.moves;
		if (d.sumMoves){
			//DOM.sumMoves.textContent = d.sumMoves;
		}
		// DOM.endTurn.style.visibility = my.moves ? 'visible' : 'hidden';
	}
}
function setProduction(d){
	if (d.production !== undefined){
		TweenMax.to(my, .3, {
			production: d.production,
			ease: Quad.easeIn,
			onUpdate: function(){
				DOM.production.textContent = ~~my.production;
			}
		});
	}
}
function setManpower(d) {
	if (d.manpower !== undefined){
		if (d.manpower > my.manpower){
			TweenMax.fromTo('#manpower', .5, {
				color: '#ffaa33'
			}, {
				color: '#ffff00',
				repeat: -1,
				yoyo: true

			});
			TweenMax.to(my, .5, {
				manpower: d.manpower,
				onUpdate: function(){
					DOM.manpower.textContent = ~~my.manpower;
				}
			});
		} else {
			my.manpower = d.manpower;
			DOM.manpower.textContent = my.manpower;
		}
	}
}
function setResources(d){
	//console.info(d);
	setMoves(d);
	setProduction(d);
	TweenMax.to(my, .3, {
		food: d.food === undefined ? my.food : d.food,
		culture: d.culture === undefined ? my.culture : d.culture,
		ease: Quad.easeIn,
		onUpdate: function(){
			DOM.food.textContent = ~~my.food;
			DOM.culture.textContent = ~~my.culture;
		}
	});
	setManpower(d);
	if (d.foodMax !== undefined){
		if (d.foodMax && d.foodMax > my.foodMax){
			DOM.foodMax.textContent = d.foodMax;
			my.foodMax = d.foodMax;
		}
	}
	if (d.cultureMax !== undefined){
		if (d.cultureMax && d.cultureMax > my.cultureMax){
			DOM.cultureMax.textContent = d.cultureMax;
			my.cultureMax = d.cultureMax;
		}
	}
	/*if (d.sumFood !== undefined){
		if (d.sumFood && d.sumFood !== my.sumFood){
			//DOM.sumFood.textContent = d.sumFood;
			my.sumFood = d.sumFood;
		}
	}
	if (d.sumProduction !== undefined){
		if (d.sumProduction && d.sumProduction !== my.sumProduction){
			//DOM.sumProduction.textContent = d.sumProduction;
			my.sumProduction = d.sumProduction;
		}
	}
	if (d.sumCulture !== undefined){
		if (d.sumCulture && d.sumCulture !== my.sumCulture){
			//DOM.sumCulture.textContent = d.sumCulture;
			my.sumCulture = d.sumCulture;
		}
	}*/
	// bonus values
	if (d.oBonus !== undefined){
		if (my.oBonus !== d.oBonus){
			DOM.oBonus.textContent = d.oBonus;
			my.oBonus = d.oBonus;
			initOffensiveTooltips();
		}
	}
	if (d.dBonus !== undefined){
		if (my.dBonus !== d.dBonus){
			DOM.dBonus.textContent = d.dBonus;
			my.dBonus = d.dBonus;
		}
	}
	if (d.productionBonus !== undefined){
		if (my.productionBonus !== d.productionBonus){
			DOM.productionBonus.textContent = d.productionBonus;
			my.productionBonus = d.productionBonus;
		}
	}
	if (d.foodBonus !== undefined){
		if (my.foodBonus !== d.foodBonus){
			DOM.foodBonus.textContent = d.foodBonus;
			my.foodBonus = d.foodBonus;
		}
	}
	if (d.cultureBonus !== undefined){
		if (my.cultureBonus !== d.cultureBonus){
			DOM.cultureBonus.textContent = d.cultureBonus;
			my.cultureBonus = d.cultureBonus;
			// rush bonus changes
			initOffensiveTooltips();
		}
	}
	setBars(d);
}
function setBars(d){
	// animate bars
	TweenMax.to(DOM.foodBar, .3, {
		width: ((d.food / d.foodMax) * 100) + '%'
	});
	TweenMax.to(DOM.cultureBar, .3, {
		width: ((d.culture / d.cultureMax) * 100) + '%'
	});
}

function loadGameState(){
	sessionStorage.setItem('gameDuration', Date.now());
	g.lock(1);
	var e1 = document.getElementById("mainWrap");
	if (e1 !== null){
		TweenMax.to(e1, .5, {
			alpha: 0
		});
	}
	// load map
	DOM.worldWrap.innerHTML = maps.getMap(g.map.key);

	// init map DOM stuff here
	// programmatically set land elements' id and class
	var e = document.querySelectorAll('#landWrap > path');

	for (var i=0, len = e.length; i<len; i++) {
		e[i].setAttributeNS(null, 'id', 'land'+i);
		e[i].setAttributeNS(null, 'class', 'land');
	}

	// programmatically set text elements' id and class
	e = document.querySelectorAll('text');
	for (i=0, len = e.length; i<len; i++) {
	  	e[i].setAttributeNS(null, 'id', 'unit'+i);
	  	e[i].setAttributeNS(null, 'class', 'unit');
	}
	initDom();
	$("#leaderboard, #configureNation, joinPrivateGameModal, #createGameWrap").remove();

	// console.info("SENDING: ", playerData);
	$.ajax({
		type: 'GET',
		url: app.url +"php/loadGameState.php",
	}).done(function(data){

		if (sessionStorage.getItem('fwstats') === null) {
			stats.initStats();
		}
		else {
			// load if it's there
			stats.data = JSON.parse(sessionStorage.getItem('fwstats'));
		}
		localStorage.setItem('disconnects', 1);

		console.info("loadGameState", data);
		// data.mapData.sizeX data.mapData.sizeX
		document.getElementById('world')
			.setAttribute('viewBox', '0 0 ' + data.mapData.sizeX + ' ' + data.mapData.sizeY);

		$("#login-modal, meta").remove();
		setTimeout($("#title-bg-wrap").remove, 2000);

		g.resourceTick = data.resourceTick;
		g.startGame = data.startGame * 1;
		g.teamMode = data.teamMode;
		g.gameMode = data.gameMode;
		// set map data
		g.map.sizeX = data.mapData.sizeX;
		g.map.sizeY = data.mapData.sizeY;
		g.map.name = title.mapData[g.map.key].name;
		g.map.tiles = title.mapData[g.map.key].tiles;
		g.map.tileNames = title.mapData[g.map.key].names;

		/*if (data.tiles.length < g.map.tiles){
			console.warn(data.tiles.length, g.map.tiles);
			if (g.loadAttempts < 20){
				setTimeout(function(){
					g.loadAttempts++;
					loadGameState(); // try again
				}, 500);
			}
			else {
				g.msg(lang[my.lang].failedToLoad);
				setTimeout(function(){
					window.onbeforeunload = null;
					location.reload();
				}, 3000);
			}
			return;
		}*/
		g.screen.resizeMap();
		audio.gameMusicInit();
		// only when refreshing page while testing
		audio.load.game();
		video.load.game();
		// done
		my.player = data.player;
		my.team = data.team;
		// my.account = data.account;
		my.oBonus = data.oBonus;
		my.dBonus = data.dBonus;
		my.cultureBonus = data.cultureBonus;
		my.tech = data.tech;
		my.flag = data.flag;
		my.nation = data.nation;
		my.foodMax = data.foodMax;
		my.production = data.production;
		my.sumProduction = data.sumProduction;
		my.cultureMax = data.cultureMax;
		my.moves = data.moves;
		my.government = data.government;
		my.cannonBonus = data.cannonBonus;
		lobby.updateGovernmentWindow(my.government);
		// global government bonuses
		if (my.government === 'Monarchy'){
			my.cannonsBonus = 2;
		}
		else if (my.government === 'Democracy'){
			my.maxDeployment = 48;
		}
		else if (my.government === 'Republic'){
			my.sumMoves = data.sumMoves;
			document.getElementById('moves').textContent = my.sumMoves;
			// DOM.sumMoves.textContent = my.sumMoves;
			//console.info('sumMoves ', my.government, my.sumMoves, data.sumMoves);
		}
		else if (my.government === 'Fascism'){
			document.getElementById('moves').textContent = 8;
			my.deployCost = 1;
			document.getElementById('deployCost').textContent = my.deployCost;
		}
		// initialize player data
		game.initialized = true;
		if (g.reloadGame) {
			// did not find lobby data
			game.player = JSON.parse(localStorage.getItem('fwplayers'));
			game.tiles = JSON.parse(localStorage.getItem('fwtiles'));
		}
		my.capital = lobby.getMyCapital();

		g.removeContainers();
		g.unlock();
		g.view = "game";
		TweenMax.fromTo(gameWrap, 1, {
			autoAlpha: 0
		}, {
			autoAlpha: 1
		});

		// initialize client tile data
		var now = Date.now(), d, i;
		for (i=0, len=game.tiles.length; i<len; i++){
			d = game.tiles[i];
			d.adj = data.adj[i];
			d.timestamp = now;

			// init flag unit values
			var zig = document.getElementById('unit' + i);
			if (zig !== null){
				var unitVal = game.tiles[i].capital ?
					'<tspan class="unit-star">&#10028;</tspan>' + d.units :
					d.units;
				zig.innerHTML = d.units === 0 ? 0 : unitVal;
				if (d.units){
					zig.style.visibility = 'visible';
				}
			}
			if (d.player){
				// init map appearance
				TweenMax.set('#land' + i, {
					fill: g.color[game.player[d.player].playerColor],
					stroke: g.color[game.player[d.player].playerColor],
					strokeWidth: 1,
					onComplete: function(){
						if (d.player){
							TweenMax.set(this.target, {
								stroke: "hsl(+=0%, +=0%, -=30%)"
							});
						}
					}
				});
			}
		}
		g.tileCount = len;
		var svgTgt = document.getElementById('targetCrosshair');
		TweenMax.to(svgTgt, 10, {
			force3D: true,
			transformOrigin: '50% 50%',
			rotation: 360,
			repeat: -1,
			ease: Linear.easeNone
		});
		//lobby.initRibbons(data.ribbons);
		ui.drawDiplomacyPanel();
		initResources(data);
		// set images
		setTimeout(function(){
			// init draggable map
			worldMap = Draggable.create(DOM.worldWrap, {
				minimumMovement: 6,
				type: 'top,left',
				bounds: DOM.gameWrap,
				edgeResistance: 1,
				throwProps: true,
				onDrag: function(e) {
					setMousePosition(e.offsetX, e.offsetY);
				}
			});

			initOffensiveTooltips();
			TweenMax.set(DOM.targetLine, {
				stroke: g.color[game.player[my.player].playerColor]
			});
			TweenMax.set(DOM.targetLine, {
				stroke: "hsl(+=0%, +=0%, -=5%)"
			});
			TweenMax.set(DOM.arrowheadTip, {
				fill: g.color[game.player[my.player].playerColor]
			});
			TweenMax.set(DOM.arrowheadTip, {
				fill: "hsl(+=0%, +=0%, -=5%)"
			});

			// map events
			$("#gameWrap").on('click', '.land', function(e){
				//location.host === 'localhost' && console.info(this.id, e.offsetX, e.offsetY);
				action.triggerAction(this, e);
			}).on("mouseenter", '.land', function(){
				my.lastTarget = this;
				if (my.attackOn){
					ui.showTarget(this, true);
				}
				TweenMax.set(this, {
					fill: "hsl(+=0%, +=0%, -=5%)"
				});
			}).on("mouseleave", '.land', function(){
				var land = this.id.slice(4)*1;
				if (game.tiles.length > 0){
					var player = game.tiles[land] !== undefined ? game.tiles[land].player : 0,
						fillNum = player ? game.player[player].playerColor : 0;
					TweenMax.set(this, {
						fill: g.color[fillNum]
					});
				}
			});

			// focus on player home
			my.focusTile(my.capital);
			// add warning for players
			game.startGameState();
			ui.setCurrentYear(data.resourceTick);
			animate.paths();
			action.setMenu();
			ui.updateTileInfo(my.lastTgt);
			game.setVisibilityAll();
			// language width adjustment
			document.getElementById('resources-ui').style.width = lang[my.lang].resourceUiWidth;
		}, 350);
		/*TweenMax.set('.land', {
			filter: 'url(#emboss)'
		})*/
		// init map flags
		var a = document.querySelectorAll('#world text'),
			mapFlagWrap = document.getElementById('mapFlagWrap');
		for (var i=0, len=a.length; i<len; i++){
			// set flag position and value
			var t = game.tiles[i],
				x = a[i].getAttribute('x') - 20,
				y = a[i].getAttribute('y') - 30,
				flag = 'blank.png';

			if (t !== undefined){
				if (!t.flag && t.units){
					flag = "Barbarian.jpg";
				}
				else if (t.flag){
					flag = t.flag;
				}
			}
			flag = flag.split('.')[0];
			flag = flag + ui.getFlagExt(flag);
			// dynamically add svg flag image to the map
			var svg = document.createElementNS('http://www.w3.org/2000/svg', 'image');
			svg.id = 'flag' + i;
			svg.setAttributeNS(null, 'height', 40);
			svg.setAttributeNS(null, 'width', 40);
			svg.setAttributeNS(null,"x",x);
			svg.setAttributeNS(null,"y",y);
			svg.setAttributeNS(null,"class","mapFlag");
			svg.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', 'images/flags/' + flag);
			mapFlagWrap.appendChild(svg);
		}

		// init map DOM elements
		game.initMap();
		// food, culture, def bars
		for (var i=0; i<len; i++){
			animate.initMapBars(i);
		}
	}).fail(function(data){
		console.info(data);
		setTimeout(loadGameState, 1500);
	}).always(function(){
		g.unlock();
	});
};
// ws.js 
// client-side web sockets
var socket = {
	receive: {
		title: function(data) {
			if (data.type === 'hb'){
				title.presence.hb(data);
			}
			else if (data.type === 'remove'){
				title.presence.remove(data.account);
			}
			else if (data.type === 'add'){
				title.presence.add(data);
			}
			else {
				if (data.message !== void 0){
					if (g.ignore.indexOf(data.account) === -1) {
						title.chat(data);
					}
				}
			}
		},
		lobby: function(data) {
			// console.info("LOBBY: ", data);
			if (data.type === 'hb'){
				lobby.presence.hb(data);
			}
			else if (data.type === 'hostLeft'){
				lobby.hostLeft();
			}
			else if (data.type === 'lobby-set-cpu-difficulty'){
				lobby.updateDifficulty(data);
			}
			else if (data.type === 'updateGovernment'){
				lobby.updateGovernment(data);
			}
			else if (data.type === 'updatePlayerColor'){
				lobby.updatePlayerColor(data);
			}
			else if (data.type === 'updateTeamNumber'){
				lobby.updateTeamNumber(data);
			}
			else if (data.type === 'countdown'){
				lobby.countdown(data);
			}
			else if (data.type === 'send-game-init'){
				lobby.rxGameInit(data);
			}
			else if (data.type === 'updateLobbyAdd'){
				lobby.addPlayer(data);
			}
			else if (data.type === 'updateLobbyRemove'){
				lobby.removePlayer(data);
			}
			else if (data.type === 'loadGameState'){
				// trigger game start for non-hosts
				my.player !== 1 && loadGameState();
			}
			else {
				if (data.message !== void 0){
					if (g.ignore.indexOf(data.account) === -1) {
						lobby.chat(data);
					}
				}
			}
		},
		game: function(data) {
			if (data.type === 'hb'){
				game.presence.hb(data);
			}
			else if (data.type === 'statUpdate') {
				stats.update(data);
			}
			else if (data.type === 'cannons'){
				animate.cannons(data.attackerTile, data.tile, true);
				game.updateTile(data);
			} else if (data.type === 'missile'){
				animate.missile(data.attacker, data.defender, true);
			} else if (data.type === 'nuke'){
				setTimeout(function(){
					animate.nuke(data.tile, data.attacker);
				}, 5000);
			} else if (data.type === 'nukeHit'){
				game.updateTile(data);
				game.updateDefense(data);
			} else if (data.type === 'gunfire'){
				// defender tile update
				var volume = data.player === my.player || data.playerB === my.player ?
					.7 : .2;
				animate.gunfire(data.attackerTile, data.tile, volume);
				game.updateTile(data);
				if (data.rewardUnits){
					animate.upgrade(data.tile, 'troops', data.rewardUnits);
				}
			}
			else if (data.type === 'updateTile'){
				// attacker tile update
				game.updateTile(data);
				game.setSumValues();
				if (data.rewardUnits){
					animate.upgrade(data.tile, 'troops', data.rewardUnits);
				}
				if (data.sfx === 'sniper0'){
					animate.upgrade(data.tile, 'culture');
				}
			}
			else if (data.type === 'democracy-units') {
				my.player === data.player && action.democracyUnits();
			}
			else if (data.type === 'food'){
				if (data.account.indexOf(my.account) > -1){
					audio.play('hup2');
				}
			}
			else if (data.type === 'upgrade'){
				// fetch updated tile defense data
				game.updateDefense(data);
				animate.upgrade(data.tile, 'shield');
			}
			else if (data.type === 'eliminated'){
				console.info("Eliminated rx!", data);
				game.eliminatePlayer(data);
			}
			// avoid double message
			if (data.type !== 'eliminated' &&
				data.message){
				if (data.type === 'gunfire'){
					// ? when I'm attacked?
					if (data.defender === my.account){
						// display msg?
						game.chat(data);
					}
					// lost attack
				}
				else {
					if (g.ignore.indexOf(data.account) === -1){
						game.chat(data);
					}
				}
			}
			if (data.sfx){
				audio.play(data.sfx);
			}
		},
		stats: function() {
			// future use?
		}
	},
	publish: {
		// remove this account for all players in title
		title: {
			remove: function(account) {
				socket.zmq.publish('title:' + my.channel, {
					type: 'remove',
					account: account
				});
				title.players[account] = void 0;
			}
		},
		lobby: {

		}
	},
	initialConnection: true,
	unsubscribe: function(channel){
		try {
			socket.zmq.unsubscribe(channel);
		} catch(err){
			// console.info(err);
		}
	},
	setChannel: function(channel, bypass){
		// change channel on title screen
		if (g.view === 'title'){
			// remove from channel
			channel = channel.trim();
			console.info("CHANNEL: ", channel);
			// first character must be alphanumeric
			if (!channel) {
				g.chat("That channel name is not valid. Channel names may only contain alphanumeric values.");
			}
			else if (bypass || channel !== my.channel){
				socket.publish.title.remove(my.account);
				$.ajax({
					type: "POST",
					url: app.url + "php/titleChangeChannel.php",
					data: {
						channel: channel
					}
				}).done(function(data){
					// removes id
					title.presence.remove(my.account);
					// unsubs
					socket.unsubscribe('title:' + my.channel);
					// set new channel data
					my.channel = data.channel;
					console.info("Changed channel: ", my.channel);
					localStorage.setItem('channel', my.channel);
					title.presence.reset();
					data.skip = true;
					data.message = lang[my.lang].joinedChannel + data.channel;
					data.type = "chat-warning";
					// send message to my chat log
					title.chat(data);
					socket.zmq.subscribe('title:' + my.channel, function(topic, data) {
						socket.receive[g.view](data);
					});
					// update display of channel
					if (g.view === 'title'){
						title.presence.setHeader();
						document.getElementById('titleChatBody').innerHTML = '';
					}
					// update browser hash
					location.hash = my.channel;
				}).fail(function() {
					g.chat("That channel name is not valid.");
				});
			}
		}
	},
	enableHeartbeat: function() {
		clearInterval(this.sendHeartbeatInterval);
		this.sendHeartbeatInterval = setInterval(this.sendHeartbeat, 1000);
	},
	enableWhisper: function(){
		var channel = 'account:' + my.account;
		socket.zmq.subscribe(channel, function(topic, data) {
			if (data.message){
				if (data.action === 'send'){
					console.info("SENT: ", data.playerColor, data);
					// message sent to user
					var flag = my.flag.split(".");
					flag = flag[0].replace(/ /g, "-");
					my.lastReceivedWhisper = data.account;
					$.ajax({
						url: app.url + 'php/insertWhisper.php',
						data: {
							action: "receive",
							flag: data.flag,
							playerColor: data.playerColor,
							account: data.account,
							message: data.message
						}
					});
					data.type = 'chat-whisper';
					data.msg = data.message;
					data.message = data.chatFlag + data.account + lang[my.lang].whispers + data.message;
					title.receiveWhisper(data);
				}
				else {
					// message receive confirmation to original sender
					console.info("CALLBACK: ", data);
					if (data.timestamp - title.lastWhisper.timestamp < 500 &&
						data.account === title.lastWhisper.account &&
						data.message === title.lastWhisper.message){
						// skip message
					}
					else {
						// reference values to avoid receiving double messages when a player is in the lobby multiple times
						// this causes multiple response callbacks
						title.lastWhisper.account = data.account;
						title.lastWhisper.timestamp = data.timestamp;
						title.lastWhisper.message = data.message;
						// send message
						data.msg = data.message;
						data.message = data.chatFlag + lang[my.lang].to + data.account + ': ' + data.message;
						data.type = 'chat-whisper';
						title.receiveWhisper(data);
					}
				}
			}
			else {
				// callback for friend status
				// console.info(data.type, data);
				if (data.type === 'callback-friend-tx') {
					// sending to friends
					var status = '';
					if (g.view === 'title') {
						status = ' in chat channel: <span class="chat-online chat-join">' + my.channel + '</span>';
					}
					else {
						status = ' playing in game: ' + game.name;
					}
					socket.zmq.publish('account:'+ data.account, {
						account: my.account,
						type: 'callback-friend-rx',
						status: status,
					});
				}
				else {
					// receiving from friends
					console.info("callback-friend-rx RECEIVING: ", data);
					title.friendStatus[data.account] = [
						'<span class="chat-online titlePlayerAccount">',
						data.account,
						'</span>' + data.status
					].join('');
				}
			}
		});
	},
	sendHeartbeatInterval: 0,
	socketSendTime: 0,
	sendHeartbeat: function() {
		socket.socketSendTime = Date.now();
		if (socket.enabled) {
			if (g.view === 'title') {
				socket.zmq.publish('title:' + my.channel, {
					type: 'hb',
					account: my.account,
					flag: my.flag,
					rating: my.rating
				});
			}
			else if (g.view === 'lobby') {
				// update lobby player presence
				socket.zmq.publish('game:' + game.id, {
					type: 'hb',
					account: my.account,
					alive: 1,
					nation: my.nation,
					flag: my.flag,
					player: my.player,
					playerColor: my.playerColor,
					oBonus: 0,
					dBonus: 0,
					team: my.team,
					government: my.government,
					gameHost: my.player === 1 ? 1 : 0,
					difficulty: '',
					cpu: 0
				});
				// update CPU lobby presence
				if (my.player === 1) {
					var v, key;
					for (key in lobby.presence.list) {
						v = lobby.presence.list[key];
						if (typeof v !== 'undefined' && v.cpu) {
							socket.zmq.publish('game:' + game.id, {
								type: 'hb',
								account: v.account,
								alive: 1,
								nation: v.nation,
								flag: v.flag,
								player: v.player,
								playerColor: v.playerColor,
								oBonus: 0,
								dBonus: 0,
								team: v.team,
								government: v.government,
								gameHost: 0,
								difficulty: v.difficulty,
								difficultyShort: v.difficulty.replace(/ /g, ''),
								cpu: 1
							});
						}
					}

					// update title screen games
					if (!lobby.gameStarted &&
						!game.password &&
						game.mode !== 'Ranked') {
						// only broadcast public games
						socket.zmq.publish('title:refreshGames', {
							id: game.id,
							name: game.name,
							gameMode: game.mode,
							map: g.map.name,
							max: title.mapData[g.map.key].players,
							players: lobby.util.countPlayers(),
							type: 'updateToGame'
						});
					}
				}
			}
			else if (g.view === 'game') {
				socket.zmq.publish('game:' + game.id, {
					type: 'hb',
					player: my.player,
					account: my.account,
					playerColor: my.playerColor,
					team: my.team,
					nation: my.nation,
					flag: my.flag,
					government: my.government,
					cpu: 0
				});
			}
		}
	},
	joinGame: function(){
		(function repeat(){
			if (socket.enabled){
				socket.connectGame();
			}
			else {
				setTimeout(repeat, 100);
			}
		})();
	},
	connectGame: function() {
		socket.unsubscribe('title:' + my.channel);
		socket.unsubscribe('game:' + game.id);
		socket.unsubscribe('title:refreshGames');
		title.presence.reset();
		// game updates
		// console.info("Subscribing to game:" + game.id);
		socket.zmq.subscribe('game:' + game.id, function(topic, data) {
			socket.receive[g.view](data);
		});
	},
	enabled: false,
	init: function(){
		// is player logged in?
		socket.zmq = new ab.Session('wss://' + app.socketUrl + '/wss2/',
			socket.connectionSuccess,
			socket.reconnect, {
			// options
			'skipSubprotocolCheck': true
		});
	},
	connectionSuccess: function(){
		socket.enabled = true;
		console.info("Socket connection established with server");
		// chat updates
		if (g.view === 'title'){
			socket.zmq.subscribe('title:refreshGames', function(topic, data) {
				console.info("title:refreshGames", data);
				title.updateGame(data);
			});
			socket.setChannel(my.channel, true); // should be usa-1
		}
		else if (g.view === 'lobby') {
			socket.connectGame();
		}
		else if (g.view === 'game'){
			socket.connectGame();
			// game.getGameState();
		}
		socket.zmq.subscribe('admin:broadcast', function(topic, data) {
			if (data.msg){
				g.chat(data.msg, data.type);
			}
			else if (data.category === 'close-app') {
				title.exitGame();
			}
		});
		(function repeat(){
			if (my.account){
				// do this stuff once we detect account data
				socket.enableWhisper();
				setInterval(console.clear, 300000); // 5 min
				socket.enableHeartbeat();
			}
			else {
				setTimeout(repeat, 100);
			}
		})();
		g.unlock();
	},
	connectionTries: 0,
	connectionRetryDuration: 100,
	reconnect: function(){
		console.warn('WebSocket connection failed. Retrying...');
		socket.zmq = void 0;
		socket.enabled = false;
		setTimeout(socket.init, socket.connectionRetryDuration);
	}
}
// audio.js
var audio = {
	ext: (function(a){
		return !!(a.canPlayType && a.canPlayType('audio/mpeg;').replace(/no/, '')) ? 'mp3' : 'ogg'
	})(document.createElement('audio')),
	on: (function(a){
		return !!a.canPlayType ? true : false;
	})(document.createElement('audio')),
	play: function(foo, bg, audioMod){
		if (foo) {
			if (bg){
				// music
				DOM.bgmusic.pause();
				DOM.bgmusic.src = "music/" + foo + ".mp3";
				DOM.bgmusic.volume = g.config.audio.musicVolume / 100;
			} else {
				// sfx
				var sfx = new Audio("sound/" + foo + ".mp3"),
					mod = audioMod || 1;
				sfx.volume = mod * (g.config.audio.soundVolume / 100);
				sfx.play();
			}
		}
	},
	save: function(){
		// save to storage
		var foo = JSON.stringify(g.config); 
		localStorage.setItem('config', foo);
	},
	setMusicVolume: function(val){
		if (g.config.audio.musicVolume){
			if (!val){
				audio.pause();
			}
		} else {
			// start playing music
			audio.musicStart();
		}
		DOM.bgmusic.volume = val / 100;
		g.config.audio.musicVolume = val;
		audio.save();
	},
	setSoundVolume: function(val){
		g.config.audio.soundVolume = val;
		audio.save();
	},
	pause: function(){
		DOM.bgmusic.pause();
	},
	gameMusicInit: function(){
		if (g.config.audio.musicVolume){
			audio.pause();
			DOM.bgmusic.loop = false;
			audio.gameMusicPlayNext();
		}
	},
	// rotating music tracks in game
	trackIndex: ~~(Math.random() * 8),
	tracks: [
		'BehindTheShield',
		'DeceptionPoint',
		'HeroicReturn',
		'HeartOfChampions',
		'LeadingTheCharge',
		'RiseAgainstTheMachine',
		'TheAssault',
		'WithGreatPower'
	],
	gameMusicPlayNext: function(){
		// FIX IT SO IT USES BGAUDIO
		audio.totalTracks = audio.tracks.length;
		var nowPlaying = audio.tracks[++audio.trackIndex % audio.totalTracks];
		DOM.bgmusic.pause();
		DOM.bgmusic.src = "music/" + nowPlaying +".mp3";
		DOM.bgmusic.volume = g.config.audio.musicVolume / 100;
		DOM.bgmusic.onended = function(){
			audio.gameMusicPlayNext();
		}
	},
	fade: function(){
		var x = {
			vol: g.config.audio.musicVolume / 100
		}
		TweenMax.to(x, 2.5, {
			vol: 0,
			ease: Linear.easeNone,
			onUpdate: function(){
				DOM.bgmusic.volume = x.vol;
			}
		});
	},
	move: function(){
		audio.play('march' + ~~(Math.random()*3));
	},
	deploy: function(){
		audio.play('deploy' + ~~(Math.random()*3));
	},
	cache: {},
	load: {
		title: function(){
			var x = [
				'click', 
				'beep'
			];
			for (var i=0, len=x.length; i<len; i++){
				var z = x[i];
				audio.cache[z] = new Audio("sound/" + z + ".mp3");
			}
		},
		game: function(){
			var x = [
				'machine0',
				'machine1',
				'machine2',
				'machine3',
				'machine4',
				'machine5',
				'machine6',
				'machine7',
				'machine8',
				'machine9',
				'march0',
				'march1',
				'march2',
				'deploy0',
				'deploy1',
				'deploy2',
				'chat', 
				'hup2', 
				'cheer3',
				'culture',
				'error',
				'build',
				'grenade5',
				'grenade6',
				'grenade8',
				'missile7',
				'bomb9',
				'warning',
				'research'
			];
			for (var i=0, len=x.length; i<len; i++){
				var z = x[i];
				audio.cache[z] = new Audio("sound/" + z + ".mp3");
			}
		}
	},
	musicStart: function(){
		if (g.view !== 'game'){
			audio.play("ReturnOfTheFallen", 1);
			//audio.play("WaitingBetweenWorlds", 1);
		} else {
			audio.gameMusicPlayNext();
		}
	}
}
audio.init = (function(){
	// console.info("Checking local data...");
	var config = localStorage.getItem('config');
	if (config === null){
		// initialize
		audio.save();
	} else {
		var foo = JSON.parse(config);
		if (g.config.audio.musicOn === undefined){
			g.config.audio = foo.audio;
		}
	}
	// console.info("Initializing audio...", g.config.audio);
	audio.load.title();
	if (!g.config.audio.musicVolume){
		audio.pause();
	} else {
		audio.musicStart();
	}
	var initComplete = false;
	var e = $("#musicSlider");
	if (e.length){
		e.slider({
			min  : 0, 
			max  : 100,
			formatter: function(value) {
				if (initComplete){
					audio.setMusicVolume(value);
					return value;
				} else {
					return g.config.audio.musicVolume;
				}
			}
		}).slider('setValue', g.config.audio.musicVolume);
	}
	$("#soundSlider").slider({
		min  : 0, 
		max  : 100, 
		value: g.config.audio.soundVolume, 
		tooltip_position: 'bottom',
		formatter: function(value) {
			if (initComplete){
				audio.setSoundVolume(value);
				return value;
			} else {
				return g.config.audio.soundVolume
			}
		}
	}).on('slideStop', function(val){
		audio.play('machine0', null, .7);
	}).slider('setValue', g.config.audio.soundVolume);
	initComplete = true;
})();
// map.js
// map zooming and scrolling
function mouseZoomDone() {
	if (g.mouse.zoom === 100) {
		TweenMax.set(DOM.worldWrap, {
			transformOrigin: '50% 50%',
			force3D: false
		})
	}
	applyBounds();
}
function applyBounds() {
	typeof worldMap[0] === 'object' && worldMap[0].applyBounds();
}
function mouseZoomIn(e){
	setMousePosition(e.originalEvent.layerX, e.originalEvent.layerY);
	if (g.mouse.zoom >= 100) return;
	g.mouse.zoom += 5;
	if (g.mouse.zoom >= 100){
		g.mouse.zoom = 100;
	}
	TweenMax.to(DOM.worldWrap, .3, {
		transformOrigin: g.mouse.x + "px " + g.mouse.y + "px",
		force3D: true,
		scale: g.mouse.zoom / 100,
		onUpdate: function() {
			applyBounds()
		},
		onComplete: function() {
			mouseZoomDone()
		}
	});
}
function mouseZoomOut(e){
	setMousePosition(e.originalEvent.layerX, e.originalEvent.layerY);
	if (g.mouse.zoom <= 50) return;
	g.mouse.zoom -= 5;
	if (g.mouse.zoom <= 50){
		g.mouse.zoom = 50;
	}
	TweenMax.to(DOM.worldWrap, .3, {
		transformOrigin: g.mouse.x + "px " + g.mouse.y + "px",
		force3D: true,
		scale: g.mouse.zoom / 100,
		onUpdate: function() {
			applyBounds()
		},
		onComplete: function() {
			mouseZoomDone()
		}
	});
}
function setMousePosition(X, Y){
	g.mouse.x = X;
	g.mouse.y = Y;
}
// actions.js
function Target(o){
	if (o === undefined){
		o = {};
	}
	this.cost = o.cost !== undefined ? o.cost : 2;
	this.minimum = o.minimum !== undefined ? o.minimum : 2;
	this.attackName = o.attackName ? o.attackName : 'attack';
	this.splitAttack = o.splitAttack ? o.splitAttack : false;
	this.hudMsg = o.hudMsg ? o.hudMsg : lang[my.lang].hudAttack;
}

var action = {
	isJuggernautValid: function() {
		var juggernautValid = 1;
		if (g.teamMode) {
			game.player.forEach(function (v, i) {
				if (!juggernautValid) return;
				if (my.team === v.team && v.cpu) {
					juggernautValid = 0;
				}
			});
		}
		return juggernautValid;
	},
	getPlayerCount: function() {
		var count = 0;
		game.player.forEach(function(p) {
			if (p.account) {
				count++;
			}
		});
		return count;
	},
	getKillRatio: function(player) {
		player = player || my.player;
		if (stats.data[player].lost === 0) {
			return 2;
		}
		else {
			return stats.data[player].killed / stats.data[player].lost;
		}
	},
	triggerAction: function(that, event) {
		var id = that.id.slice(4)*1;
		console.log('%c tile: '+ id +
			' x: '+ (g.mouse.x - 400) +' y: '+ (g.mouse.y - 200) +
			' adj: '+ game.tiles[id].adj.length +
			' name: '+ g.map.tileNames[id],
			'background: #015; color: #0ff');
		if (my.attackOn){
			var o = my.targetData;
			if (o.attackName === 'attack' || o.attackName === 'splitAttack'){
				action.attack(that);
			}
			else if (o.attackName === 'cannons'){
				action.fireCannons(that);
			}
			else if (o.attackName === 'missile'){
				action.launchMissile(that);
			}
			else if (o.attackName === 'nuke'){
				action.launchNuke(that);
			}
		}
		else {
			ui.showTarget(that);
		}
	},
	error: function(msg){
		if (msg === undefined){
			msg = lang[my.lang].notScience;
		}
		g.msg(msg, 1.5);
		my.clearHud();
		ui.showTarget(DOM['land' + my.tgt]);
	},
	target: function(o){
		my.targetData = o;
		my.checkSelectLastTarget();
		if (my.attackOn && o.attackName === my.attackName){
			my.attackOn = false;
			my.attackName = '';
			my.clearHud();
			ui.showTarget(DOM['land' + my.tgt]);
			return;
		}
		if (game.tiles[my.tgt].units < o.minimum){
			g.msg(lang[my.lang].needTwoUnits, 1.5);
			my.clearHud();
			return;
		}
		if (my.player === game.tiles[my.tgt].player){
			my.attackOn = true;
			my.attackName = o.attackName;
			my.splitAttack = o.splitAttack;
			my.hud(o.hudMsg);
			// set cursor
			$("#style-land-crosshair").remove();
			$DOM.head.append('<style id="style-land-crosshair">.land{ cursor: crosshair; }</style>');
			// set target line
			my.targetLine[0] = DOM['unit' + my.tgt].getAttribute('x')*1 - 10;
			my.targetLine[1] = DOM['unit' + my.tgt].getAttribute('y')*1 - 10;
			ui.showTarget(my.lastTarget, true);
		}
	},
	attack: function(that){
		var isSplit = my.splitAttack ? 1 : 0,
			timerKey = isSplit ? 'splitAttackTimer' : 'attackTimer',
			attackElement = isSplit ? 'splitAttack' : 'attack',
			now = Date.now(),
			dur = 500,
			moveCost = 0;

		if (now - g[timerKey] < dur) {
			return;
		}
		var attacker = my.tgt,
			defender = that.id.slice(4)*1;
		if (my.tgt === defender){
			// same tile!
			return;
		}
		if (game.tiles[attacker].adj.indexOf(defender) === -1){
			action.targetNotAdjacent('You can only attack adjacent territories.', attacker);
			return;
		}
		// can't move to maxed friendly tile
		if (game.tiles[defender].player === my.player){
			if (game.tiles[defender].units >= 65535){
				g.msg(lang[my.lang].maxUnits, 1.5);
				my.clearHud();
				return;
			}
		}
		
		my.attackOn = false;
		my.attackName = '';
		if (game.tiles[my.tgt].units === 1){
			g.msg(lang[my.lang].needTwoUnits, 1.5);
			my.clearHud();
			return;
		}
		if (my.government === 'Despotism' &&
			my.player === game.tiles[defender].player){
			// bypass move check
			moveCost = 0;
		}
		else {
			if ((my.moves < 2 && !isSplit) ||
				(my.moves < 1 && isSplit) ){
				action.error(lang[my.lang].notEnoughEnergy);
				return;
			}
			if (isSplit) {
				moveCost = 1;
			}
			else {
				moveCost = 2;
			}
		}
		ui.showTarget(that);
		my.clearHud();
		if (g.teamMode && game.tiles[defender].player){
			if (my.account !== game.tiles[defender].account){
				if (my.team === game.player[game.tiles[defender].player].team){
					console.warn(my.team, game.tiles[defender].player, game.player[game.tiles[defender].player].team);
					g.msg(lang[my.lang].friendlyFire);
				}
			}
		}
		var filter = {
				brightness: 200
			},
			element = isSplit ? '#splitAttack' : '#attack';

		TweenMax.to(filter, .5, {
			brightness: 100,
			onUpdate: function() {
				animate.brightness(element, filter.brightness)
			}
		});
		// send attack to server
		$.ajax({
			url: app.url + 'php/attackTile.php',
			data: {
				attacker: attacker,
				defender: defender,
				split: isSplit,
				moveCost: moveCost,
				dBonus: game.player[game.tiles[defender].player].dBonus,
				defGovernment: game.player[game.tiles[defender].player].government
			}
		}).done(function(data) {
			//console.info('attackTile', data);
			// animate attack
			action.timeoutWeaponButton(attackElement, dur);
			g[timerKey] = Date.now();
			if (game.tiles[defender].player !== my.player){
				if (!game.tiles[defender].units){
					audio.move();
				}
			}
			else {
				audio.move();
			}
			// barbarian message
			if (data.rewardMsg){
				game.chat({ message: '<span class="chat-news">' + data.rewardMsg + '</span>' });
				setResources(data);
				if (data.foodReward && data.productionReward && data.cultureReward){
					// all +%
					animate.upgrade(defender, 'food', data.foodReward +'%');
					setTimeout(function(){
						animate.upgrade(defender, 'production', data.productionReward +'%');
					}, 500);
					setTimeout(function(){
						animate.upgrade(defender, 'culture', data.cultureReward +'%');
					}, 1000);
				}
				else if (data.sumFood){
					animate.upgrade(defender, 'food', data.sumFood);
				}
				else if (data.sumProduction){
					animate.upgrade(defender, 'production', data.sumProduction);
				}
				else if (data.sumCulture){
					animate.upgrade(defender, 'culture', data.sumCulture);
				}
				else if (data.sumMoves){
					animate.upgrade(defender, 'energy', data.sumMoves);
				}
				else if (data.foodReward){
					// food %
					animate.upgrade(defender, 'food', data.foodReward +'%');
				}
				else if (data.productionReward){
					// production %
					animate.upgrade(defender, 'production', data.productionReward +'%');
				}
				else if (data.cultureReward){
					// culture %
					animate.upgrade(defender, 'culture', data.cultureReward +'%');
				}
			}
			setMoves(data);
			// reset target if lost
			if (!data.victory){
				ui.showTarget(DOM['land' + attacker]);
			}
			// process barbarian reward messages
			game.reportMilestones(data);
		})
		.fail(function(data){
			action.targetNotAdjacent(data.statusText, attacker);
		});
	},
	attackTileDone: function(data, dur) {
	},
	/*
	getRandomDemocracyTile: function(tile, player){
		var a = [],
			i = 0;
		game.tiles.forEach(function(t, index){
		  if (t.player === player && index !== tile){
			a[i++] = index;
		  }
		});
		var len = a.length;
		return a[~~(Math.random() * len)];
	},*/
	targetNotAdjacent: function(msg, attacker){
		audio.play('error');
		g.msg(msg, 1.5);
		// set target attacker
		ui.showTarget(DOM['land' + attacker]);
	},
	deploy: function(){
		var t = game.tiles[my.tgt];
		if (my.player !== t.player) {
			if (my.government === 'Communism' &&
				!game.tiles[my.tgt].player &&
				!game.tiles[my.tgt].units){
				// uninhabited - skip for commie bonus
			}
			else {
				action.error(lang[my.lang].notYourTile);
				return;
			}
		}
		if (my.moves < my.deployCost){
			action.error(lang[my.lang].notEnoughEnergy);
			return;
		}
		if (!my.manpower){
			action.error(lang[my.lang].noTroopsAvailable);
			return;
		}
		if (t.units < 65535){
			// do it
			var tgt = my.tgt,
				filter = {
					brightness: 200
				};

			TweenMax.to(filter, .5, {
				brightness: 100,
				onUpdate: function() {
					animate.brightness('#deploy', filter.brightness);
				}
			});
			$.ajax({
				url: app.url + 'php/deploy.php',
				data: {
					target: tgt
				}
			}).done(function(data) {
				//console.info(data);
				audio.deploy();
				game.tiles[tgt].units = data.units;
				my.manpower = data.manpower;
				setResources(data);
			}).fail(function(e){
				audio.play('error');
			}).always(function(){
				ui.setTileUnits(tgt);
			});
			TweenMax.set('#manpower', {
			  color: '#fff'
			});
		}
	},
	rush: function(){
		//my.checkSelectLastTarget();
		var t = game.tiles[my.tgt],
			tgt = my.tgt;
		if (my.player !== t.player) {
			action.error(lang[my.lang].notYourTile);
			return;
		}
		if (my.moves < my.rushCost){
			action.error(lang[my.lang].notEnoughEnergy);
			return;
		}
		if (t.units < 65535){
			var filter = {
				brightness: 200
			};
			TweenMax.to(filter, .5, {
				brightness: 100,
				onUpdate: function() {
					animate.brightness('#rush', filter.brightness);
				}
			});
			$.ajax({
				url: app.url + 'php/rush.php',
				data: {
					target: tgt
				}
			}).done(function(data) {
				audio.deploy();
				setMoves(data);
				game.tiles[tgt].units = data.units;
				//setProduction(data);
				ui.setTileUnits(tgt);
			}).fail(function(){
				audio.play('error');
			}).always(function(data){
				// my.manpower = data.manpower;
				setResources(data);
			});
		}
	},
	getRushedUnits: function() {
		var deployedUnits = 2 + ~~(my.cultureBonus / 50),
			units = game.tiles[my.tgt].units;

		if (units + deployedUnits > 65535){
			deployedUnits = (units - 65535) * -1;
		}
		return deployedUnits;
	},
	democracyUnits: function() {
		console.info('democracyUnits ', Date.now());
		$.ajax({
			url: app.url + 'php/democracy-units.php'
		}).done(function(data) {
		}).always(function(data){
			console.info("ALWAYS", data);
			setManpower(data);
		});
	},
	upgradeTileDefense: function(){
		//my.checkSelectLastTarget();
		var t = game.tiles[my.tgt],
			ind = t.defense - t.capital;
		if (my.player !== t.player) {
			action.error(lang[my.lang].notYourTile);
			return;
		}
		if (ind > 2){
			return;
		}
		if (my.production < (g.upgradeCost[ind])){
			action.error();
			return;
		}
		var filter = {
				brightness: 200
			};
		TweenMax.to(filter, .5, {
			brightness: 100,
			onUpdate: function() {
				animate.brightness('#upgradeTileDefense', filter.brightness);
			}
		});
		$.ajax({
			url: app.url + 'php/upgradeTileDefense.php',
			data: {
				target: my.tgt
			}
		}).done(function(data) {
			setProduction(data);
		}).fail(function(e){
			console.info(e.responseText);
			g.msg(e.statusText);
			audio.play('error');
		});
	},
	timeoutWeaponButton: function(id, dur) {
		var overlay = document.getElementById(id + 'Overlay'),
			reload = document.getElementById(id + 'Reload');

		TweenMax.set(overlay, {
			opacity: 1
		});
		TweenMax.to(reload, (dur/1000), {
			startAt: {
				opacity: 1,
				width: '0%'
			},
			width: '100%',
			ease: Linear.easeIn,
			onComplete: function() {
				TweenMax.set(reload, {
					opacity: 0
				});
			}
		});
		setTimeout(function() {
			TweenMax.set(overlay, {
				opacity: 0
			});
		}, dur);
	},
	fireCannons: function(that){
		var now = Date.now(),
			dur = 2000;
		if (now - g.cannonTimer < dur) {
			return;
		}
		var attacker = my.tgt,
			defender = that.id.slice(4)*1;
		if (my.tgt === defender ||
			game.tiles[my.tgt].units < 1){
			return;
		}
		if (game.tiles[attacker].adj.indexOf(defender) === -1){
			action.targetNotAdjacent('You can only attack adjacent territories.', attacker);
			return;
		}
		my.attackOn = false;
		my.attackName = '';
		if (my.production < 24){
			action.error();
			return;
		}
		my.clearHud();
		ui.showTarget(DOM['land' + attacker]);
		// send attack to server
		$.ajax({
			url: app.url + 'php/fireCannons.php',
			data: {
				attacker: attacker,
				defender: defender,
			}
		}).done(function(data) {
			action.timeoutWeaponButton('fireCannons', dur);
			g.cannonTimer = now;
			setProduction(data);
		}).fail(function(e){
			console.info('error: ', e);
			audio.play('error');
			if (e.statusText){
				g.msg(e.statusText, 1.5);
			}
		});
	},
	launchMissile: function(that){
		var now = Date.now(),
			dur = 5000;
		if (now - g.missileTimer < dur) {
			return;
		}
		var attacker = my.tgt;
		var defender = that.id.slice(4)*1;
		if (my.tgt === defender){
			return;
		}
		if (game.tiles[my.tgt].units < 1){
			return;
		}
		my.attackOn = false;
		my.attackName = '';
		if (my.production < 50){
			action.error();
			return;
		}
		my.clearHud();
		ui.showTarget(DOM['land' + attacker]);
		// send attack to server
		$.ajax({
			url: app.url + 'php/launchMissile.php',
			data: {
				attacker: attacker,
				defender: defender,
			}
		}).done(function(data) {
			console.info('launchMissile', data);
			action.timeoutWeaponButton('launchMissile', dur);
			g.missileTimer = now;
			// animate attack
			if (data.production !== undefined){
				setProduction(data);
			}
			setTimeout(function(){
				$.ajax({
					url: app.url + 'php/launchMissileHit.php',
					data: {
						defender: defender,
					}
				}).fail(function(e){
					console.info('error: ', e);
					if (e.statusText){
						g.msg(e.statusText, 1.5);
					}
				});
			}, 1000);
		}).fail(function(e){
			console.info('error: ', e);
			audio.play('error');
			if (e.statusText){
				g.msg(e.statusText, 1.5);
			}
		});
		
	},
	launchNuke: function(that){
		var now = Date.now(),
			dur = 30000;
		if (now - g.nukeTimer < dur) {
			return;
		}
		var attacker = my.tgt;
		var defender = that.id.slice(4)*1;
		if (my.tgt === defender){
			return;
		}
		if (game.tiles[my.tgt].units < 1){
			return;
		}
		my.attackOn = false;
		my.attackName = '';
		if (my.production < 150){
			action.error();
			return;
		}
		my.clearHud();
		ui.showTarget(DOM['land' + attacker]);
		// send attack to server
		$.ajax({
			url: app.url + 'php/launchNuke.php',
			data: {
				attacker: attacker,
				defender: defender,
			}
		}).done(function(data) {
			action.timeoutWeaponButton('launchNuke', dur);
			g.nukeTimer = now;
			setTimeout(function(){
				$.ajax({
					url: app.url + 'php/launchNukeHit.php',
					data: {
						defender: defender,
					}
				});
			}, 6000);
			setProduction(data);
		}).fail(function(e){
			console.info('error: ', e);
			audio.play('error');
			if (e.statusText){
				g.msg(e.statusText, 1.5);
			}
		});
		
	},
	// updates currently visible buttons after research/targeting
	setMenu: function(){
		// show/hide research
		DOM.researchMasonry.style.display = !my.tech.masonry ? 'flex' : 'none';
		DOM.researchConstruction.style.display = my.tech.masonry && !my.tech.construction ? 'flex' : 'none';
		DOM.researchEngineering.style.display = my.tech.construction && !my.tech.engineering ? 'flex' : 'none';
		DOM.researchGunpowder.style.display = !my.tech.gunpowder ? 'flex' : 'none';
		DOM.researchRocketry.style.display = my.tech.gunpowder && !my.tech.rocketry ? 'flex' : 'none';
		DOM.researchAtomicTheory.style.display =
			my.tech.rocketry && my.tech.engineering && !my.tech.atomicTheory ? 'flex' : 'none';
		DOM.researchFutureTech.style.display = my.tech.atomicTheory ? 'flex' : 'none';
		action.setBuildButton();
		DOM.fireCannons.style.display = my.tech.gunpowder ? 'flex' : 'none';
		DOM.launchMissile.style.display = my.tech.rocketry ? 'flex' : 'none';
		DOM.launchNuke.style.display = my.tech.atomicTheory ? 'flex' : 'none';
	},
	setBuildButton: function() {
		var t = game.tiles[my.tgt],
			defense = t.defense - t.capital,
			display = 'none';

		if (my.tech.masonry && t.player === my.player){
			// masonry unlocked
			//console.warn("upgradeTileDefense: ", defense, my.tech);
			if (defense === 0 ||
				defense === 1 && my.tech.construction ||
				defense === 2 && my.tech.engineering) {
				// zero defense
				display = 'flex';
				//console.info("SETTING TO FLEX: ", defense, my.tech);
			}
		}
		DOM.upgradeTileDefense.style.display = display;
	},
	/*endTurn: function(){
		if (my.moves){
			audio.play('click');
			$.ajax({
				type: 'GET',
				url: app.url + 'php/endTurn.php',
			}).done(function(data){
				setMoves(data);
			});
		}
	}*/
}

// key bindings
function toggleChatMode(bypass){
	g.chatOn = g.chatOn ? false : true;
	if (g.chatOn){
		// show chat
		$DOM.chatInputOpen.css('visibility', 'hidden');
		$DOM.chatInputWrap.css('visibility', 'visible');
		$DOM.chatInput.focus();
	} else {
		// hide chat
		var msg = $DOM.chatInput.val().trim();
		if (bypass && msg){
			// send ajax chat msg
			if (msg === '/friend'){
				title.listFriends();
			}
			else if (msg.indexOf('/friend ') === 0){
				title.toggleFriend(msg.slice(8));
			}
			else if (msg.indexOf('/unignore ') === 0){
				var account = msg.slice(10);
				title.removeIgnore(account);
			}
			else if (msg === '/ignore'){
				title.listIgnore();
			}
			else if (msg.indexOf('/ignore ') === 0){
				var account = msg.slice(8);
				title.addIgnore(account);
			}
			else if (msg.indexOf('@') === 0){
				title.sendWhisper(msg , '@');
			}
			else if (msg.indexOf('/who ') === 0){
				title.who(msg);
			}
			else {
				if (msg.charAt(0) === '/' && msg.indexOf('/me') !== 0){
					// skip
				} else {
					$.ajax({
						url: app.url + 'php/insertChat.php',
						data: {
							message: msg
						}
					});
				}
			}
		}
		$DOM.chatInput.val('').blur();
		$DOM.chatInputOpen.css('visibility', 'visible');
		$DOM.chatInputWrap.css('visibility', 'hidden');
	}
}

$("#gameWrap").on(ui.click, '#attack', function(){
	var o = new Target({});
	action.target(o);
}).on(ui.click, '#deploy', function(){
	action.deploy();
}).on(ui.click, '#splitAttack', function(){
	var o = new Target({
		cost: 1,
		attackName: 'splitAttack',
		hudMsg: lang[my.lang].hudSplitAttack,
		splitAttack: true
	});
	action.target(o);
}).on(ui.click, '#rush', function(){
	action.rush();
}).on(ui.click, '#upgradeTileDefense', function(){
	action.upgradeTileDefense();
}).on(ui.click, '#researchMasonry', function(){
	research.masonry();
}).on(ui.click, '#researchConstruction', function(){
	research.construction();
}).on(ui.click, '#researchGunpowder', function(){
	research.gunpowder();
}).on(ui.click, '#researchEngineering', function(){
	research.engineering();
}).on(ui.click, '#researchRocketry', function(){
	research.rocketry();
}).on(ui.click, '#researchAtomicTheory', function(){
	research.atomicTheory();
}).on(ui.click, '#researchFutureTech', function(){
	research.futureTech();
}).on(ui.click, '#fireCannons', function(){
	var o = new Target({
		cost: 0,
		minimum: 0,
		attackName: 'cannons',
		hudMsg: lang[my.lang].hudFireCannons
	});
	action.target(o);
}).on(ui.click, '#launchMissile', function(){
	var o = new Target({
		cost: 0,
		minimum: 0,
		attackName: 'missile',
		hudMsg: lang[my.lang].hudLaunchMissile
	});
	action.target(o);
}).on(ui.click, '#launchNuke', function(){
	var o = new Target({
		cost: 0,
		minimum: 0,
		attackName: 'nuke',
		hudMsg: lang[my.lang].hudLaunchNuke
	});
	action.target(o);
});

var research = {
	masonry: function(){
		if (my.production < 40) return;
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchMasonry.php'
		}).done(function(data) {
			setProduction(data);
			animate.research({
				element: 'researchMasonry',
				duration: 20,
				tech: lang[my.lang].abMasonry,
				method: 'masonryDone'
			});
		});
	},
	masonryDone: function() {
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchMasonryDone.php'
		}).done(function(data) {
			my.tech.masonry = 1;
			research.report(data, "Masonry");
		})
	},
	construction: function(){
		if (my.production < 60) return;
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchConstruction.php'
		}).done(function(data) {
			setProduction(data);
			animate.research({
				element: 'researchConstruction',
				duration: 30,
				tech: lang[my.lang].abConstruction,
				method: 'constructionDone'
			});
		});
	},
	constructionDone: function() {
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchConstructionDone.php'
		}).done(function(data) {
			my.tech.construction = 1;
			research.report(data, "Construction");
		})
	},
	gunpowder: function(){
		if (my.production < 60) return;
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchGunpowder.php'
		}).done(function(data) {
			setProduction(data);
			animate.research({
				element: 'researchGunpowder',
				duration: 25,
				tech: lang[my.lang].abGunpowder,
				method: 'gunpowderDone'
			});
		});
	},
	gunpowderDone: function() {
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchGunpowderDone.php'
		}).done(function(data) {
			my.tech.gunpowder = 1;
			research.report(data, "Gunpowder");
		})
	},
	engineering: function(){
		if (my.production < 80) return;
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchEngineering.php'
		}).done(function(data) {
			setProduction(data);
			animate.research({
				element: 'researchEngineering',
				duration: 45,
				tech: lang[my.lang].abEngineering,
				method: 'engineeringDone'
			});
		});
	},
	engineeringDone: function() {
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchEngineeringDone.php'
		}).done(function(data) {
			my.tech.engineering = 1;
			research.report(data, "Engineering");
		})
	},
	rocketry: function(){
		if (my.production < 200) return;
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchRocketry.php'
		}).done(function(data) {
			setProduction(data);
			animate.research({
				element: 'researchRocketry',
				duration: 40,
				tech: lang[my.lang].abRocketry,
				method: 'rocketryDone'
			});
		});
	},
	rocketryDone: function() {
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchRocketryDone.php'
		}).done(function(data) {
			my.tech.rocketry = 1;
			research.report(data, "Rocketry");
		})
	},
	atomicTheory: function(){
		if (my.production < 500) return;
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchAtomicTheory.php'
		}).done(function(data) {
			setProduction(data);
			animate.research({
				element: 'researchAtomicTheory',
				duration: 60,
				tech: lang[my.lang].abAtomic,
				method: 'atomicTheoryDone'
			});
		});
	},
	atomicTheoryDone: function() {
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchAtomicTheoryDone.php'
		}).done(function(data) {
			my.tech.atomicTheory = 1;
			research.report(data, "Atomic Theory");
		})
	},
	futureTech: function(){
		if (my.production < 800) return;
		$.ajax({
			type: 'GET',
			url: app.url + 'php/researchFutureTech.php'
		}).done(function(data) {
			setProduction(data);
			animate.research({
				element: 'researchFutureTech',
				duration: 90,
				tech: lang[my.lang].abFuture,
				method: 'futureTechDone'
			});
		});
	},
	futureTechDone: function() {
		$.ajax({
			url: app.url + 'php/researchFutureTechDone.php',
			data: {
				revTile: game.getRevolutionTile()
			}
		}).done(function(data) {
			research.report(data, "Future Tech");
		})
	},
	report: function(data, tech){
		var o = {
			message: 'You have finished researching ' + tech + '.'
		}
		game.chat(o);
		if (data.cultureMsg){
			var o = {
				message: data.cultureMsg
			};
			game.chat(o);
		}
		audio.play('research');
		action.setMenu();
	}
};
var events = {
	core: (function(){
		$(window).focus(function(){
			document.title = g.defaultTitle;
			g.titleFlashing = false;
			if (g.notification.close !== undefined){
				g.notification.close();
			}
		});
		$(window).on('load', function(){
			setTimeout(function() {
				TweenMax.to('body', .3, {
					startAt: { display: 'flex', opacity: 0 },
					opacity: 1
				})
			}, 100);
			// background map
			TweenMax.to("#worldTitle", 600, {
				startAt: {
					xPercent: -50,
					yPercent: -50,
					rotation: -360
				},
				rotation: 0,
				repeat: -1,
				ease: Linear.easeNone
			});
		}).on('resize', function() {
			ui.resizeWindow();
		});
	})(),
	title: (function(){
		$("#mainWrap").on(ui.click, '.titlePlayerAccount, .lobbyAccountName', function(){
			title.who('/who '+ $(this).text());
		});
		$("#gameView").on('dragstart', 'img', function(e) {
			e.preventDefault();
		});
		$("img").on('dragstart', function(event) {
			event.preventDefault();
		});

		$("#logout").on(ui.click, function() {
			playerLogout();
			return false;
		});
		$("#login").on(ui.click, function(){
			title.presence.remove(my.account);
		});

		$("#titleMenu").on(ui.click, '.wars', function(){
			var gameName = $(this).data("name");
			$("#joinGame").val(gameName);
			$("#joinGamePassword").val('');
			title.joinGame();
		});
		
		function openCreateGameModal(mode){
			var e1 = document.getElementById('createGameHead'),
				e2 = document.getElementById('createRankedGameHead'),
				e3 = $("#gameName"),
				e4 = document.getElementById('createGameNameWrap'),
				e5 = document.getElementById('createGamePasswordWrap'),
				e6 = document.getElementById('createGameMaxPlayerWrap');
			
			g.rankedMode = 0;
			g.teamMode = 0;
			if (mode === 'ranked'){
				g.rankedMode = 1;
				e1.style.display = 'none';
				e2.style.display = 'block';
				e4.style.display = 'none';
				e5.style.display = 'none';
				e6.style.display = 'none';
			} else {
				e1.style.display = 'block';
				e2.style.display = 'none';
				e4.style.display = 'block';
				e5.style.display = 'block';
				e6.style.display = 'block';
			}
			if (mode === 'team'){
				g.teamMode = 1;
				e1.textContent = lang[my.lang].createTeamGameHeadLabel;
			}
			// e3.val(my.account +'_'+ ~~(Math.random()*999999)).select();
			e3.val('').select();
			$("#gamePassword").val('');
			TweenMax.to("#createGameWrap", g.modalSpeed, {
				startAt: {
					visibility: 'visible',
					y: 0,
					alpha: 0
				},
				y: 30,
				alpha: 1
			});
			title.showBackdrop(e3);
			
			/*var speed = localStorage.getItem('gameSpeed2') === null ? 15 : localStorage.getItem('gameSpeed2');
			g.speed = speed;
			$("#createGameSpeed").text(speed);*/
		}
		$('#mainWrap').on(ui.click, '.chat-join', function(){
			socket.setChannel($(this).text());
		});
		$('#create').on(ui.click, function(){
			openCreateGameModal('ffa');
		});
		$('#createRankedBtn').on(ui.click, function(){
			openCreateGameModal('ranked');
		});
		$("#createTeamBtn").on(ui.click, function(){
			openCreateGameModal('team');
		});

		$("#createGame").on(ui.click, function(){
			title.createGame();
		});
		$("#play-now-btn").on(ui.click, function(){
			title.addCpu = 1;
			title.createGameService('', '', 'Alpha Earth', 8, 0, 0, 20);

		});
		$("body").on(ui.click, '#options, #gameOptions', function(){
			title.showModal();
		}).on(ui.click, '#hotkeys', function(){
			TweenMax.to("#hotkeysModal", g.modalSpeed, {
				startAt: {
					visibility: 'visible',
					y: 0,
					alpha: 0
				},
				y: 30,
				alpha: 1
			});
			title.showBackdrop();
		}).on(ui.click, '#hide-ui', function() {
			game.toggleGameWindows(1);
		}).on(ui.click, '#toggle-flags', function() {
			game.toggleFlags();
		}).on(ui.click, '#surrender', function(e){
			surrenderMenu();
		});
		$("#hotkeysDone, #optionsDone, #cancelCreateGame").on(ui.click, function(){
			title.closeModal();
		});


		// cached values on client to reduce DB load

		$("#joinPrivateGameModal").on(ui.click, "#joinPrivateGameBtnConfirm", title.joinGame);

		$("#titleMain").on(ui.click, '.nw-link', function() {
			title.openWindow($(this).attr('href'));
		});
		$("#titleChatPlayers").on(ui.click, '#friend-status', function(){
			title.listFriends();
		}).on(ui.click, '#ignore-status', function(){
			title.listIgnore();
		});
		$("#get-help").on(ui.click, function(){
			title.help();
			$("#title-chat-input").focus();
		});
		$("#ignore-user").on(ui.click, function(){
			$("#title-chat-input").val('/ignore ').focus();
		});
		$("#share-url").on(ui.click, function(){
			$("#title-chat-input").val('/url ').focus();
		});
		$("#share-image").on(ui.click, function(){
			$("#title-chat-input").val('/img ').focus();
		});
		$("#share-video").on(ui.click, function(){
			$("#title-chat-input").val('/video ').focus();
		});
		$("#who-account").on(ui.click, function(){
			$("#title-chat-input").val('/who ').focus();
		});
		$("#add-friend").on(ui.click, function(){
			$("#title-chat-input").val('/friend ').focus();
		});
		$("#whisper-account").on(ui.click, function(){
			$("#title-chat-input").val('@').focus();
		});
		$("#change-channel").on(ui.click, function(){
			$("#title-chat-input").val('#').focus();
		});
		
		$("#body").on(ui.click, "#cancelGame", exitGame).on(ui.click, "#startGame", lobby.startGame)
		.on(ui.click, '.addFriend', function(){
			title.toggleFriend($(this).data('account'));
		}).on(ui.click, '.ribbon', function(){
			var x = $(this).data('ribbon') * 1;
			g.chat(lang[my.lang].ribbonTitle[x] +": "+ lang[my.lang].ribbonDescription[x], 'chat-warning');
		});
		$("#toggleNation").on(ui.click, title.configureNation);
		$("#joinPrivateGameBtn").on(ui.click, function(){
			var e = $("#joinGame");
			e.val('');
			TweenMax.to('#joinPrivateGameModal', g.modalSpeed, {
				startAt: {
					visibility: 'visible',
					y: 0,
					alpha: 0
				},
				y: 30,
				alpha: 1,
				onComplete: function(){
					e.focus();
				}
			});
			title.showBackdrop();
		});
		$("#mainWrap").on(ui.click, ".unlockGameBtn", function(){ 
			title.closeModal();
			TweenMax.to('#unlockGame', g.modalSpeed, {
				startAt: {
					visibility: 'visible',
					y: 0,
					alpha: 0
				},
				y: 30,
				alpha: 1
			});
			setTimeout(function(){
				$("#card-number").focus();
			}, 100);
			title.showBackdrop();
		});
		$("#leaderboardBtn").on(ui.click, function(){
			TweenMax.to('#leaderboard', g.modalSpeed, {
				startAt: {
					visibility: 'visible',
					top: 0,
					alpha: 0
				},
				top: 30,
				alpha: 1
			});
			title.showBackdrop();
			title.getLeaderboard('FFA');
		});
		// leaderboard buttons
		$("#leaderboardFfaBtn").on(ui.click, function(){
			title.getLeaderboard('FFA');
		});
		$("#leaderboardRankedBtn").on(ui.click, function(){
			title.getLeaderboard('Ranked');
		});
		$("#leaderboard-nation-rank").on(ui.click, function(){
			title.getLeaderboard('Nations');
		});
		$("#leaderboard-flag-rank").on(ui.click, function(){
			title.getLeaderboard('Flags');
		});
		$("#leaderboard-trips-btn").on(ui.click, function(){
			title.getLeaderboard('Trips');
		});
		$("#leaderboard-quads-btn").on(ui.click, function(){
			title.getLeaderboard('Quads');
		});
		$("#leaderboard-pents-btn").on(ui.click, function(){
			title.getLeaderboard('Pents');
		});
		$("#leaderboardTeamBtn").on(ui.click, function(){
			title.getLeaderboard('Team');
		});

		$("#window-select-wrap").on(ui.click, '.window-select', function() {
			ui.setWindow(this.id);
		});
		$("#bible-status").on(ui.click, function() {
			stats.setBibleMode($(this).prop('checked'));
		});
		$("#flagDropdown").on(ui.click, '.flagSelect', function(e){
			my.selectedFlag = $(this).find('a').data('flag').trim();
			my.selectedFlagFull = my.selectedFlag + ui.getFlagExt(my.selectedFlag);
			$("#updateNationFlag")
				.attr("src", "images/flags/" + my.selectedFlagFull)
				.css("display", "block");
			g.lock(1);
			$.ajax({
				url: app.url + 'php/updateFlag.php',
				data: {
					flag: my.selectedFlagFull
				}
			}).done(function(data) {
				my.flag = my.selectedFlagFull;
				$(".nationFlag").attr({
					src: "images/flags/" + my.selectedFlagFull,
					title: my.selectedFlag
				});
				g.msg(lang[my.lang].flagChanged + my.selectedFlag);
				document.getElementById('selectedFlag').textContent = my.selectedFlag;
				$("[title]")
					.tooltip('fixTitle')
					.tooltip({
						animation: false
					});
			}).always(function(){
				g.unlock(1);
				TweenMax.to("#updateNationFlag", 1, {
					startAt: {
						alpha: 0
					},
					alpha: 1
				});
			});
			e.preventDefault();
		});

		$("#lobbyPlayers").on(ui.click, '.flagSelect', function(e){
			var val = $(this).find('a').data('flag').trim();
			console.info(val);
			lobby.cpuFlag = val;
			$("#cpuFlag").html(val);
			e.preventDefault();
		});

		$("#submitNationName").on("mousedown", function(){
			title.submitNationName();
		});
		$("#updateNationName").on("focus", function(){
			g.focusUpdateNationName = true;
		}).on("blur", function(){
			g.focusUpdateNationName = false;
		});
		$("#refreshGameWrap").on("focus", "#gameName", function(){
			g.focusGameName = true;
		});
		$("#refreshGameWrap").on("blur", "#gameName", function(){
			g.focusGameName = false;
		});
		$("#titleViewBackdrop, .close-btn").on(ui.click, title.closeModal);

		$("#body").on(ui.click,
			'#updateNationBtn, #configureNationDone, #leaderboardDone',
			title.closeModal
		);
		/*
		$("#autoJoinGame").on(ui.click, function(){
			$("#joinGame").val('');
			audio.play('click');
			$("#joinGamePassword").val();
			$(".wars-FFA").filter(":first").trigger(ui.click); 
			if (!$("#joinGame").val()){
				g.msg("No FFA games found!", 1.5);
			} else {
				title.joinGame();
			}
		});
		$("#joinTeamGame").on(ui.click, function(){
			$("#joinGame").val('');
			audio.play('click');
			$("#joinGamePassword").val();
			$(".wars-Team").filter(":first").trigger(ui.click); 
			if (!$("#joinGame").val()){
				g.msg("No team games found!", 1.5);
			} else {
				title.joinGame();
			}
		});
		*/
		$("#joinRankedGame").on(ui.click, function(){
			audio.play('click');
			g.lock(1);
			g.searchingGame = true;
			g.msg(lang[my.lang].rankedSearch, 0);
			(function repeat(count){
				if (count < 1 && !g.joinedGame){
					setTimeout(function(){
						if (g.searchingGame){
							repeat(++count);
						}
					}, 1000);
					// ajax call to join ranked game
					$.ajax({
						url: app.url + 'php/joinRankedGame.php'
					}).done(function(data){
						if (g.searchingGame){
							TweenMax.set(DOM.Msg, {
								opacity: 0
							});
							g.joinedGame = 1;
							g.unlock();
							g.searchingGame = false;
							title.joinGameCallback(data);
						}
					});
				} else {
					if (!g.joinedGame && g.searchingGame){
						g.msg(lang[my.lang].noRankedFound, 5);
						g.unlock();
						g.searchingGame = false;
					}
				}
			})(0);
		});
	})(),
	lobby: (function(){
		$("#chat-input-open").on(ui.click, toggleChatMode);
		$("#chat-input-send").on(ui.click, function(){
			toggleChatMode(true);
		});
		$("#lobby-chat-input").on('focus', function(){
			lobby.chatOn = true;
		}).on('blur', function(){
			lobby.chatOn = false;
		});
		$("#lobbyChatSend").on(ui.click, function(){
			lobby.sendMsg(true);
		});
		// prevents auto scroll while scrolling
		$("#lobbyChatLog").on('mousedown', function(){
			lobby.chatDrag = true;
		}).on('mouseup', function(){
			lobby.chatDrag = false;
		});
		$("#joinGameLobby").on(ui.click, '.governmentChoice', function(e){
			// changes player's own government only
			var government = $(this).data('government');
			lobby.updateGovernmentWindow(government);
			$.ajax({
				url: app.url + "php/changeGovernment.php",
				data: {
					government: government
				}
			});
		}).on(ui.click, '.cpu-choice', function(e){
			var difficulty = $(this).data('difficulty');
			console.info('cpu-choice', difficulty);
			$.ajax({
				url: app.url + "php/change-cpu-difficulty.php",
				data: {
					difficulty: difficulty,
					player: $(this).data('player')
				}
			});
		}).on(ui.click, '.playerColorChoice', function(e){
			var playerColor = $(this).data('playercolor');
			$.ajax({
				url: app.url + 'php/changePlayerColor.php',
				data: {
					playerColor: playerColor*1
				}
			}).done(function(data){
				my.playerColor = data.playerColor;
			}).fail(function(data){
				g.msg(data.statusText, 1.5);
			});
		}).on(ui.click, '.teamChoice', function(){
			var team = $(this).text().slice(5),
				player = $(this).data('player');

			console.info("TEAM: ", player, team);
			// is it human player?
			for (var key in lobby.presence.list) {
				var v = lobby.presence.list[key];
				if (player === v.player && !v.cpu) {
					// cannot change other player's team
					return;
				}
			}

			$.ajax({
				url: app.url + 'php/changeTeam.php',
				data: {
					team: team,
					player: player
				}
			}).done(function(data) {
				if (my.player === data.player * 1) {
					my.team = data.team;
				}
				var obj = _.find(lobby.presence.list, function(v) {
					return v.player === data.player * 1;
				});
				console.info('obj ', obj);
				lobby.presence.list[obj.account].team = data.team;
			});
			
		}).on(ui.click, '#cpu-add-player', lobby.addCpuPlayer)
		.on(ui.click, '#cpu-remove-player', lobby.removeCpuPlayer);
	})(),
	map: (function(){
		$("body").on("mousewheel", function(e){
			if (g.view === 'game'){
				setMousePosition(e.offsetX, e.offsetY);
				applyBounds();
			}
		});
		$("#worldWrap").on("mousewheel", function(e){
			if (e.originalEvent.wheelDelta > 0) {
				mouseZoomIn(e);
			}
			else if (e.originalEvent.wheelDelta < 0) {
				mouseZoomOut(e);
			}
		});

		$("#worldWrap").on("mousemove", function(e){
			setMousePosition(e.offsetX, e.offsetY);
		});
		$("#createGameWrap").on(ui.click, '.mapSelect', function(e){
			var x = $(this).text();
			var key = x.replace(/ /g,'');
			g.map.name = x;
			g.map.key = key;
			document.getElementById('createGameMap').innerHTML = x;
			// $('#createGameTiles').html(title.mapData[key].tiles);
			document.getElementById('createGamePlayers').innerHTML = title.mapData[key].players;
			var e1 = $("#gamePlayers");
			e1.attr("max", title.mapData[key].players);
			if (e1.val() * 1 > title.mapData[key].players){
				e1.val(title.mapData[key].players);
			}
			e.preventDefault();
		});
		$("#mainWrap").on(ui.click, '.gameSelect', function(e){
			e.preventDefault();
		});
	})(),
	audio: (function(){
		$("#bgmusic").on('ended', function() {
			var x = document.getElementById('bgmusic');
			x.currentTime = 0;
			x.play();
		});
		$("#bgamb1").on('ended', function() {
			var x = document.getElementById('bgamb1');
			x.currentTime = 0;
			x.play();
		});
		$("#bgamb2").on('ended', function() {
			var x = document.getElementById('bgamb2');
			x.currentTime = 0;
			x.play();
		});
	})(),
	game: (function(){
		$("#cancelSurrenderButton").on(ui.click, function(){
			audio.play('click');
			document.getElementById('surrenderScreen').style.display = 'none';
		});
		$("#surrenderButton").on(ui.click, function() {
			surrender();
		});
	})()
};


$(document).on('keydown', function(e){
	var x = e.keyCode;
	console.info('keydown: ', x);
	if (e.ctrlKey){
		if (x === 82){
			// ctrl+r refresh
			return false;
		}
	}
	else {
		if (g.view === 'title'){
			if (!g.isModalOpen && isLoggedIn){
				$("#title-chat-input").focus();
			}
			if (x === 27) {
				title.toggleModal();
			}
		}
		else if (g.view === 'lobby'){
			$("#lobby-chat-input").focus();
			if (x === 27) {
				title.toggleModal();
			}
		}
		else {
			// game
			if (x === 86){
				// v
				if (!g.chatOn){
					game.toggleGameWindows(1);
				}
			}
			// STUFF BEFORE HERE CAN BE DONE IN SPECTATE MODE
			if (g.spectateStatus) return;
			if (x === 9){
				// tab
				if (!e.shiftKey){
					my.nextTarget(false);
				} else {
					my.nextTarget(true);
				}
				e.preventDefault();
			}
			else if (x === 27) {
				!my.attackOn && !g.chatOn && title.toggleModal();
			}
		}
	}
}).on('keyup', function(e) {
	var x = e.keyCode;
	console.info('keyup: ', x);
	if (g.view === 'title'){
		if (x === 13){
			if (g.focusUpdateNationName){
				title.submitNationName();
			} else if (g.focusGameName){
				title.createGame();
			} else if (title.chatOn){
				if (x === 13){
					// enter - sends chat
					title.sendMsg();
				}
			} else if (title.createGameFocus){
				title.createGame();
			}
		}
	}
	else if (g.view === 'lobby'){
		if (lobby.chatOn){
			if (x === 13){
				// enter - sends chat
				lobby.sendMsg();
			}
		}
	// game hotkeys
	}
	else if (g.view === 'game'){
		if (g.chatOn){
			if (x === 13 || x === 27){
				// enter/esc - sends chat
				toggleChatMode(true);
			}
		}
		else {
			if (x === 13){
				// enter
				toggleChatMode();
			}
			if (x === 27){
				// esc
				if (my.attackOn) {
					my.attackOn = false;
					my.attackName = '';
					my.clearHud();
					ui.showTarget(DOM['land' + my.tgt]);
				}
			}
			// STUFF BEFORE HERE CAN BE DONE IN SPECTATE MODE
			if (g.spectateStatus) return;
			if (x === 65){
				// a
				var o = new Target();
				action.target(o);
			}
			else if (x === 83){
				// s
				var o = new Target({
					cost: 1, 
					attackName: 'splitAttack',
					hudMsg: lang[my.lang].hudSplitAttack,
					splitAttack: true
				});
				console.info(o.cost);
				action.target(o);
			}
			else if (x === 68){
				// d
				if (!g.keyLock){
					action.deploy();
				}
			}
			else if (x === 82){
				// r
				if (!g.keyLock){
					if (e.ctrlKey){
						var x = my.lastReceivedWhisper;
						if (x){
							if (g.view === 'title'){
								$("#title-chat-input").val('/w ' + x + ' ').focus();
							}
							else if (g.view === 'lobby'){
								$("#lobby-chat-input").val('/w ' + x + ' ').focus();
							}
							else {
								if (!g.chatOn){
									toggleChatMode();
								}
								$("#chat-input").val('/w ' + x + ' ').focus();
							}
						}
						return false;
					}
					else {
						action.rush();
					}
				}
			}
			else if (x === 89){
				// y
				research.masonry();
			}
			else if (x === 79){
				// o
				research.construction();
			}
			else if (x === 69){
				// e
				research.engineering();
			}
			else if (x === 71){
				// g
				research.gunpowder();
			}
			else if (x === 75){
				// k
				research.rocketry();
			}
			else if (x === 84){
				// t
				research.atomicTheory();
			}
			else if (x === 70){
				// f
				research.futureTech();
			}
			else if (x === 66){
				// b
				action.upgradeTileDefense();
			}
			else if (x === 67 && my.tech.gunpowder){
				// c
				var o = new Target({
					cost: 0,
					minimum: 0,
					attackName: 'cannons',
					hudMsg: lang[my.lang].hudFireCannons
				});
				action.target(o);
			}
			else if (x === 77 && my.tech.rocketry){
				// m
				var o = new Target({
					cost: 0,
					minimum: 0,
					attackName: 'missile',
					hudMsg: lang[my.lang].hudLaunchMissile
				});
				action.target(o);
			}
			else if (x === 78 && my.tech.atomicTheory){
				// n
				var o = new Target({
					cost: 0,
					minimum: 0,
					attackName: 'nuke',
					hudMsg: lang[my.lang].hudLaunchNuke
				});
				action.target(o);
			}
		}
	}
});

/*$("#dictatorAvatar").on('change', function(e){
	 var e2 = $("#uploadErr");
	 function imgError(msg){
		e2.html(msg);
		audio.play('error');
	 }
	 var file = e.target.files[0];
	 var reader = new FileReader();
	 reader.readAsDataURL(file);
	 if (file.type !== 'image/jpeg'){
		imgError('Wrong file type! Image must be in jpg format.');
	 }
	 else {
		 reader.addEventListener("load", function(){
			if (reader.result.length < 70000){
				$.ajax({
					url: app.url + "php/uploadDictator.php",
					type: "POST",
					data: {
						uri: reader.result
					},
					beforeSend: function(){
						e2.text('');
					}
				}).done(function(data){
					e2.text("Avatar updated successfully!");
					document.getElementById('configureAvatarImage').src = reader.result;
				}).fail(function(data){
					imgError(data.statusText);
				});
			} else {
				imgError('File size too large! Image must be less than 40 kb.');
				e2.html();
			}
		 }, false);
	 }
 });*/
if (app.isApp) {
	var gui = require('nw.gui');
	win = gui.Window.get();
	win.on('close', function() {
		this.hide(); // pretend
		title.closeGame();
		this.close(true);
	})
}
var ai = {
	structureDefense: [1, 1.5, 2, 2.5, 3],
	scoreTargetAttack: function(o){
		// should AI attack this adjacent target?
		var score = 50;
		// score player
		if (!g.teamMode){
			if (o.defender === 0){
				// barb/empty
				score += 50;
			} else if (o.attacker !== o.defender){
				// another player
				score += 25;
			} else {
				// mine
				score -= 10;
			}
			if (o.defender === ui.currentLoser && ui.currentLoser !== o.attacker) {
				score += 250;
			}
		}
		else {
			//
			if (game.player[o.attacker].team === game.player[o.defender].team) {
				score -= 25;
			}
			else {
				if (!o.defenderUnits) {
					// empty
					score += 50;
				}
				else if (o.defender === 0){
					// barb
					score += 10;
				}
				else if (o.attacker === o.defender){
					// mine
					score -= 5;
				}
				if (o.defender === ui.currentLoser && ui.currentLoser !== o.attacker) {
					score += 250;
				}
			}
		}
		// defense
		if (o.attacker !== o.defender){
			score -= o.defenderUnits * (ai.structureDefense[o.defense + o.capital]);
			// food
			score += ~~((o.food) + Math.random() * 10 - 5);
		}
		return score;
	},
	getAttackTarget: function(player){
		var atkTile = -1,
			defTile = -1,
			maxScore = 0;
		
		game.tiles.forEach(function(d, index){
			if (d.player === player && d.units >= 5){
				var tileScore = 0;

				if (d.capital) {
					tileScore -= 20;
				}
				// cpu's tile
				d.adj.forEach(function(defender){
					var z = game.tiles[defender];
					var score = ai.scoreTargetAttack({
						attacker: player,
						defender: z.player,
						attackerUnits: d.units,
						defenderUnits: z.units,
						unitDiff: (d.units - z.units),
						defense: z.defense,
						food: z.food,
						production: z.production,
						culture: z.culture,
						capital: z.capital
					});
					if (z.player === ui.currentLoser && ui.currentLoser !== player) {
						// try to eliminate last place player
						score += 250;
					}
					if (tileScore + score > maxScore){
						maxScore = score;
						atkTile = index;
						defTile = defender;
					}
				});
			}
		});
		//console.info("ATTACKING FROM: ", atkTile, defTile, maxScore);
		return [atkTile, defTile, maxScore];
	},
	scoreTargetWeapon: function(o){
		var score = 50;
		// score player
		if (!g.teamMode){
			if (o.defender === 0){
				// barb/empty
				score += 10;
			} else if (o.attacker !== o.defender){
				// another player
				score += 25;
			} else {
				// mine
				score -= 10;
			}
		}
		else {
			if (game.player[o.attacker].team === game.player[o.defender].team) {
				score -= 25;
			}
			else {
				if (o.defender === 0){
					// barb/empty
					score -= 10;
				} else if (game.player[o.attacker].team !== game.player[o.defender].team){
					// enemy
					score += 30;
				} else if (o.attacker === o.defender){
					// mine
					score -= 5;
				}
			}
		}
		// defense
		if (o.attacker !== o.defender){
			score -= o.unitDiff;
			// food
			score += ~~((o.food) + Math.random()*10 - 5);
		}
		return score;
	},
	getWeaponTarget: function(player){
		var atkTile = -1,
			defTile = -1,
			maxScore = 0;
		
		game.tiles.forEach(function(d, index){
			if (d.player === player){
				// cpu's tile
				d.adj.forEach(function(defender){
					var z = game.tiles[defender];
					var score = ai.scoreTargetWeapon({
						attacker: player,
						defender: z.player,
						attackerUnits: d.units,
						unitDiff: (d.units - z.units),
						defense: z.defense,
						food: z.food,
						production: z.production,
						culture: z.culture,
						capital: z.capital
					});
					if (score > maxScore){
						maxScore = score;
						atkTile = index;
						defTile = defender;
					}
				});
			}
		});
		//console.info("ATTACKING FROM: ", atkTile, defTile, maxScore);
		return [atkTile, defTile, maxScore];
	},
	getRangedWeaponTarget: function(player){
		var atkTile = -1,
			defTile = -1,
			maxScore = 0;
		
		game.tiles.forEach(function(tile, index){
			if (tile.player !== player){
				var score = 50;
				if (g.teamMode && game.player[tile.player].team === game.player[player].team) {
					score -= 25;
				}
				else {
					score += tile.units;
					score += tile.defense * 20;
					if (tile.capital){
						score += 5;
					}
					if (!tile.player){
						score = 0;
					}
				}
				if (score > maxScore){
					maxScore = score;
					defTile = index;
				}
			}
			else {
				atkTile = index;
			}
		});
		//console.info("ATTACKING FROM: ", atkTile, defTile, maxScore);
		return [atkTile, defTile, maxScore];
	},
	attack: function(i, d, o){
		if (g.over) return;
		var tiles = ai.getAttackTarget(d.player);
		if (tiles[0] > -1){
			var obj = {
				loop: i,
				attacker: tiles[0],
				defender: tiles[1],
				player: d.player,
				dBonus: game.player[game.tiles[tiles[1]].player].dBonus,
				defGovernment: game.player[game.tiles[tiles[1]].player].government
			};
			if (i === 0) {
				obj = Object.assign({
					moves: (4 + ~~(o.food / 50)),
					food: o.food,
					production: o.production,
					culture: o.culture
				}, obj);
			}
			if (o.deployTile > -1) {
				obj = Object.assign({
					deployTile: o.deployTile,
					newUnits: o.newUnits,
				}, obj);
			}
			if (game.tiles[obj.attacker].adj.indexOf(obj.defender) === -1){
				console.warn("Uh oh! AI chose a territory that is not adjacent!");
			}
			else {
				// console.info('ai-update: ', obj);
				$.ajax({
					url: app.url + 'php/attack-ai.php',
					data: obj
				});
			}

		}
		else {
			console.warn("Failed to attack! Deploying...");
			var tile = ai.getDeployTarget(d.player);
			$.ajax({
				url: app.url + 'php/deploy-ai.php',
				data: {
					newUnits: 5,
					deployTile: tile
				}
			});
		}
	},
	scoreTargetDeploy: function(o){
		var score = 50;
		if (!o.player){
			// barb/empty
			score += 20;
		}
		else if (!o.sameTeam){
			// enemy player - try to get him!
			score += 10;
			// where are units needed?
			if (o.player && !o.unitDiff){
				score += o.unitDiff * -1;
			}
		}
		else if (o.sameTeam){
			// my tile - don't care about this dude!
			score -= 10;
		}
		if (o.player === ui.currentLoser) {
			score += 150;
		}
		// food
		score += ~~(Math.random()*6 - 3);
		return score;
	},
	getDeployTarget: function(cpuPlayer){
		var tile = -1,
			cpuTeam = g.team ? game.player[cpuPlayer].team : 0,
			maxScore = 0;
		
		game.tiles.forEach(function(d, index){
			var cpuUnits = game.tiles[index].units,
				score = 0,
				tileScore = 0,
				adjTiles = 0,
				tileDefense = d.defense + d.capital;
			//console.info(index, d.player === cpuPlayer, d.units, d.flag);
			if (d.player === cpuPlayer && d.units < 65535 && d.flag){
				// cpu's tile
				// less than 65535
				// not a barb or empty
				// original tile
				if (d.capital && cpuUnits < 24) {
					tileScore += 20;
				}
				d.adj.forEach(function(defender){
					adjTiles++;
					var z = game.tiles[defender];
					z.sameTeam = g.teamMode ?
						cpuTeam === game.player[z.player].team : cpuPlayer === z.player;
					z.unitDiff = cpuUnits - z.units;
					z.cpuUnits = cpuUnits;
					z.tileDefense = tileDefense;
					score += ai.scoreTargetDeploy(z);
				});
				var sum = tileScore + ~~(score/adjTiles);
				if (sum > maxScore){
					maxScore = sum;
					tile = index;
				}
			}
		});
		// console.info('DEPLOYING TO: ', game.tiles[tile].name, maxScore);
		return tile;
	},
	getDefenseTarget: function(player){
		var tile = -1,
			maxScore = 0;
		
		game.tiles.forEach(function(d, index){
			var score = 0;
			//console.info(index, d.player === cpuPlayer, d.units, d.flag);
			if (d.player === player && d.units < 65535 && d.flag){
				// cpu's tile
				// less than 65535
				// not a barb or empty
				score += d.units;
				score += ( (3 - d.defense) * 10);
				if (score > maxScore){
					maxScore = score;
					tile = index;
				}
			}
		});
		//console.info('DEPLOYING TO: ', tile);
		return tile;
	},
	getDeployData: function(d, o, multiplier){
		if (multiplier) {
			o.food *= multiplier;
		}
		var newUnits = Math.ceil((o.food / 12) + (g.resourceTick / 5) + 2);
		//console.info('AI.DEPLOY', multiplier, newUnits);
		var deployObj = {
			deployTile: ai.getDeployTarget(d.player),
			newUnits: newUnits
		};
		return deployObj;
	},
	getResourceTotal: function(player){
		var o = {
			food: 0,
			production: 0,
			culture: 0
		}
		game.tiles.forEach(function(tile){
			if (player === tile.player){
				o.food += tile.food;
				o.production += tile.production;
				o.culture += tile.culture;
			}
		}); 
		return o;
	},
	weaponDelay: function(){
		return Math.random() * 11000 + 1000;
	},
	attackDelay: function(loop, d) {
		// ensures a clean stagger of CPU turns
		var divTurn = (g.speed*1000) / ai.attackMax[d.difficultyShort],
			t = loop * divTurn + ( loop * ((divTurn - 500) / 8) ) + ((d.player/8) * divTurn);
		return t;
	},
	fireCannons: function(d){
		if (g.over) return;
		var tiles = ai.getWeaponTarget(d.player);
		if (tiles[0] > -1){
			if (game.tiles[tiles[0]].adj.indexOf(tiles[1]) === -1){
				action.targetNotAdjacent('You can only attack adjacent territories.', attacker);
				return;
			}
			$.ajax({
				url: app.url + 'php/ai-fireCannons.php',
				data: {
					attacker: tiles[0],
					defender: tiles[1],
				}
			});
		}
	},
	launchMissile: function(d){
		if (g.over) return;
		var tiles = ai.getRangedWeaponTarget(d.player);
		if (tiles[0] > -1){
			$.ajax({
				url: app.url + 'php/ai-launchMissile.php',
				data: {
					attacker: tiles[0],
					defender: tiles[1],
				}
			}).done(function(){
				setTimeout(function(){
					if (g.over) return;
					$.ajax({
						url: app.url + 'php/ai-launchMissileHit.php',
						data: {
							attackPlayer: d.player,
							// account: d.account,
							defender: tiles[1],
						}
					});
				}, 1000);
			});
		}
	},
	launchNuke: function(d){
		if (g.over) return;
		var tiles = ai.getRangedWeaponTarget(d.player);
		if (tiles[0] > -1){
			$.ajax({
				url: app.url + 'php/ai-launchNuke.php',
				data: {
					attacker: tiles[0],
					defender: tiles[1],
				}
			}).done(function(){
				setTimeout(function(){
					if (g.over) return;
					$.ajax({
						url: app.url + 'php/ai-launchNukeHit.php',
						data: {
							attackPlayer: d.player,
							account: d.account,
							defender: tiles[1],
						}
					});
				}, 6000);
			});
		}
	},
	upgradeTileDefense: function(d){
		if (g.over) return;
		var tile = ai.getDefenseTarget(d.player);
		if (tile > -1){
			$.ajax({
				url: app.url + 'php/ai-upgradeTileDefense.php',
				data: {
					target: tile,
					player: d.player,
					account: d.account
				}
			});
		}
	},
	// 1 mod this
	deployRate: {
		VeryEasy: 6, 
		Easy: 5,
		Normal: 4,
		Hard: 4,
		VeryHard: 3,
		Mania: 2,
		Juggernaut: 1
	},
	// bonus deploy for this amount of food
	deployFood: {
		VeryEasy: 50, 
		Easy: 40,
		Normal: 30,
		Hard: 25,
		VeryHard: 20,
		Mania: 15,
		Juggernaut: 10
	},
	// number of bonus attacks
	attackFood: {
		VeryEasy: 40,
		Easy: 30,
		Normal: 50,
		Hard: 40,
		VeryHard: 30,
		Mania: 20,
		Juggernaut: 10
	},
	// max attack/CPU
	attackMax: {
		VeryEasy: 2,
		Easy: 2,
		Normal: 2,
		Hard: 3,
		VeryHard: 4,
		Mania: 5,
		Juggernaut: 8
	},
	// guaranteed attacks
	attackBaseTurns: {
		VeryEasy: 1,
		Easy: 1,
		Normal: 2,
		Hard: 2,
		VeryHard: 2,
		Mania: 3,
		Juggernaut: 5
	},
	unlockNuke: {
		VeryEasy: 250, 
		Easy: 150,
		Normal: 100,
		Hard: 90,
		VeryHard: 80,
		Mania: 50,
		Juggernaut: 20
	},
	unlockMissile: {
		VeryEasy: 100, 
		Easy: 65,
		Normal: 50,
		Hard: 40,
		VeryHard: 30,
		Mania: 20,
		Juggernaut: 10
	},
	unlockCannons: {
		VeryEasy: 50, 
		Easy: 30,
		Normal: 20,
		Hard: 15,
		VeryHard: 10,
		Mania: 5,
		Juggernaut: 0
	},
	missileRate: {
		VeryEasy: 1,
		Easy: .95,
		Normal: .9,
		Hard: .85,
		VeryHard: .8,
		Mania: .75,
		Juggernaut: .7
	},
	cannonRate: {
		VeryEasy: .8,
		Easy: .75,
		Normal: .7,
		Hard: .65,
		VeryHard: .6,
		Mania: .55,
		Juggernaut: .5
	},
	unlockStructures: {
		VeryEasy: 30, 
		Easy: 20,
		Normal: 10,
		Hard: 8,
		VeryHard: 5,
		Mania: 2,
		Juggernaut: 0
	},
	takeTurn: function(d){
		var o = ai.getResourceTotal(d.player),
			turns = Math.ceil(o.food / ai.attackFood[d.difficultyShort]) + ai.attackBaseTurns[d.difficultyShort];

		if (turns > ai.attackMax[d.difficultyShort]){
			turns = ai.attackMax[d.difficultyShort];
		}
		// console.info('TAKING TURN', d.player, d.account, turns);
		for (var i=0; i<turns; i++){
			(function(i, d){
				setTimeout(function(){
					if (i + 1 === turns &&
						g.resourceTick % ai.deployRate[d.difficultyShort] === 0) {
						// bonus deploy
						var multiplier = ~~(o.food / ai.deployFood[d.difficultyShort]),
							deployObj = ai.getDeployData(d, o, multiplier);
						o = Object.assign(deployObj, o);
					}
					ai.attack(i, d, o);
					// console.info('executing turn: ', d.player, Date.now());
				}, ai.attackDelay(i, d));
			})(i, d);
		}
		var usingNuke = 0;
		if (g.resourceTick > ai.unlockNuke[d.difficultyShort]){
			if (Math.random() > .95){
				usingNuke = 1;
				setTimeout(function(){
					ai.launchNuke(d);
				}, ai.weaponDelay());
			}
		}
		if (!usingNuke){
			if (g.resourceTick > ai.unlockMissile[d.difficultyShort]){
				if (Math.random() > ai.missileRate[d.difficultyShort]){
					// var len = Math.ceil(o.food / 60);
					setTimeout(function(){
						ai.launchMissile(d);
					}, ai.weaponDelay());
				}
			}
			else if (g.resourceTick > ai.unlockCannons[d.difficultyShort]){
				if (Math.random() > ai.cannonRate[d.difficultyShort]){
					/*var len = Math.ceil(o.food / 30);
					for (var i=0; i<len; i++){
					}*/
					setTimeout(function(){
						ai.fireCannons(d);
					}, ai.weaponDelay());
				}
			}
		}
		// defense
		if (g.resourceTick > ai.unlockStructures[d.difficultyShort]){
			if (Math.random() > .875){
				setTimeout(function(){
					ai.upgradeTileDefense(d);
				}, ai.weaponDelay());
			}
		}
	}
};